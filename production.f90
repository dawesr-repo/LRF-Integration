 !******************************************************************************
 !      Compilation Day and Time
 !      Month / Day / Year:            8 /          22 /        2023
 !      Hr    / Min / Sec :           21 :          34 :          25
 !      LRF MATLAB  v0.7.1
 !      LRF_Fortran v0.3.1
 !******************************************************************************

                                                                                                                                                                                                         
     !********************************************************                                                                                                                                           
 module Tensors_constant                                                                                                                                                                                 
    implicit none                                                                                                                                                                                        
    real*8 :: T_Tensor(40,40,40,40),T_Changed(40,40,40,40)                                                                                                                                               
                                                                                                                                                                                                         
   contains                                                                                                                                                                                              
                                                                                                                                                                                                         
   subroutine init_Tensors()                                                                                                                                                                             
      implicit none                                                                                                                                                                                      
      integer :: i,j,k,l                                                                                                                                                                                 
                                                                                                                                                                                                         
      T_Tensor  = 0d0                                                                                                                                                                                    
      T_Changed = 0d0                                                                                                                                                                                    
                                                                                                                                                                                                         
                                                                                                                                                                                                         
   end subroutine init_Tensors                                                                                                                                                                           
                                                                                                                                                                                                         
   subroutine change_Tensors(la_,ka1_,ka2_,lb_,kb1_,kb2_,val)                                                                                                                                            
     integer ,INTENT(IN)::la_,ka1_,lb_,kb1_                                                                                                                                                              
       Character(len = 1) , INTENT(IN)::ka2_,kb2_                                                                                                                                                        
       real*8 ,INTENT(In)::val                                                                                                                                                                           
       integer :: ka,kb,la,ka1,lb,kb1                                                                                                                                                                    
       Character(len = 1) ::ka2,kb2                                                                                                                                                                      
       la = la_                                                                                                                                                                                          
       ka1 = ka1_                                                                                                                                                                                        
       ka2 = ka2_                                                                                                                                                                                        
       lb = lb_                                                                                                                                                                                          
       kb1 = kb1_                                                                                                                                                                                        
       kb2 = kb2_                                                                                                                                                                                        
                                                                                                                                                                                                         
       IF (ka1<0 .or. kb1<0 .or. la<0 .or. lb<0 .or. ka1>la .or. kb1>lb) THEN                                                                                                                            
         RETURN                                                                                                                                                                                          
       ELSE IF (la==0 .and. lb==0) THEN                                                                                                                                                                  
         RETURN                                                                                                                                                                                          
       ELSE                                                                                                                                                                                              
         call T_component(la,ka1,ka2,ka)                                                                                                                                                                 
         call T_component(lb,kb1,kb2,kb)                                                                                                                                                                 
                                                                                                                                                                                                         
         T_Tensor(la+1,ka,lb+1,kb)=val                                                                                                                                                                   
         T_Changed(la+1,ka,lb+1,kb)=1d0                                                                                                                                                                  
                                                                                                                                                                                                         
         Return                                                                                                                                                                                          
                                                                                                                                                                                                         
     endif                                                                                                                                                                                               
   end subroutine change_Tensors                                                                                                                                                                         
                                                                                                                                                                                                         
   subroutine get_Tensor(la_,ka1_,ka2_,lb_,kb1_,kb2_,T,chang)                                                                                                                                            
                                                                                                                                                                                                         
       integer ,INTENT(IN)::la_,ka1_,lb_,kb1_                                                                                                                                                            
       Character(len = 1) , INTENT(IN)::ka2_,kb2_                                                                                                                                                        
       real*8 ,INTENT(OUT)::T,chang                                                                                                                                                                      
       integer :: ka,kb,la,ka1,lb,kb1                                                                                                                                                                    
       Character(len = 1) ::ka2,kb2                                                                                                                                                                      
       la = la_                                                                                                                                                                                          
       ka1 = ka1_                                                                                                                                                                                        
       ka2 = ka2_                                                                                                                                                                                        
       lb = lb_                                                                                                                                                                                          
       kb1 = kb1_                                                                                                                                                                                        
       kb2 = kb2_                                                                                                                                                                                        
                                                                                                                                                                                                         
       IF (ka1<0 .or. kb1<0 .or. la<0 .or. lb<0 .or. ka1>la .or. kb1>lb) THEN                                                                                                                            
         T=0d0                                                                                                                                                                                           
         chang =0d0                                                                                                                                                                                      
         RETURN                                                                                                                                                                                          
       ELSE IF (la==0 .and. lb==0) THEN                                                                                                                                                                  
         T = 1d0                                                                                                                                                                                         
         chang=1d0                                                                                                                                                                                       
         RETURN                                                                                                                                                                                          
       ELSE                                                                                                                                                                                              
         call T_component(la,ka1,ka2,ka)                                                                                                                                                                 
         call T_component(lb,kb1,kb2,kb)                                                                                                                                                                 
         if (ka>0 .and. kb>0)Then                                                                                                                                                                        
           T     =  T_Tensor (la+1,ka,lb+1,kb)                                                                                                                                                           
           chang =  T_Changed(la+1,ka,lb+1,kb)                                                                                                                                                           
           RETURN                                                                                                                                                                                        
         else                                                                                                                                                                                            
           T=0d0                                                                                                                                                                                         
           chang =0d0                                                                                                                                                                                    
           RETURN                                                                                                                                                                                        
                                                                                                                                                                                                         
         end if                                                                                                                                                                                          
                                                                                                                                                                                                         
        endif                                                                                                                                                                                            
   end subroutine  get_Tensor                                                                                                                                                                            
                                                                                                                                                                                                         
                                                                                                                                                                                                         
   subroutine T_component(l_,k1_,k2_,k)                                                                                                                                                                  
                                                                                                                                                                                                         
       integer ,INTENT(IN)::k1_,l_                                                                                                                                                                       
       Character(len = 1) , INTENT(IN)::k2_                                                                                                                                                              
       integer , INTENT(OUT)::k                                                                                                                                                                          
       integer :: k1,l                                                                                                                                                                                   
       Character(len = 1) ::k2                                                                                                                                                                           
                                                                                                                                                                                                         
       k1 = k1_                                                                                                                                                                                          
       k2 = k2_                                                                                                                                                                                          
       l = l_                                                                                                                                                                                            
                                                                                                                                                                                                         
       IF (k1<0  .or. l<0 .or. k1>l ) THEN                                                                                                                                                               
          k = 0;                                                                                                                                                                                         
       ELSE IF (l==0 .and. k1==0) THEN                                                                                                                                                                   
         if (k2=="0" )then                                                                                                                                                                               
           k = 1;                                                                                                                                                                                        
         else                                                                                                                                                                                            
           k = 0;                                                                                                                                                                                        
         end if                                                                                                                                                                                          
       ELSE                                                                                                                                                                                              
         if (k2=="s")then                                                                                                                                                                                
           k=2*k1+1                                                                                                                                                                                      
         elseif (k2=="c")then                                                                                                                                                                            
             k=2*k1                                                                                                                                                                                      
         else                                                                                                                                                                                            
            k = 1                                                                                                                                                                                        
         endif                                                                                                                                                                                           
                                                                                                                                                                                                         
     endif                                                                                                                                                                                               
                                                                                                                                                                                                         
   end subroutine T_component                                                                                                                                                                            
                                                                                                                                                                                                         
 end module Tensors_constant                                                                                                                                                                             
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 !********************************************************                                                                                                                                               
 RECURSIVE SUBROUTINE T_lk(Ar,Br,C,la,ka1,ka2,lb,kb1,kb2,Tlk)                                                                                                                                            
     use Tensors_constant                                                                                                                                                                                
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     real*8 , dimension(9):: Cab                                                                                                                                                                         
     Integer , INTENT(IN):: la,ka1,lb,kb1                                                                                                                                                                
     Character(len = 1) , INTENT(IN)::ka2,kb2                                                                                                                                                            
     Character(len = 20), dimension(3):: coordinates = ["z","y","x"]                                                                                                                                     
     Integer :: i ,j   ,k_res1,ka_res1,kb_res1                                                                                                                                                           
     real*8 , INTENT(INOUT):: Tlk                                                                                                                                                                        
     real*8 :: M,M1,M2,NN_,Tlk_new,NN_1,NN_2,Tlk_1,Tlk_2                                                                                                                                                 
     Character (len = 1)::k_res2,ka_res2,kb_res2                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     real*8:: eps = 1.0D-8 ,T,chang                                                                                                                                                                      
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     Cab(1) = C(1) !zz                                                                                                                                                                                   
     Cab(2) = C(7) !zy                                                                                                                                                                                   
     Cab(3) = C(4) !zx                                                                                                                                                                                   
     Cab(4) = C(3) !yz                                                                                                                                                                                   
     Cab(5) = C(9) !yy                                                                                                                                                                                   
     Cab(6) = C(6) !yx                                                                                                                                                                                   
     Cab(7) = C(2) !xz                                                                                                                                                                                   
     Cab(8) = C(8) !xy                                                                                                                                                                                   
     Cab(9) = C(5) !xx                                                                                                                                                                                   
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     IF (ka1<0 .or. kb1<0 .or. la<0 .or. lb<0 .or. ka1>la .or. kb1>lb) THEN                                                                                                                              
         Tlk = 0d0                                                                                                                                                                                       
         RETURN                                                                                                                                                                                          
     ELSE IF (la==0 .and. lb==0) THEN                                                                                                                                                                    
         Tlk = 1d0                                                                                                                                                                                       
         RETURN                                                                                                                                                                                          
     ELSE                                                                                                                                                                                                
                                                                                                                                                                                                         
       !call change_Tensors(la,ka1,ka2,lb,kb1,kb2,3d0)                                                                                                                                                   
       call get_Tensor(la,ka1,ka2,lb,kb1,kb2,T,chang)                                                                                                                                                    
                                                                                                                                                                                                         
       ! if (la==0 .and. ka1==0 .and. ka2=="0" .and. &                                                                                                                                                   
       !     lb==1 .and. kb1==0 .and. kb2=="0")then                                                                                                                                                      
       !   write(*,*)"found it",T,chang                                                                                                                                                                  
       ! end if                                                                                                                                                                                          
                                                                                                                                                                                                         
       if (DABS(chang-1d0)<eps)Then                                                                                                                                                                      
           !write(*,*)"T from constant!",T,chang,la,ka1,ka2,lb,kb1,kb2                                                                                                                                   
           Tlk =T                                                                                                                                                                                        
         RETURN                                                                                                                                                                                          
       else                                                                                                                                                                                              
                                                                                                                                                                                                         
         IF (lb==0) THEN                                                                                                                                                                                 
                                                                                                                                                                                                         
           Tlk = 0d0;                                                                                                                                                                                    
                                                                                                                                                                                                         
                                                                                                                                                                                                         
           do i = 1,3                                                                                                                                                                                    
             call MT(coordinates(i),ka1,ka2,M)                                                                                                                                                           
             call N_eta(coordinates(i),ka1,ka2,k_res1,k_res2)                                                                                                                                            
             call NN(la-1,k_res1,0,0,NN_)                                                                                                                                                                
                                                                                                                                                                                                         
             if (abs(M)> eps .and. abs(2.d0*la-1d0) > eps .and. abs(Ar(i))>eps  ) Then                                                                                                                   
               call T_lk(Ar,Br,C,la-1,k_res1,k_res2,0,0,"0",Tlk_new)                                                                                                                                     
               Tlk = Tlk + ((2.d0*la-1d0)/(la*1.d0))*M*Ar(i)*Tlk_new*NN_                                                                                                                                 
             end if                                                                                                                                                                                      
           end do                                                                                                                                                                                        
                                                                                                                                                                                                         
           call NN(la-2,ka1 ,0,0,NN_)                                                                                                                                                                    
                                                                                                                                                                                                         
           if (abs(la-1d0) > eps ) Then                                                                                                                                                                  
               call T_lk(Ar,Br,C,la-2,ka1,ka2,0,0,"0",Tlk_new)                                                                                                                                           
               Tlk = Tlk  - ((la-1d0)/(la*1d0))*Tlk_new*NN_;                                                                                                                                             
           end if                                                                                                                                                                                        
           call NN(la,ka1 ,lb,kb1,NN_)                                                                                                                                                                   
           Tlk = Tlk /NN_;                                                                                                                                                                               
           call change_Tensors(la,ka1,ka2,lb,kb1,kb2,Tlk)                                                                                                                                                
           RETURN                                                                                                                                                                                        
       ELSE IF (la==0 ) THEN                                                                                                                                                                             
                                                                                                                                                                                                         
         Tlk = 0d0;                                                                                                                                                                                      
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         do i = 1,3                                                                                                                                                                                      
           call MT(coordinates(i),kb1,kb2,M)                                                                                                                                                             
           call N_eta(coordinates(i),kb1,kb2,k_res1,k_res2)                                                                                                                                              
           call NN(lb-1,k_res1,0,0,NN_)                                                                                                                                                                  
                                                                                                                                                                                                         
           if (abs(M)> eps .and. abs(2.d0*lb-1d0) > eps .and. abs(Br(i))>eps ) Then                                                                                                                      
                                                                                                                                                                                                         
             call T_lk(Ar,Br,C,0,0,"0",lb-1,k_res1,k_res2,Tlk_new)                                                                                                                                       
             Tlk = Tlk + ((2.d0*lb-1d0)/(lb*1.d0))*M*Br(i)*Tlk_new*NN_                                                                                                                                   
                                                                                                                                                                                                         
           end if                                                                                                                                                                                        
         end do                                                                                                                                                                                          
                                                                                                                                                                                                         
         if (abs(1d0*lb-1d0) > eps ) Then                                                                                                                                                                
           call NN(lb-2,kb1 ,0,0,NN_)                                                                                                                                                                    
           call T_lk(Ar,Br,C,0,0,"0",lb-2,kb1,kb2,Tlk_new)                                                                                                                                               
                                                                                                                                                                                                         
           Tlk = Tlk  - ((1d0*lb-1d0)/(lb*1d0))*Tlk_new*NN_;                                                                                                                                             
         end if                                                                                                                                                                                          
         call NN(la,ka1 ,lb,kb1,NN_)                                                                                                                                                                     
         Tlk = Tlk /NN_;                                                                                                                                                                                 
         call change_Tensors(la,ka1,ka2,lb,kb1,kb2,Tlk)                                                                                                                                                  
         RETURN                                                                                                                                                                                          
       ELSE                                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         Tlk = 0d0;                                                                                                                                                                                      
                                                                                                                                                                                                         
         Call NN(la-2,ka1,lb,kb1,NN_1)                                                                                                                                                                   
         Call NN(la,ka1,lb-2,kb1,NN_2)                                                                                                                                                                   
         Call T_lk(Ar,Br,C,la-2,ka1,ka2,lb,kb1,kb2,Tlk_1)                                                                                                                                                
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         Tlk  =Tlk  + Tlk_1*NN_1                                                                                                                                                                         
                                                                                                                                                                                                         
         if (abs(2d0*la+1.d0*lb-1d0) > eps ) Then                                                                                                                                                        
                                                                                                                                                                                                         
           Call T_lk(Ar,Br,C,la,ka1,ka2,lb-2,kb1,kb2,Tlk_2)                                                                                                                                              
           Tlk  =Tlk  - ((2d0*la+1.d0*lb-1d0)/lb*1d0)*Tlk_2*NN_2;                                                                                                                                        
         end if                                                                                                                                                                                          
                                                                                                                                                                                                         
         do i = 1,3                                                                                                                                                                                      
                                                                                                                                                                                                         
             Call N_eta(coordinates(i),kb1,kb2,k_res1,k_res2);                                                                                                                                           
             call MT(coordinates(i),kb1,kb2,M)                                                                                                                                                           
             Call NN(la,ka1,lb-1,k_res1,NN_);                                                                                                                                                            
                                                                                                                                                                                                         
             if (abs(M) > eps .and. abs(2d0*la+2d0*lb-1d0) > eps .and. abs(Br(i))>eps) Then                                                                                                              
                                                                                                                                                                                                         
               Call T_lk(Ar,Br,C,la,ka1,ka2,lb-1,k_res1,k_res2,Tlk_new)                                                                                                                                  
                                                                                                                                                                                                         
               Tlk  =Tlk + ((2d0*la+2d0*lb-1d0)/(lb*1d0))*M*Br(i)*Tlk_new*NN_;                                                                                                                           
                                                                                                                                                                                                         
             end if                                                                                                                                                                                      
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         end do                                                                                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         do i = 1,3                                                                                                                                                                                      
           do j = 1,3                                                                                                                                                                                    
                                                                                                                                                                                                         
                 Call N_eta(coordinates(i),ka1,ka2,ka_res1,ka_res2);                                                                                                                                     
                 Call N_eta(coordinates(j),kb1,kb2,kb_res1,kb_res2);                                                                                                                                     
                 call MT(coordinates(i),ka1,ka2,M1)                                                                                                                                                      
                 call MT(coordinates(j),kb1,kb2,M2)                                                                                                                                                      
                                                                                                                                                                                                         
                 if (abs(M1) > eps .and. abs(M2) > eps .and.  abs(2d0*la-1d0) > eps .and. abs(Cab((i-1)*3+j))>eps) Then                                                                                  
                                                                                                                                                                                                         
                   Call NN(la-1,ka_res1,lb-1,kb_res1,NN_);                                                                                                                                               
                                                                                                                                                                                                         
                   Call T_lk(Ar,Br,C,la-1,ka_res1,ka_res2,lb-1,kb_res1,kb_res2,Tlk_new)                                                                                                                  
                                                                                                                                                                                                         
                   Tlk  =Tlk +  ((2d0*la-1d0)/(lb*1d0))*M1*M2*Cab((i-1)*3+j)*Tlk_new*NN_;                                                                                                                
                 end if                                                                                                                                                                                  
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
           end do                                                                                                                                                                                        
         end do                                                                                                                                                                                          
                                                                                                                                                                                                         
         call NN(la,ka1 ,lb,kb1,NN_)                                                                                                                                                                     
         Tlk = Tlk /NN_;                                                                                                                                                                                 
         call change_Tensors(la,ka1,ka2,lb,kb1,kb2,Tlk)                                                                                                                                                  
         RETURN                                                                                                                                                                                          
       END IF                                                                                                                                                                                            
       endif                                                                                                                                                                                             
                                                                                                                                                                                                         
     END IF                                                                                                                                                                                              
                                                                                                                                                                                                         
 End   SUBROUTINE T_lk                                                                                                                                                                                   
   !********************************************************                                                                                                                                             
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE MT(mu,k1,k2,res)                                                                                                                                                                             
   IMPLICIT NONE                                                                                                                                                                                         
                                                                                                                                                                                                         
   Integer , INTENT(IN):: k1                                                                                                                                                                             
   Character(len = 1) , INTENT(IN)::mu,k2                                                                                                                                                                
   real*8 ,INTENT(INOUT) :: res                                                                                                                                                                          
                                                                                                                                                                                                         
   if (mu=="x") Then                                                                                                                                                                                     
       if (k1==0) then                                                                                                                                                                                   
           res =  0d0 ;                                                                                                                                                                                  
       else if (k1==1 .and. k2=="c") then                                                                                                                                                                
               res = sqrt(2d0);                                                                                                                                                                          
       else if (k1==1 .and. k2=="s") then                                                                                                                                                                
               res = 0d0;                                                                                                                                                                                
       else                                                                                                                                                                                              
               res = k1*1d0;                                                                                                                                                                             
       end if                                                                                                                                                                                            
                                                                                                                                                                                                         
       elseif (mu=="y")then                                                                                                                                                                              
         if (k1==0) then                                                                                                                                                                                 
           res =  0d0 ;                                                                                                                                                                                  
         else if (k1==1 .and. k2=="s") then                                                                                                                                                              
                 res = sqrt(2d0);                                                                                                                                                                        
         else if (k1==1 .and. k2=="c") then                                                                                                                                                              
                 res = 0d0;                                                                                                                                                                              
         elseif (k1>1 .and. k2=="c") then                                                                                                                                                                
                   res = -k1*1d0;                                                                                                                                                                        
         elseif (k1>1 .and. k2=="s") then                                                                                                                                                                
                     res = k1*1d0;                                                                                                                                                                       
         end if                                                                                                                                                                                          
       else                                                                                                                                                                                              
         res=1d0                                                                                                                                                                                         
     end if                                                                                                                                                                                              
 End   SUBROUTINE MT                                                                                                                                                                                     
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE N_eta(mu,k1,k2,k_res1,k_res2)                                                                                                                                                                
   IMPLICIT NONE                                                                                                                                                                                         
                                                                                                                                                                                                         
   Integer , INTENT(IN):: k1                                                                                                                                                                             
   Character(len = 1) , INTENT(IN)::mu,k2                                                                                                                                                                
   Integer ,INTENT(INOUT) :: k_res1                                                                                                                                                                      
   Character(len = 1) , INTENT(INOUT)::k_res2                                                                                                                                                            
                                                                                                                                                                                                         
   if (k1==0) then                                                                                                                                                                                       
     k_res1 = 0                                                                                                                                                                                          
     k_res2 ="0"                                                                                                                                                                                         
   else                                                                                                                                                                                                  
                                                                                                                                                                                                         
     if (mu=="x") Then                                                                                                                                                                                   
       if (k1==1) then                                                                                                                                                                                   
           k_res1 = 0                                                                                                                                                                                    
           k_res2 ="0"                                                                                                                                                                                   
       else if (k1>1 .and. k2=="c") then                                                                                                                                                                 
           k_res1 = k1-1                                                                                                                                                                                 
           k_res2 ="c"                                                                                                                                                                                   
       else                                                                                                                                                                                              
           k_res1 = k1-1                                                                                                                                                                                 
           k_res2 ="s"                                                                                                                                                                                   
       end if                                                                                                                                                                                            
                                                                                                                                                                                                         
       elseif (mu=="y")then                                                                                                                                                                              
         if (k1==1) then                                                                                                                                                                                 
           k_res1 = 0                                                                                                                                                                                    
           k_res2 ="0"                                                                                                                                                                                   
         else if (k1>1 .and. k2=="c") then                                                                                                                                                               
             k_res1 = k1-1                                                                                                                                                                               
             k_res2 ="s"                                                                                                                                                                                 
         else                                                                                                                                                                                            
             k_res1 = k1-1                                                                                                                                                                               
             k_res2 ="c"                                                                                                                                                                                 
         end if                                                                                                                                                                                          
       else                                                                                                                                                                                              
             k_res1 = k1                                                                                                                                                                                 
             k_res2 = k2                                                                                                                                                                                 
     end if                                                                                                                                                                                              
                                                                                                                                                                                                         
   end if                                                                                                                                                                                                
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 End   SUBROUTINE N_eta                                                                                                                                                                                  
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE NN(la,ka1,lb,kb1,NN_fact)                                                                                                                                                                    
   IMPLICIT NONE                                                                                                                                                                                         
                                                                                                                                                                                                         
   Integer , INTENT(IN):: la,ka1,lb,kb1                                                                                                                                                                  
   real*8,INTENT(INOUT) :: NN_fact                                                                                                                                                                       
   real*8 :: nf1,nf2,df1,df2                                                                                                                                                                             
                                                                                                                                                                                                         
   if (la<0 .or. lb<0 .or. ka1<0 .or. kb1<0 .or. ka1 > la .or. kb1>lb) Then                                                                                                                              
     NN_fact  = 0d0                                                                                                                                                                                      
   else                                                                                                                                                                                                  
     call Factorial(la+ka1,nf1)                                                                                                                                                                          
     call Factorial(lb+kb1,nf2)                                                                                                                                                                          
     call Factorial(la-ka1,df1)                                                                                                                                                                          
     call Factorial(lb-kb1,df2)                                                                                                                                                                          
                                                                                                                                                                                                         
     NN_fact  = DSQRT( (nf1/df1)*(nf2/df2));                                                                                                                                                             
   end if                                                                                                                                                                                                
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 End   SUBROUTINE NN                                                                                                                                                                                     
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE Factorial(n,fact)                                                                                                                                                                            
   IMPLICIT NONE                                                                                                                                                                                         
                                                                                                                                                                                                         
   integer, intent(in) :: n                                                                                                                                                                              
   real*8, intent(inout) :: fact                                                                                                                                                                         
   integer :: i                                                                                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
   fact = 1.0d0                                                                                                                                                                                          
   do i = 2, n                                                                                                                                                                                           
     fact = fact * (i*1d0)                                                                                                                                                                               
   end do                                                                                                                                                                                                
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 End   SUBROUTINE Factorial                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 !********************************************************                                                                                                                                               
 SUBROUTINE T_l0(Ar,Br,C,q,M2,IND,lk , result)                                                                                                                                                           
         IMPLICIT NONE                                                                                                                                                                                   
                                                                                                                                                                                                         
         INTEGER ::  i                                                                                                                                                                                   
         real*8, INTENT(INOUT) ::result                                                                                                                                                                  
         real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                          
         real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                          
         real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                           
         Integer, INTENT(IN):: ind,lk                                                                                                                                                                    
         real*8 :: q,t_k1,t_k2                                                                                                                                                                           
         real*8 , dimension(2*lk+1):: M2                                                                                                                                                                 
         real*8:: eps=EPSILON(result)                                                                                                                                                                    
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         result = 0d0                                                                                                                                                                                    
                                                                                                                                                                                                         
         do i = 0,lk                                                                                                                                                                                     
                                                                                                                                                                                                         
                                                                                                                                                                                                         
             if (ind==0) then                                                                                                                                                                            
                                                                                                                                                                                                         
                 if (i==0) then                                                                                                                                                                          
                                                                                                                                                                                                         
                     if (DABS(q)>eps .and. DABS(M2(1))>eps) Then                                                                                                                                         
                         Call T_lk(Ar,Br,C,lk,0,"0",0,0,"0",t_k1)                                                                                                                                        
                                                                                                                                                                                                         
                         result = result + q*M2(1)*t_k1                                                                                                                                                  
                     end if                                                                                                                                                                              
                 else                                                                                                                                                                                    
                                                                                                                                                                                                         
                     if (DABS(q)>eps .and. DABS(M2(2*i))>eps) Then                                                                                                                                       
                         Call T_lk(Ar,Br,C,lk,i,"c",0,0,"0",t_k1)                                                                                                                                        
                         result = result + q*M2(2*i)*t_k1                                                                                                                                                
                     end if                                                                                                                                                                              
                     if ( DABS(q)>eps .and. DABS(M2(2*i+1))>eps) Then                                                                                                                                    
                         Call T_lk(Ar,Br,C,lk,i,"s",0,0,"0",t_k2)                                                                                                                                        
                         result = result + q*M2(2*i+1)*t_k2                                                                                                                                              
                     end if                                                                                                                                                                              
                                                                                                                                                                                                         
                 end if                                                                                                                                                                                  
         ELSE                                                                                                                                                                                            
             if (i==0) then                                                                                                                                                                              
                                                                                                                                                                                                         
                 if (DABS(q)>eps .and. DABS(M2(1))>eps) Then                                                                                                                                             
                     Call T_lk(Ar,Br,C,0,0,"0",lk,0,"0",t_k1)                                                                                                                                            
                     result = result + q*M2(1)*t_k1                                                                                                                                                      
                 end if                                                                                                                                                                                  
             else                                                                                                                                                                                        
                                                                                                                                                                                                         
                     if (DABS(q)>eps .and. DABS(M2(2*i))>eps) Then                                                                                                                                       
                         Call T_lk(Ar,Br,C,0,0,"0",lk,i,"c",t_k1)                                                                                                                                        
                         result = result + q*M2(2*i)*t_k1                                                                                                                                                
                     end if                                                                                                                                                                              
                     if ( DABS(q)>eps .and. DABS(M2(2*i+1))>eps) Then                                                                                                                                    
                         Call T_lk(Ar,Br,C,0,0,"0",lk,i,"s",t_k2)                                                                                                                                        
                         result = result + q*M2(2*i+1)*t_k2                                                                                                                                              
                     end if                                                                                                                                                                              
                                                                                                                                                                                                         
                 end if                                                                                                                                                                                  
                                                                                                                                                                                                         
             end if                                                                                                                                                                                      
         end do                                                                                                                                                                                          
                                                                                                                                                                                                         
         RETURN                                                                                                                                                                                          
 END SUBROUTINE T_l0                                                                                                                                                                                     
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     !********************************************************                                                                                                                                           
 SUBROUTINE T_ll(Ar,Br,C,M1,M2,lk1,lk2 , result)                                                                                                                                                         
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     INTEGER ::  i,j                                                                                                                                                                                     
     real*8, INTENT(INOUT) ::result                                                                                                                                                                      
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     Integer, INTENT(IN):: lk1,lk2                                                                                                                                                                       
     real*8 :: t_k1                                                                                                                                                                                      
     real*8 , dimension(2*lk1+1):: M1                                                                                                                                                                    
     real*8 , dimension(2*lk2+1):: M2                                                                                                                                                                    
     real*8:: eps=EPSILON(result)                                                                                                                                                                        
     Character :: cp1,cp2                                                                                                                                                                                
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         result = 0d0                                                                                                                                                                                    
                                                                                                                                                                                                         
         do i = 1,2*lk1+1                                                                                                                                                                                
                 do j = 1,2*lk2+1                                                                                                                                                                        
                                                                                                                                                                                                         
                     if (DABS(M1(i))>eps .and. DABS(M2(j))>eps) Then                                                                                                                                     
                                                                                                                                                                                                         
                         call Get_Comp(i,cp1)                                                                                                                                                            
                         call Get_Comp(j,cp2)                                                                                                                                                            
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,lk1,Floor((i*1d0)/2d0),cp1,lk2,Floor((j*1d0)/2d0),cp2,t_k1)                                                                                                   
                         result = result + M1(i)*M2(j)*t_k1                                                                                                                                              
                     end if                                                                                                                                                                              
                                                                                                                                                                                                         
                 end do                                                                                                                                                                                  
         end do                                                                                                                                                                                          
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE T_ll                                                                                                                                                                                     
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE Get_Comp(i,cp)                                                                                                                                                                               
             !! DECLARACTIONS                                                                                                                                                                            
             IMPLICIT NONE                                                                                                                                                                               
                                                                                                                                                                                                         
             INTEGER, INTENT(IN):: i                                                                                                                                                                     
             Character, INTENT(INOUT):: cp                                                                                                                                                               
             !! EXECUTABLES                                                                                                                                                                              
             if (i==1) then                                                                                                                                                                              
                 cp = "0"                                                                                                                                                                                
             elseif(mod(i,2)==0)then                                                                                                                                                                     
                 cp = "c"                                                                                                                                                                                
             else                                                                                                                                                                                        
                 cp = "s"                                                                                                                                                                                
             end if                                                                                                                                                                                      
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         RETURN	!!ONLY NEEDED IF WE PLAN TO REACH END FUNCTION ALL OF THE TIME                                                                                                                           
 END SUBROUTINE Get_Comp                                                                                                                                                                                 
                                                                                                                                                                                                         
 SUBROUTINE GetIndex_mm (i,j,index)                                                                                                                                                                      
                                                                                                                                                                                                         
     Character(len = 20) , dimension(6)::alpha_arr                                                                                                                                                       
     Integer , INTENT(IN) :: i , j                                                                                                                                                                       
     Integer, INTENT(INOUT) :: index                                                                                                                                                                     
                                                                                                                                                                                                         
     Integer :: s                                                                                                                                                                                        
                                                                                                                                                                                                         
     Character(len = 5) ::strIJ,strJI                                                                                                                                                                    
     Character(Len=1)::stri,strj                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     alpha_arr(1) = "11"                                                                                                                                                                                 
     alpha_arr(2) = "12"                                                                                                                                                                                 
     alpha_arr(3) = "13"                                                                                                                                                                                 
     alpha_arr(4) = "22"                                                                                                                                                                                 
     alpha_arr(5) = "23"                                                                                                                                                                                 
     alpha_arr(6) = "33"                                                                                                                                                                                 
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     call GetStr(i,stri)                                                                                                                                                                                 
     call GetStr(j,strj)                                                                                                                                                                                 
                                                                                                                                                                                                         
     strIJ = stri//strj                                                                                                                                                                                  
     strJI = strj//stri                                                                                                                                                                                  
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     index=1                                                                                                                                                                                             
     do s = 1,6                                                                                                                                                                                          
                                                                                                                                                                                                         
         if (alpha_arr(s)==strIJ .Or. alpha_arr(s)==strJI) Then                                                                                                                                          
             index = s;                                                                                                                                                                                  
         end if                                                                                                                                                                                          
     end do                                                                                                                                                                                              
                                                                                                                                                                                                         
 END SUBROUTINE GetIndex_mm                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE GetIndex_mQd (i,j,index)                                                                                                                                                                     
                                                                                                                                                                                                         
     Character(len = 20) , dimension(15)::alpha_Qd                                                                                                                                                       
     Integer , INTENT(IN) :: i , j                                                                                                                                                                       
     Integer, INTENT(INOUT) :: index                                                                                                                                                                     
     Integer :: s,u,v,count                                                                                                                                                                              
     Character(Len=1)::stri,strj                                                                                                                                                                         
     Character(len = 5) ::strIJ                                                                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     ! count =1;                                                                                                                                                                                         
     ! do u=1,3                                                                                                                                                                                          
     !     do v=1,5                                                                                                                                                                                      
     !         write(alpha_Qd(count) , '(i1.1, i1.1)') u,v                                                                                                                                               
     !         count=count+1                                                                                                                                                                             
     !     end do                                                                                                                                                                                        
     ! end do                                                                                                                                                                                            
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     alpha_Qd(1) = "11"                                                                                                                                                                                  
     alpha_Qd(2) = "12"                                                                                                                                                                                  
     alpha_Qd(3) = "13"                                                                                                                                                                                  
     alpha_Qd(4) = "14"                                                                                                                                                                                  
     alpha_Qd(5) = "15"                                                                                                                                                                                  
     alpha_Qd(6) = "21"                                                                                                                                                                                  
     alpha_Qd(7) = "22"                                                                                                                                                                                  
     alpha_Qd(8) = "23"                                                                                                                                                                                  
     alpha_Qd(9) = "24"                                                                                                                                                                                  
     alpha_Qd(10) = "25"                                                                                                                                                                                 
     alpha_Qd(11) = "31"                                                                                                                                                                                 
     alpha_Qd(12) = "32"                                                                                                                                                                                 
     alpha_Qd(13) = "33"                                                                                                                                                                                 
     alpha_Qd(14) = "34"                                                                                                                                                                                 
     alpha_Qd(15) = "35"                                                                                                                                                                                 
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     call GetStr(i,stri)                                                                                                                                                                                 
     call GetStr(j,strj)                                                                                                                                                                                 
                                                                                                                                                                                                         
     strIJ = stri//strj                                                                                                                                                                                  
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     do s = 1,15                                                                                                                                                                                         
         if (alpha_Qd(s)==strIJ ) Then                                                                                                                                                                   
             index = s;                                                                                                                                                                                  
         end if                                                                                                                                                                                          
     end do                                                                                                                                                                                              
                                                                                                                                                                                                         
 END SUBROUTINE GetIndex_mQd                                                                                                                                                                             
                                                                                                                                                                                                         
 SUBROUTINE GetIndex_mO (i,j,index)                                                                                                                                                                      
                                                                                                                                                                                                         
     Character(len = 20) , dimension(21)::alpha_mO                                                                                                                                                       
     Integer , INTENT(IN) :: i , j                                                                                                                                                                       
     Integer, INTENT(INOUT) :: index                                                                                                                                                                     
                                                                                                                                                                                                         
     Integer :: s,u,v,count                                                                                                                                                                              
     Character(Len=1)::stri,strj                                                                                                                                                                         
     Character(len = 5) ::strIJ                                                                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     ! count =1;                                                                                                                                                                                         
     ! do u=1,3                                                                                                                                                                                          
     !     do v=1,7                                                                                                                                                                                      
     !         write(alpha_mO(count) , '(i1.1, i1.1)') u,v                                                                                                                                               
     !         count=count+1                                                                                                                                                                             
     !     end do                                                                                                                                                                                        
     ! end do                                                                                                                                                                                            
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     alpha_mO(1) = "11"                                                                                                                                                                                  
     alpha_mO(2) = "12"                                                                                                                                                                                  
     alpha_mO(3) = "13"                                                                                                                                                                                  
     alpha_mO(4) = "14"                                                                                                                                                                                  
     alpha_mO(5) = "15"                                                                                                                                                                                  
     alpha_mO(6) = "16"                                                                                                                                                                                  
     alpha_mO(7) = "17"                                                                                                                                                                                  
     alpha_mO(8) = "21"                                                                                                                                                                                  
     alpha_mO(9) = "22"                                                                                                                                                                                  
     alpha_mO(10) = "23"                                                                                                                                                                                 
     alpha_mO(11) = "24"                                                                                                                                                                                 
     alpha_mO(12) = "25"                                                                                                                                                                                 
     alpha_mO(13) = "26"                                                                                                                                                                                 
     alpha_mO(14) = "27"                                                                                                                                                                                 
     alpha_mO(15) = "31"                                                                                                                                                                                 
     alpha_mO(16) = "32"                                                                                                                                                                                 
     alpha_mO(17) = "33"                                                                                                                                                                                 
     alpha_mO(18) = "34"                                                                                                                                                                                 
     alpha_mO(19) = "35"                                                                                                                                                                                 
     alpha_mO(20) = "36"                                                                                                                                                                                 
     alpha_mO(21) = "37"                                                                                                                                                                                 
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     call GetStr(i,stri)                                                                                                                                                                                 
     call GetStr(j,strj)                                                                                                                                                                                 
                                                                                                                                                                                                         
     strIJ = stri//strj                                                                                                                                                                                  
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     do s = 1,21                                                                                                                                                                                         
         if (alpha_mO(s)==strIJ ) Then                                                                                                                                                                   
             index = s;                                                                                                                                                                                  
         end if                                                                                                                                                                                          
     end do                                                                                                                                                                                              
                                                                                                                                                                                                         
 END SUBROUTINE GetIndex_mO                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE GetIndex_QdQd (i,j,index)                                                                                                                                                                    
                                                                                                                                                                                                         
     Character(len = 20) , dimension(15)::alpha_arr                                                                                                                                                      
     Integer , INTENT(IN) :: i , j                                                                                                                                                                       
     Integer, INTENT(INOUT) :: index                                                                                                                                                                     
                                                                                                                                                                                                         
     Integer :: s                                                                                                                                                                                        
     Character(Len=1)::stri,strj                                                                                                                                                                         
     Character(len = 5) ::strIJ,strJI                                                                                                                                                                    
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     alpha_arr(1) = "11"                                                                                                                                                                                 
     alpha_arr(2) = "12"                                                                                                                                                                                 
     alpha_arr(3) = "13"                                                                                                                                                                                 
     alpha_arr(4) = "14"                                                                                                                                                                                 
     alpha_arr(5) = "15"                                                                                                                                                                                 
     alpha_arr(6) = "22"                                                                                                                                                                                 
     alpha_arr(7) = "23"                                                                                                                                                                                 
     alpha_arr(8) = "24"                                                                                                                                                                                 
     alpha_arr(9) = "25"                                                                                                                                                                                 
     alpha_arr(10) = "33"                                                                                                                                                                                
     alpha_arr(11) = "34"                                                                                                                                                                                
     alpha_arr(12) = "35"                                                                                                                                                                                
     alpha_arr(13) = "44"                                                                                                                                                                                
     alpha_arr(14) = "45"                                                                                                                                                                                
     alpha_arr(15) = "55"                                                                                                                                                                                
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     call GetStr(i,stri)                                                                                                                                                                                 
     call GetStr(j,strj)                                                                                                                                                                                 
                                                                                                                                                                                                         
     strIJ = stri//strj                                                                                                                                                                                  
     strJI = strj//stri                                                                                                                                                                                  
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     do s = 1,15                                                                                                                                                                                         
         ! write(*,*)alpha_arr(s) , strIJ, strJI ,alpha_arr(s)==strIJ , alpha_arr(s)==strJI                                                                                                              
         if (alpha_arr(s)==strIJ .Or. alpha_arr(s)==strJI) Then                                                                                                                                          
             index = s;                                                                                                                                                                                  
         end if                                                                                                                                                                                          
     end do                                                                                                                                                                                              
                                                                                                                                                                                                         
 END SUBROUTINE GetIndex_QdQd                                                                                                                                                                            
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE GetIndex_mm_mm (g,h,i,j,index)                                                                                                                                                               
                                                                                                                                                                                                         
     Character(len = 2) , dimension(6)::alpha_arr                                                                                                                                                        
     Character(len = 20) , dimension(36)::disp_arr                                                                                                                                                       
     Integer , INTENT(IN) :: i,j,g,h                                                                                                                                                                     
     Integer, INTENT(INOUT) :: index                                                                                                                                                                     
                                                                                                                                                                                                         
     Integer :: s,l,m,count                                                                                                                                                                              
     Character(Len=1)::stri,strj,strg,strh                                                                                                                                                               
     Character(len = 10) ::str1,str2,str3,str4                                                                                                                                                           
                                                                                                                                                                                                         
     alpha_arr(1) = "11"                                                                                                                                                                                 
     alpha_arr(2) = "12"                                                                                                                                                                                 
     alpha_arr(3) = "13"                                                                                                                                                                                 
     alpha_arr(4) = "22"                                                                                                                                                                                 
     alpha_arr(5) = "23"                                                                                                                                                                                 
     alpha_arr(6) = "33"                                                                                                                                                                                 
                                                                                                                                                                                                         
     count=1;                                                                                                                                                                                            
                                                                                                                                                                                                         
     do l=1,6                                                                                                                                                                                            
         do m=1,6                                                                                                                                                                                        
             disp_arr(count) = alpha_arr(l)//alpha_arr(m)                                                                                                                                                
             count=count+1                                                                                                                                                                               
         end do                                                                                                                                                                                          
     end do                                                                                                                                                                                              
                                                                                                                                                                                                         
     call GetStr(i,stri)                                                                                                                                                                                 
     call GetStr(j,strj)                                                                                                                                                                                 
     call GetStr(g,strg)                                                                                                                                                                                 
     call GetStr(h,strh)                                                                                                                                                                                 
                                                                                                                                                                                                         
     str1 =  strg//strh//stri//strj                                                                                                                                                                      
     str2 =  strh//strg//stri//strj                                                                                                                                                                      
     str3 =  strg//strh//strj//stri                                                                                                                                                                      
     str4 =  strh//strg//strj//stri                                                                                                                                                                      
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     do s = 1,36                                                                                                                                                                                         
                                                                                                                                                                                                         
         if (disp_arr(s)==str1 .Or. disp_arr(s)==str2 .Or. disp_arr(s)==str3 .Or. disp_arr(s)==str4) Then                                                                                                
                                                                                                                                                                                                         
             index = s                                                                                                                                                                                   
         end if                                                                                                                                                                                          
     end do                                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 END SUBROUTINE GetIndex_mm_mm                                                                                                                                                                           
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE GetIndex_mQd_mm (g,h,i,j,index)                                                                                                                                                              
                                                                                                                                                                                                         
     Character(len = 2) , dimension(6)::alpha_arr                                                                                                                                                        
     Character(len = 2) , dimension(15)::alpha_Qd                                                                                                                                                        
     Character(len = 20) , dimension(90)::disp_arr                                                                                                                                                       
     Integer , INTENT(IN) :: i,j,g,h                                                                                                                                                                     
     Integer, INTENT(INOUT) :: index                                                                                                                                                                     
     Character(Len=1)::stri,strj,strg,strh                                                                                                                                                               
     Integer :: s,l,m,count,count_mQ,u,v                                                                                                                                                                 
                                                                                                                                                                                                         
     Character(len = 10) ::str1,str2,str3,str4                                                                                                                                                           
                                                                                                                                                                                                         
     alpha_arr(1) = "11"                                                                                                                                                                                 
     alpha_arr(2) = "12"                                                                                                                                                                                 
     alpha_arr(3) = "13"                                                                                                                                                                                 
     alpha_arr(4) = "22"                                                                                                                                                                                 
     alpha_arr(5) = "23"                                                                                                                                                                                 
     alpha_arr(6) = "33"                                                                                                                                                                                 
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     ! count_mQ =1;                                                                                                                                                                                      
     ! do u=1,3                                                                                                                                                                                          
     !     do v=1,5                                                                                                                                                                                      
     !         write(alpha_Qd(count_mQ) , '(i1.1, i1.1)') u,v                                                                                                                                            
     !         count_mQ=count_mQ+1                                                                                                                                                                       
     !     end do                                                                                                                                                                                        
     ! end do                                                                                                                                                                                            
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     alpha_Qd(1) = "11"                                                                                                                                                                                  
     alpha_Qd(2) = "12"                                                                                                                                                                                  
     alpha_Qd(3) = "13"                                                                                                                                                                                  
     alpha_Qd(4) = "14"                                                                                                                                                                                  
     alpha_Qd(5) = "15"                                                                                                                                                                                  
     alpha_Qd(6) = "21"                                                                                                                                                                                  
     alpha_Qd(7) = "22"                                                                                                                                                                                  
     alpha_Qd(8) = "23"                                                                                                                                                                                  
     alpha_Qd(9) = "24"                                                                                                                                                                                  
     alpha_Qd(10) = "25"                                                                                                                                                                                 
     alpha_Qd(11) = "31"                                                                                                                                                                                 
     alpha_Qd(12) = "32"                                                                                                                                                                                 
     alpha_Qd(13) = "33"                                                                                                                                                                                 
     alpha_Qd(14) = "34"                                                                                                                                                                                 
     alpha_Qd(15) = "35"                                                                                                                                                                                 
     count=1;                                                                                                                                                                                            
                                                                                                                                                                                                         
     do l=1,15                                                                                                                                                                                           
         do m=1,6                                                                                                                                                                                        
             disp_arr(count) = alpha_Qd(l)//alpha_arr(m)                                                                                                                                                 
             count=count+1                                                                                                                                                                               
         end do                                                                                                                                                                                          
     end do                                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     call GetStr(i,stri)                                                                                                                                                                                 
     call GetStr(j,strj)                                                                                                                                                                                 
     call GetStr(g,strg)                                                                                                                                                                                 
     call GetStr(h,strh)                                                                                                                                                                                 
                                                                                                                                                                                                         
     str1 =  strg//strh//stri//strj                                                                                                                                                                      
     str3 =  strg//strh//strj//stri                                                                                                                                                                      
     ! write(str1, '(i1.1, i1.1,i1.1, i1.1)') g,h,i, j                                                                                                                                                   
     ! write(str3, '(i1.1, i1.1,i1.1, i1.1)') g,h,j, i                                                                                                                                                   
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     do s = 1,90                                                                                                                                                                                         
                                                                                                                                                                                                         
         if (disp_arr(s)==str1 .Or. disp_arr(s)==str3 ) Then                                                                                                                                             
                                                                                                                                                                                                         
             index = s                                                                                                                                                                                   
         end if                                                                                                                                                                                          
     end do                                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 END SUBROUTINE GetIndex_mQd_mm                                                                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE GetIndex_mm_mQd (g,h,i,j,index)                                                                                                                                                              
                                                                                                                                                                                                         
     Character(len = 2) , dimension(6)::alpha_arr                                                                                                                                                        
     Character(len = 2) , dimension(15)::alpha_Qd                                                                                                                                                        
     Character(len = 20) , dimension(90)::disp_arr                                                                                                                                                       
     Integer , INTENT(IN) :: i,j,g,h                                                                                                                                                                     
     Integer, INTENT(INOUT) :: index                                                                                                                                                                     
     Character(Len=1)::stri,strj,strg,strh                                                                                                                                                               
     Integer :: s,l,m,count,count_mQ,u,v                                                                                                                                                                 
                                                                                                                                                                                                         
     Character(len = 10) ::str1,str2,str3,str4                                                                                                                                                           
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     alpha_arr(1) = "11"                                                                                                                                                                                 
     alpha_arr(2) = "12"                                                                                                                                                                                 
     alpha_arr(3) = "13"                                                                                                                                                                                 
     alpha_arr(4) = "22"                                                                                                                                                                                 
     alpha_arr(5) = "23"                                                                                                                                                                                 
     alpha_arr(6) = "33"                                                                                                                                                                                 
                                                                                                                                                                                                         
     alpha_Qd(1) = "11"                                                                                                                                                                                  
     alpha_Qd(2) = "12"                                                                                                                                                                                  
     alpha_Qd(3) = "13"                                                                                                                                                                                  
     alpha_Qd(4) = "14"                                                                                                                                                                                  
     alpha_Qd(5) = "15"                                                                                                                                                                                  
     alpha_Qd(6) = "21"                                                                                                                                                                                  
     alpha_Qd(7) = "22"                                                                                                                                                                                  
     alpha_Qd(8) = "23"                                                                                                                                                                                  
     alpha_Qd(9) = "24"                                                                                                                                                                                  
     alpha_Qd(10) = "25"                                                                                                                                                                                 
     alpha_Qd(11) = "31"                                                                                                                                                                                 
     alpha_Qd(12) = "32"                                                                                                                                                                                 
     alpha_Qd(13) = "33"                                                                                                                                                                                 
     alpha_Qd(14) = "34"                                                                                                                                                                                 
     alpha_Qd(15) = "35"                                                                                                                                                                                 
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     ! count_mQ =1;                                                                                                                                                                                      
                                                                                                                                                                                                         
     !     do u=1,3                                                                                                                                                                                      
     !         do v=1,5                                                                                                                                                                                  
                                                                                                                                                                                                         
     !         write(alpha_Qd(count_mQ) , '(i1.1, i1.1)') u,v                                                                                                                                            
     !         count_mQ=count_mQ+1                                                                                                                                                                       
     !     end do                                                                                                                                                                                        
     ! end do                                                                                                                                                                                            
                                                                                                                                                                                                         
     count=1;                                                                                                                                                                                            
                                                                                                                                                                                                         
     do l=1,15                                                                                                                                                                                           
         do m=1,6                                                                                                                                                                                        
             disp_arr(count) = alpha_arr(m)//alpha_Qd(l)                                                                                                                                                 
             count=count+1                                                                                                                                                                               
         end do                                                                                                                                                                                          
     end do                                                                                                                                                                                              
                                                                                                                                                                                                         
     call GetStr(i,stri)                                                                                                                                                                                 
     call GetStr(j,strj)                                                                                                                                                                                 
     call GetStr(g,strg)                                                                                                                                                                                 
     call GetStr(h,strh)                                                                                                                                                                                 
                                                                                                                                                                                                         
     str1 =  strg//strh//stri//strj                                                                                                                                                                      
     str2 =  strh//strg//stri//strj                                                                                                                                                                      
                                                                                                                                                                                                         
     ! write(str1, '(i1.1, i1.1,i1.1, i1.1)') g,h,i, j                                                                                                                                                   
     ! write(str2, '(i1.1, i1.1,i1.1, i1.1)') h,g,i, j                                                                                                                                                   
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     do s = 1,90                                                                                                                                                                                         
                                                                                                                                                                                                         
         if (disp_arr(s)==str1 .Or. disp_arr(s)==str2 ) Then                                                                                                                                             
                                                                                                                                                                                                         
             index = s                                                                                                                                                                                   
         end if                                                                                                                                                                                          
     end do                                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 END SUBROUTINE GetIndex_mm_mQd                                                                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE GetIndex_mmm (h,i,j,index)                                                                                                                                                                   
                                                                                                                                                                                                         
     Character(len = 20) , dimension(10)::beta_arr                                                                                                                                                       
     Integer , INTENT(IN) :: h,i , j                                                                                                                                                                     
     Character(Len=1)::stri,strj,strh                                                                                                                                                                    
     Integer, INTENT(INOUT) :: index                                                                                                                                                                     
                                                                                                                                                                                                         
     Integer :: s                                                                                                                                                                                        
                                                                                                                                                                                                         
     Character(len = 3) ::str1,str2,str3,str4,str5,str6                                                                                                                                                  
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     beta_arr(1) = "111"                                                                                                                                                                                 
     beta_arr(2) = "112"                                                                                                                                                                                 
     beta_arr(3) = "113"                                                                                                                                                                                 
     beta_arr(4) = "122"                                                                                                                                                                                 
     beta_arr(5) = "123"                                                                                                                                                                                 
     beta_arr(6) = "133"                                                                                                                                                                                 
     beta_arr(7) = "222"                                                                                                                                                                                 
     beta_arr(8) = "223"                                                                                                                                                                                 
     beta_arr(9) = "233"                                                                                                                                                                                 
     beta_arr(10) = "333"                                                                                                                                                                                
                                                                                                                                                                                                         
     call GetStr(i,stri)                                                                                                                                                                                 
     call GetStr(j,strj)                                                                                                                                                                                 
     call GetStr(h,strh)                                                                                                                                                                                 
                                                                                                                                                                                                         
     str1 =  strh//stri//strj                                                                                                                                                                            
     str2 =  strh//strj//stri                                                                                                                                                                            
     str3 =  stri//strh//strj                                                                                                                                                                            
     str4 =  stri//strj//strh                                                                                                                                                                            
     str5 =  strj//strh//stri                                                                                                                                                                            
     str6 =  strj//stri//strh                                                                                                                                                                            
     ! write(str1, '(i1.1, i1.1, i1.1)') h,i, j                                                                                                                                                          
     ! write(str2, '(i1.1, i1.1, i1.1)') h,j, i                                                                                                                                                          
     ! write(str3, '(i1.1, i1.1, i1.1)') i, h,j                                                                                                                                                          
     ! write(str4, '(i1.1, i1.1, i1.1)') j, h,i                                                                                                                                                          
     ! write(str5, '(i1.1, i1.1, i1.1)') i, j,h                                                                                                                                                          
     ! write(str6, '(i1.1, i1.1, i1.1)') j, i,h                                                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     index=1                                                                                                                                                                                             
     do s = 1,10                                                                                                                                                                                         
                                                                                                                                                                                                         
         if (beta_arr(s)==str1 .Or. beta_arr(s)==str2 .Or. beta_arr(s)==str3 .Or. beta_arr(s)==str4 &                                                                                                    
             .Or. beta_arr(s)==str5 .Or. beta_arr(s)==str6) Then                                                                                                                                         
             index = s;                                                                                                                                                                                  
         end if                                                                                                                                                                                          
     end do                                                                                                                                                                                              
                                                                                                                                                                                                         
 END SUBROUTINE GetIndex_mmm                                                                                                                                                                             
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE GetIndex_mmQd (h,i,j,index)                                                                                                                                                                  
                                                                                                                                                                                                         
     Character(len = 20) , dimension(30)::beta_arr                                                                                                                                                       
     Integer , INTENT(IN) :: h,i , j                                                                                                                                                                     
     Integer, INTENT(INOUT) :: index                                                                                                                                                                     
                                                                                                                                                                                                         
     Integer :: s                                                                                                                                                                                        
     Character(Len=1)::stri,strj,strh                                                                                                                                                                    
     Character(len = 3) ::str1,str3                                                                                                                                                                      
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     beta_arr(1) = "111"                                                                                                                                                                                 
     beta_arr(2) = "112"                                                                                                                                                                                 
     beta_arr(3) = "113"                                                                                                                                                                                 
     beta_arr(4) = "114"                                                                                                                                                                                 
     beta_arr(5) = "115"                                                                                                                                                                                 
                                                                                                                                                                                                         
     beta_arr(6) = "121"                                                                                                                                                                                 
     beta_arr(7) = "122"                                                                                                                                                                                 
     beta_arr(8) = "123"                                                                                                                                                                                 
     beta_arr(9) = "124"                                                                                                                                                                                 
     beta_arr(10) = "125"                                                                                                                                                                                
                                                                                                                                                                                                         
     beta_arr(11) = "131"                                                                                                                                                                                
     beta_arr(12) = "132"                                                                                                                                                                                
     beta_arr(13) = "133"                                                                                                                                                                                
     beta_arr(14) = "134"                                                                                                                                                                                
     beta_arr(15) = "135"                                                                                                                                                                                
                                                                                                                                                                                                         
     beta_arr(16) = "221"                                                                                                                                                                                
     beta_arr(17) = "222"                                                                                                                                                                                
     beta_arr(18) = "223"                                                                                                                                                                                
     beta_arr(19) = "224"                                                                                                                                                                                
     beta_arr(20) = "225"                                                                                                                                                                                
                                                                                                                                                                                                         
     beta_arr(21) = "231"                                                                                                                                                                                
     beta_arr(22) = "232"                                                                                                                                                                                
     beta_arr(23) = "233"                                                                                                                                                                                
     beta_arr(24) = "234"                                                                                                                                                                                
     beta_arr(25) = "235"                                                                                                                                                                                
                                                                                                                                                                                                         
     beta_arr(26) = "331"                                                                                                                                                                                
     beta_arr(27) = "332"                                                                                                                                                                                
     beta_arr(28) = "333"                                                                                                                                                                                
     beta_arr(29) = "334"                                                                                                                                                                                
     beta_arr(30) = "335"                                                                                                                                                                                
                                                                                                                                                                                                         
     call GetStr(i,stri)                                                                                                                                                                                 
     call GetStr(j,strj)                                                                                                                                                                                 
     call GetStr(h,strh)                                                                                                                                                                                 
                                                                                                                                                                                                         
     str1 =  strh//stri//strj                                                                                                                                                                            
     str3 =  stri//strh//strj                                                                                                                                                                            
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     index=1                                                                                                                                                                                             
     do s = 1,30                                                                                                                                                                                         
                                                                                                                                                                                                         
         if (beta_arr(s)==str1 .Or. beta_arr(s)==str3 ) Then                                                                                                                                             
             index = s;                                                                                                                                                                                  
         end if                                                                                                                                                                                          
     end do                                                                                                                                                                                              
                                                                                                                                                                                                         
 END SUBROUTINE GetIndex_mmQd                                                                                                                                                                            
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE GetIndex_mQd_mQd (g,h,i,j,index)                                                                                                                                                             
                                                                                                                                                                                                         
     Character(len = 2) , dimension(15)::alpha_Qd                                                                                                                                                        
     Character(len = 20) , dimension(225)::disp_arr                                                                                                                                                      
     Integer , INTENT(IN) :: i,j,g,h                                                                                                                                                                     
     Integer, INTENT(INOUT) :: index                                                                                                                                                                     
     Character(Len=1)::stri,strj,strh,strg                                                                                                                                                               
     Integer :: s,l,m,count,count_mQ,u,v                                                                                                                                                                 
                                                                                                                                                                                                         
     Character(len = 10) ::str1                                                                                                                                                                          
                                                                                                                                                                                                         
     alpha_Qd(1) = "11"                                                                                                                                                                                  
     alpha_Qd(2) = "12"                                                                                                                                                                                  
     alpha_Qd(3) = "13"                                                                                                                                                                                  
     alpha_Qd(4) = "14"                                                                                                                                                                                  
     alpha_Qd(5) = "15"                                                                                                                                                                                  
     alpha_Qd(6) = "21"                                                                                                                                                                                  
     alpha_Qd(7) = "22"                                                                                                                                                                                  
     alpha_Qd(8) = "23"                                                                                                                                                                                  
     alpha_Qd(9) = "24"                                                                                                                                                                                  
     alpha_Qd(10) = "25"                                                                                                                                                                                 
     alpha_Qd(11) = "31"                                                                                                                                                                                 
     alpha_Qd(12) = "32"                                                                                                                                                                                 
     alpha_Qd(13) = "33"                                                                                                                                                                                 
     alpha_Qd(14) = "34"                                                                                                                                                                                 
     alpha_Qd(15) = "35"                                                                                                                                                                                 
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     ! count_mQ =1;                                                                                                                                                                                      
                                                                                                                                                                                                         
     !     do u=1,3                                                                                                                                                                                      
     !         do v=1,5                                                                                                                                                                                  
                                                                                                                                                                                                         
     !         write(alpha_Qd_A(count_mQ) , '(i1.1, i1.1)') u,v                                                                                                                                          
     !         count_mQ=count_mQ+1                                                                                                                                                                       
     !     end do                                                                                                                                                                                        
     ! end do                                                                                                                                                                                            
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     alpha_Qd_B = alpha_Qd_A                                                                                                                                                                             
     count=1;                                                                                                                                                                                            
                                                                                                                                                                                                         
     do l=1,15                                                                                                                                                                                           
         do m=1,15                                                                                                                                                                                       
             disp_arr(count) = alpha_Qd(l)//alpha_Qd(m)                                                                                                                                                  
             count=count+1                                                                                                                                                                               
         end do                                                                                                                                                                                          
     end do                                                                                                                                                                                              
                                                                                                                                                                                                         
   !  write(str1, '(i1.1, i1.1,i1.1, i1.1)') g,h,i, j                                                                                                                                                    
     call GetStr(i,stri)                                                                                                                                                                                 
     call GetStr(j,strj)                                                                                                                                                                                 
     call GetStr(g,strg)                                                                                                                                                                                 
     call GetStr(h,strh)                                                                                                                                                                                 
                                                                                                                                                                                                         
     str1 =  strg//strh//stri//strj                                                                                                                                                                      
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     do s = 1,225                                                                                                                                                                                        
                                                                                                                                                                                                         
         if (disp_arr(s)==str1 ) Then                                                                                                                                                                    
                                                                                                                                                                                                         
             index = s                                                                                                                                                                                   
         end if                                                                                                                                                                                          
     end do                                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 END SUBROUTINE GetIndex_mQd_mQd                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE GetIndex_mO_mm (g,h,i,j,index)                                                                                                                                                               
                                                                                                                                                                                                         
     Character(len = 2) , dimension(6)::alpha_arr                                                                                                                                                        
     Character(len = 2) , dimension(21)::alpha_mO                                                                                                                                                        
     Character(len = 20) , dimension(126)::disp_arr                                                                                                                                                      
     Integer , INTENT(IN) :: i,j,g,h                                                                                                                                                                     
     Integer, INTENT(INOUT) :: index                                                                                                                                                                     
     Character(Len=1)::stri,strj,strh,strg                                                                                                                                                               
     Integer :: s,l,m,count,count_mO,u,v                                                                                                                                                                 
                                                                                                                                                                                                         
     Character(len = 10) ::str1,str2,str3,str4                                                                                                                                                           
                                                                                                                                                                                                         
     alpha_arr(1) = "11"                                                                                                                                                                                 
     alpha_arr(2) = "12"                                                                                                                                                                                 
     alpha_arr(3) = "13"                                                                                                                                                                                 
     alpha_arr(4) = "22"                                                                                                                                                                                 
     alpha_arr(5) = "23"                                                                                                                                                                                 
     alpha_arr(6) = "33"                                                                                                                                                                                 
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     alpha_mO(1) = "11"                                                                                                                                                                                  
     alpha_mO(2) = "12"                                                                                                                                                                                  
     alpha_mO(3) = "13"                                                                                                                                                                                  
     alpha_mO(4) = "14"                                                                                                                                                                                  
     alpha_mO(5) = "15"                                                                                                                                                                                  
     alpha_mO(6) = "16"                                                                                                                                                                                  
     alpha_mO(7) = "17"                                                                                                                                                                                  
     alpha_mO(8) = "21"                                                                                                                                                                                  
     alpha_mO(9) = "22"                                                                                                                                                                                  
     alpha_mO(10) = "23"                                                                                                                                                                                 
     alpha_mO(11) = "24"                                                                                                                                                                                 
     alpha_mO(12) = "25"                                                                                                                                                                                 
     alpha_mO(13) = "26"                                                                                                                                                                                 
     alpha_mO(14) = "27"                                                                                                                                                                                 
     alpha_mO(15) = "31"                                                                                                                                                                                 
     alpha_mO(16) = "32"                                                                                                                                                                                 
     alpha_mO(17) = "33"                                                                                                                                                                                 
     alpha_mO(18) = "34"                                                                                                                                                                                 
     alpha_mO(19) = "35"                                                                                                                                                                                 
     alpha_mO(20) = "36"                                                                                                                                                                                 
     alpha_mO(21) = "37"                                                                                                                                                                                 
                                                                                                                                                                                                         
     ! count_mO =1;                                                                                                                                                                                      
     ! do u=1,3                                                                                                                                                                                          
     !     do v=1,7                                                                                                                                                                                      
     !         write(alpha_mO(count_mO) , '(i1.1, i1.1)') u,v                                                                                                                                            
     !         count_mO=count_mO+1                                                                                                                                                                       
     !     end do                                                                                                                                                                                        
     ! end do                                                                                                                                                                                            
                                                                                                                                                                                                         
     count=1;                                                                                                                                                                                            
                                                                                                                                                                                                         
     do l=1,21                                                                                                                                                                                           
         do m=1,6                                                                                                                                                                                        
             disp_arr(count) = alpha_mO(l)//alpha_arr(m)                                                                                                                                                 
             count=count+1                                                                                                                                                                               
         end do                                                                                                                                                                                          
     end do                                                                                                                                                                                              
                                                                                                                                                                                                         
     call GetStr(i,stri)                                                                                                                                                                                 
     call GetStr(j,strj)                                                                                                                                                                                 
     call GetStr(g,strg)                                                                                                                                                                                 
     call GetStr(h,strh)                                                                                                                                                                                 
                                                                                                                                                                                                         
     str1 =  strg//strh//stri//strj                                                                                                                                                                      
     str3 =  strg//strh//strj//stri                                                                                                                                                                      
                                                                                                                                                                                                         
     ! write(str1, '(i1.1, i1.1,i1.1, i1.1)') g,h,i, j                                                                                                                                                   
     ! write(str3, '(i1.1, i1.1,i1.1, i1.1)') g,h,j, i                                                                                                                                                   
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     do s = 1,126                                                                                                                                                                                        
                                                                                                                                                                                                         
         if (disp_arr(s)==str1 .Or. disp_arr(s)==str3 ) Then                                                                                                                                             
                                                                                                                                                                                                         
             index = s                                                                                                                                                                                   
         end if                                                                                                                                                                                          
     end do                                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 END SUBROUTINE GetIndex_mO_mm                                                                                                                                                                           
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE GetIndex_mm_mO (g,h,i,j,index)                                                                                                                                                               
                                                                                                                                                                                                         
     Character(len = 2) , dimension(6)::alpha_arr                                                                                                                                                        
     Character(len = 2) , dimension(21)::alpha_mO                                                                                                                                                        
     Character(len = 20) , dimension(126)::disp_arr                                                                                                                                                      
     Integer , INTENT(IN) :: i,j,g,h                                                                                                                                                                     
     Integer, INTENT(INOUT) :: index                                                                                                                                                                     
     Character(Len=1)::stri,strj,strh,strg                                                                                                                                                               
     Integer :: s,l,m,count,count_mO,u,v                                                                                                                                                                 
                                                                                                                                                                                                         
     Character(len = 10) ::str1,str2                                                                                                                                                                     
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     alpha_arr(1) = "11"                                                                                                                                                                                 
     alpha_arr(2) = "12"                                                                                                                                                                                 
     alpha_arr(3) = "13"                                                                                                                                                                                 
     alpha_arr(4) = "22"                                                                                                                                                                                 
     alpha_arr(5) = "23"                                                                                                                                                                                 
     alpha_arr(6) = "33"                                                                                                                                                                                 
                                                                                                                                                                                                         
     alpha_mO(1) = "11"                                                                                                                                                                                  
     alpha_mO(2) = "12"                                                                                                                                                                                  
     alpha_mO(3) = "13"                                                                                                                                                                                  
     alpha_mO(4) = "14"                                                                                                                                                                                  
     alpha_mO(5) = "15"                                                                                                                                                                                  
     alpha_mO(6) = "16"                                                                                                                                                                                  
     alpha_mO(7) = "17"                                                                                                                                                                                  
     alpha_mO(8) = "21"                                                                                                                                                                                  
     alpha_mO(9) = "22"                                                                                                                                                                                  
     alpha_mO(10) = "23"                                                                                                                                                                                 
     alpha_mO(11) = "24"                                                                                                                                                                                 
     alpha_mO(12) = "25"                                                                                                                                                                                 
     alpha_mO(13) = "26"                                                                                                                                                                                 
     alpha_mO(14) = "27"                                                                                                                                                                                 
     alpha_mO(15) = "31"                                                                                                                                                                                 
     alpha_mO(16) = "32"                                                                                                                                                                                 
     alpha_mO(17) = "33"                                                                                                                                                                                 
     alpha_mO(18) = "34"                                                                                                                                                                                 
     alpha_mO(19) = "35"                                                                                                                                                                                 
     alpha_mO(20) = "36"                                                                                                                                                                                 
     alpha_mO(21) = "37"                                                                                                                                                                                 
                                                                                                                                                                                                         
     ! count_mO =1;                                                                                                                                                                                      
                                                                                                                                                                                                         
     !     do u=1,3                                                                                                                                                                                      
     !         do v=1,7                                                                                                                                                                                  
                                                                                                                                                                                                         
     !         write(alpha_mO(count_mO) , '(i1.1, i1.1)') u,v                                                                                                                                            
     !         count_mO=count_mO+1                                                                                                                                                                       
     !     end do                                                                                                                                                                                        
     ! end do                                                                                                                                                                                            
                                                                                                                                                                                                         
     count=1;                                                                                                                                                                                            
                                                                                                                                                                                                         
     do l=1,21                                                                                                                                                                                           
         do m=1,6                                                                                                                                                                                        
             disp_arr(count) = alpha_arr(m)//alpha_mO(l)                                                                                                                                                 
             count=count+1                                                                                                                                                                               
         end do                                                                                                                                                                                          
     end do                                                                                                                                                                                              
                                                                                                                                                                                                         
     call GetStr(i,stri)                                                                                                                                                                                 
     call GetStr(j,strj)                                                                                                                                                                                 
     call GetStr(g,strg)                                                                                                                                                                                 
     call GetStr(h,strh)                                                                                                                                                                                 
                                                                                                                                                                                                         
     str1 =  strg//strh//stri//strj                                                                                                                                                                      
     str2 =  strh//strg//stri//strj                                                                                                                                                                      
                                                                                                                                                                                                         
     ! write(str1, '(i1.1, i1.1,i1.1, i1.1)') g,h,i, j                                                                                                                                                   
     ! write(str2, '(i1.1, i1.1,i1.1, i1.1)') h,g,i, j                                                                                                                                                   
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     do s = 1,126                                                                                                                                                                                        
                                                                                                                                                                                                         
         if (disp_arr(s)==str1 .Or. disp_arr(s)==str2 ) Then                                                                                                                                             
                                                                                                                                                                                                         
             index = s                                                                                                                                                                                   
         end if                                                                                                                                                                                          
     end do                                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 END SUBROUTINE GetIndex_mm_mO                                                                                                                                                                           
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE GetIndex_QQ_mm (g,h,i,j,index)                                                                                                                                                               
                                                                                                                                                                                                         
     Character(len = 2) , dimension(6)::alpha_arr                                                                                                                                                        
     Character(len = 2) , dimension(15)::alpha_QQ                                                                                                                                                        
     Character(len = 20) , dimension(90)::disp_arr                                                                                                                                                       
     Integer , INTENT(IN) :: i,j,g,h                                                                                                                                                                     
     Integer, INTENT(INOUT) :: index                                                                                                                                                                     
                                                                                                                                                                                                         
     Integer :: s,l,m,count                                                                                                                                                                              
     Character(Len=1)::stri,strj,strh,strg                                                                                                                                                               
     Character(len = 10) ::str1,str2,str3,str4                                                                                                                                                           
                                                                                                                                                                                                         
     alpha_arr(1) = "11"                                                                                                                                                                                 
     alpha_arr(2) = "12"                                                                                                                                                                                 
     alpha_arr(3) = "13"                                                                                                                                                                                 
     alpha_arr(4) = "22"                                                                                                                                                                                 
     alpha_arr(5) = "23"                                                                                                                                                                                 
     alpha_arr(6) = "33"                                                                                                                                                                                 
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     alpha_QQ(1) = "11"                                                                                                                                                                                  
     alpha_QQ(2) = "12"                                                                                                                                                                                  
     alpha_QQ(3) = "13"                                                                                                                                                                                  
     alpha_QQ(4) = "14"                                                                                                                                                                                  
     alpha_QQ(5) = "15"                                                                                                                                                                                  
     alpha_QQ(6) = "22"                                                                                                                                                                                  
     alpha_QQ(7) = "23"                                                                                                                                                                                  
     alpha_QQ(8) = "24"                                                                                                                                                                                  
     alpha_QQ(9) = "25"                                                                                                                                                                                  
     alpha_QQ(10) = "33"                                                                                                                                                                                 
     alpha_QQ(11) = "34"                                                                                                                                                                                 
     alpha_QQ(12) = "35"                                                                                                                                                                                 
     alpha_QQ(13) = "44"                                                                                                                                                                                 
     alpha_QQ(14) = "45"                                                                                                                                                                                 
     alpha_QQ(15) = "55"                                                                                                                                                                                 
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     count=1;                                                                                                                                                                                            
                                                                                                                                                                                                         
     do l=1,15                                                                                                                                                                                           
         do m=1,6                                                                                                                                                                                        
             disp_arr(count) = alpha_QQ(l)//alpha_arr(m)                                                                                                                                                 
             count=count+1                                                                                                                                                                               
         end do                                                                                                                                                                                          
     end do                                                                                                                                                                                              
                                                                                                                                                                                                         
     call GetStr(i,stri)                                                                                                                                                                                 
     call GetStr(j,strj)                                                                                                                                                                                 
     call GetStr(g,strg)                                                                                                                                                                                 
     call GetStr(h,strh)                                                                                                                                                                                 
                                                                                                                                                                                                         
     str1 =  strg//strh//stri//strj                                                                                                                                                                      
     str2 =  strh//strg//stri//strj                                                                                                                                                                      
     str3 =  strg//strh//strj//stri                                                                                                                                                                      
     str4 =  strh//strg//strj//stri                                                                                                                                                                      
                                                                                                                                                                                                         
     ! write(str1, '(i1.1, i1.1,i1.1, i1.1)') g,h,i,j                                                                                                                                                    
     ! write(str3, '(i1.1, i1.1,i1.1, i1.1)') g,h,j,i                                                                                                                                                    
                                                                                                                                                                                                         
     ! write(str2, '(i1.1, i1.1,i1.1, i1.1)') h,g,i,j                                                                                                                                                    
     ! write(str4, '(i1.1, i1.1,i1.1, i1.1)') h,g,j,i                                                                                                                                                    
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     do s = 1,90                                                                                                                                                                                         
                                                                                                                                                                                                         
         if (disp_arr(s)==str1 .Or. disp_arr(s)==str3 .Or. disp_arr(s)==str2 .Or. disp_arr(s)==str4 ) Then                                                                                               
                                                                                                                                                                                                         
             index = s                                                                                                                                                                                   
         end if                                                                                                                                                                                          
     end do                                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 END SUBROUTINE GetIndex_QQ_mm                                                                                                                                                                           
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE GetIndex_mm_QQ(g,h,i,j,index)                                                                                                                                                                
                                                                                                                                                                                                         
     Character(len = 2) , dimension(6)::alpha_arr                                                                                                                                                        
     Character(len = 2) , dimension(15)::alpha_QQ                                                                                                                                                        
     Character(len = 20) , dimension(90)::disp_arr                                                                                                                                                       
     Integer , INTENT(IN) :: i,j,g,h                                                                                                                                                                     
     Integer, INTENT(INOUT) :: index                                                                                                                                                                     
                                                                                                                                                                                                         
     Integer :: s,l,m,count                                                                                                                                                                              
     Character(Len=1)::stri,strj,strh,strg                                                                                                                                                               
     Character(len = 10) ::str1,str2,str3,str4                                                                                                                                                           
                                                                                                                                                                                                         
     alpha_arr(1) = "11"                                                                                                                                                                                 
     alpha_arr(2) = "12"                                                                                                                                                                                 
     alpha_arr(3) = "13"                                                                                                                                                                                 
     alpha_arr(4) = "22"                                                                                                                                                                                 
     alpha_arr(5) = "23"                                                                                                                                                                                 
     alpha_arr(6) = "33"                                                                                                                                                                                 
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     alpha_QQ(1) = "11"                                                                                                                                                                                  
     alpha_QQ(2) = "12"                                                                                                                                                                                  
     alpha_QQ(3) = "13"                                                                                                                                                                                  
     alpha_QQ(4) = "14"                                                                                                                                                                                  
     alpha_QQ(5) = "15"                                                                                                                                                                                  
     alpha_QQ(6) = "22"                                                                                                                                                                                  
     alpha_QQ(7) = "23"                                                                                                                                                                                  
     alpha_QQ(8) = "24"                                                                                                                                                                                  
     alpha_QQ(9) = "25"                                                                                                                                                                                  
     alpha_QQ(10) = "33"                                                                                                                                                                                 
     alpha_QQ(11) = "34"                                                                                                                                                                                 
     alpha_QQ(12) = "35"                                                                                                                                                                                 
     alpha_QQ(13) = "44"                                                                                                                                                                                 
     alpha_QQ(14) = "45"                                                                                                                                                                                 
     alpha_QQ(15) = "55"                                                                                                                                                                                 
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     count=1;                                                                                                                                                                                            
                                                                                                                                                                                                         
     do l=1,15                                                                                                                                                                                           
         do m=1,6                                                                                                                                                                                        
             disp_arr(count) = alpha_arr(m)//alpha_QQ(l)                                                                                                                                                 
             count=count+1                                                                                                                                                                               
         end do                                                                                                                                                                                          
     end do                                                                                                                                                                                              
                                                                                                                                                                                                         
     call GetStr(i,stri)                                                                                                                                                                                 
     call GetStr(j,strj)                                                                                                                                                                                 
     call GetStr(g,strg)                                                                                                                                                                                 
     call GetStr(h,strh)                                                                                                                                                                                 
                                                                                                                                                                                                         
     str1 =  strg//strh//stri//strj                                                                                                                                                                      
     str2 =  strh//strg//stri//strj                                                                                                                                                                      
     str3 =  strg//strh//strj//stri                                                                                                                                                                      
     str4 =  strh//strg//strj//stri                                                                                                                                                                      
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     ! write(str1, '(i1.1, i1.1,i1.1, i1.1)') g,h,i,j                                                                                                                                                    
     ! write(str3, '(i1.1, i1.1,i1.1, i1.1)') g,h,j,i                                                                                                                                                    
                                                                                                                                                                                                         
     ! write(str2, '(i1.1, i1.1,i1.1, i1.1)') h,g,i,j                                                                                                                                                    
     ! write(str4, '(i1.1, i1.1,i1.1, i1.1)') h,g,j,i                                                                                                                                                    
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     do s = 1,90                                                                                                                                                                                         
                                                                                                                                                                                                         
         if (disp_arr(s)==str1 .Or. disp_arr(s)==str3 .Or. disp_arr(s)==str2 .Or. disp_arr(s)==str4 ) Then                                                                                               
                                                                                                                                                                                                         
             index = s                                                                                                                                                                                   
         end if                                                                                                                                                                                          
     end do                                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 END SUBROUTINE GetIndex_mm_QQ                                                                                                                                                                           
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE GetStr(i,stri)                                                                                                                                                                               
                                                                                                                                                                                                         
     Integer , INTENT(IN) :: i                                                                                                                                                                           
     Character(len = 1), INTENT(INOUT) ::stri                                                                                                                                                            
                                                                                                                                                                                                         
     if (i==0)then                                                                                                                                                                                       
         stri ="0"                                                                                                                                                                                       
         Return                                                                                                                                                                                          
     elseif (i==1)then                                                                                                                                                                                   
         stri ="1"                                                                                                                                                                                       
         Return                                                                                                                                                                                          
     elseif (i==2)then                                                                                                                                                                                   
         stri ="2"                                                                                                                                                                                       
         Return                                                                                                                                                                                          
     elseif (i==3)then                                                                                                                                                                                   
         stri ="3"                                                                                                                                                                                       
         Return                                                                                                                                                                                          
     elseif (i==4)then                                                                                                                                                                                   
         stri ="4"                                                                                                                                                                                       
         Return                                                                                                                                                                                          
     elseif (i==5)then                                                                                                                                                                                   
         stri ="5"                                                                                                                                                                                       
         Return                                                                                                                                                                                          
     elseif (i==6)then                                                                                                                                                                                   
         stri ="6"                                                                                                                                                                                       
         Return                                                                                                                                                                                          
     elseif (i==7)then                                                                                                                                                                                   
         stri ="7"                                                                                                                                                                                       
         Return                                                                                                                                                                                          
     elseif (i==8)then                                                                                                                                                                                   
         stri ="8"                                                                                                                                                                                       
         Return                                                                                                                                                                                          
     elseif (i==9)then                                                                                                                                                                                   
         stri ="9"                                                                                                                                                                                       
         Return                                                                                                                                                                                          
     endif                                                                                                                                                                                               
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 END SUBROUTINE GetStr                                                                                                                                                                                   
 SUBROUTINE Coordinate_Transformation(coordenates,coord_format,new_coordinates)                                                                                                                          
     IMPLICIT NONE                                                                                                                                                                                       
     real*8 ,dimension(6), INTENT(IN):: coordenates                                                                                                                                                      
                                                                                                                                                                                                         
     Character(len = 20), INTENT(IN) :: coord_format                                                                                                                                                     
     real*8 , dimension(6), INTENT(INOUT) :: new_coordinates                                                                                                                                             
                                                                                                                                                                                                         
     new_coordinates=coordenates;                                                                                                                                                                        
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     if (coord_format == "Euler_ZYZ") then                                                                                                                                                               
         new_coordinates(5) = coordenates(5) - 90                                                                                                                                                        
         new_coordinates(6) = coordenates(6) - 90                                                                                                                                                        
     end if                                                                                                                                                                                              
     if (coord_format == "Spherical") then                                                                                                                                                               
         new_coordinates(5) = 90 - coordenates(5)                                                                                                                                                        
         new_coordinates(6) = 90 -coordenates(6)                                                                                                                                                         
     end if                                                                                                                                                                                              
                                                                                                                                                                                                         
 End   SUBROUTINE Coordinate_Transformation                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     !********************************************************                                                                                                                                           
 SUBROUTINE General_Coordinates_Format(Dim, old_coordinates, general_coodinates)                                                                                                                         
             IMPLICIT NONE                                                                                                                                                                               
                                                                                                                                                                                                         
             INTEGER,INTENT(IN) ::  Dim                                                                                                                                                                  
             real*8 , dimension(6), INTENT(INOUT) ::general_coodinates                                                                                                                                   
             real*8 , dimension (Dim),INTENT(IN) :: old_coordinates                                                                                                                                      
                                                                                                                                                                                                         
                                                                                                                                                                                                         
             if (Dim==2) then                                                                                                                                                                            
                     general_coodinates(1) = old_coordinates(1)  !R                                                                                                                                      
                     general_coodinates(2) = old_coordinates(2)  !b1                                                                                                                                     
                     general_coodinates(3) = 0d0  !b2                                                                                                                                                    
                     general_coodinates(4) = 0d0  !phi                                                                                                                                                   
                     general_coodinates(5) = 0d0  !c1                                                                                                                                                    
                     general_coodinates(6) = 0d0  !c2                                                                                                                                                    
                                                                                                                                                                                                         
                 elseif (Dim==3) then                                                                                                                                                                    
                     general_coodinates(1) = old_coordinates(1)  !R                                                                                                                                      
                     general_coodinates(2) = old_coordinates(2)  !b1                                                                                                                                     
                     general_coodinates(3) = 0d0  !b2                                                                                                                                                    
                     general_coodinates(4) = 0d0  !phi                                                                                                                                                   
                     general_coodinates(5) = old_coordinates(3)  !c1                                                                                                                                     
                     general_coodinates(6) = 0d0  !c2                                                                                                                                                    
                                                                                                                                                                                                         
                 elseif (Dim==4) then                                                                                                                                                                    
                     general_coodinates(1) = old_coordinates(1)  !R                                                                                                                                      
                     general_coodinates(2) = old_coordinates(2)  !b1                                                                                                                                     
                     general_coodinates(3) = old_coordinates(3)  !b2                                                                                                                                     
                     general_coodinates(4) = old_coordinates(4)  !phi                                                                                                                                    
                     general_coodinates(5) = 0d0  !c1                                                                                                                                                    
                     general_coodinates(6) = 0d0  !c2                                                                                                                                                    
                                                                                                                                                                                                         
                 elseif (Dim==5) then                                                                                                                                                                    
                         general_coodinates(1) = old_coordinates(1)  !R                                                                                                                                  
                         general_coodinates(2) = old_coordinates(2)  !b1                                                                                                                                 
                         general_coodinates(3) = old_coordinates(3)  !b2                                                                                                                                 
                         general_coodinates(4) = old_coordinates(4)  !phi                                                                                                                                
                         general_coodinates(5) = old_coordinates(5)  !c1                                                                                                                                 
                         general_coodinates(6) = 0d0  !c2                                                                                                                                                
                 elseif (Dim==6) then                                                                                                                                                                    
                         general_coodinates(1) = old_coordinates(1)  !R                                                                                                                                  
                         general_coodinates(2) = old_coordinates(2)  !b1                                                                                                                                 
                         general_coodinates(3) = old_coordinates(3)  !b2                                                                                                                                 
                         general_coodinates(4) = old_coordinates(4)  !phi                                                                                                                                
                         general_coodinates(5) = old_coordinates(5)  !c1                                                                                                                                 
                         general_coodinates(6) = old_coordinates(6)  !c2                                                                                                                                 
                                                                                                                                                                                                         
             end if                                                                                                                                                                                      
                                                                                                                                                                                                         
             RETURN                                                                                                                                                                                      
 END SUBROUTINE General_Coordinates_Format                                                                                                                                                               
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE Generate_Coordenates(coordenates,cal_coord,Ar,Br,C)                                                                                                                                          
                                                                                                                                                                                                         
     real*8 , dimension(11), INTENT(INOUT):: cal_coord                                                                                                                                                   
     real*8 ,dimension(6), INTENT(IN)  :: coordenates ! the angles are in degree                                                                                                                         
     real*8, parameter :: pii = DACOS(-1.d0)                                                                                                                                                             
     real*8 , dimension(3), INTENT(INOUT):: Ar                                                                                                                                                           
     real*8 , dimension(3), INTENT(INOUT):: Br                                                                                                                                                           
     real*8 , dimension(9), INTENT(INOUT):: C                                                                                                                                                            
                                                                                                                                                                                                         
     real*8 :: cos_b1,cos_b2,cos_c1,cos_c2,sin_b1,sin_b2,sin_c1,sin_c2,cos_phi,sin_phi                                                                                                                   
                                                                                                                                                                                                         
         cal_coord(1) = coordenates(1)                                                                                                                                                                   
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         cal_coord(2)  = DCOS(coordenates(2)*pii/180d0)                                                                                                                                                  
         cal_coord(3) = DSIN(coordenates(2)*pii/180d0)                                                                                                                                                   
                                                                                                                                                                                                         
         cal_coord(4) = DCOS(coordenates(3)*pii/180d0)                                                                                                                                                   
         cal_coord(5) = DSIN(coordenates(3)*pii/180d0)                                                                                                                                                   
                                                                                                                                                                                                         
         cal_coord(6) = DCOS(coordenates(4)*pii/180d0)                                                                                                                                                   
         cal_coord(7) = DSIN(coordenates(4)*pii/180d0)                                                                                                                                                   
                                                                                                                                                                                                         
         cal_coord(8) = DCOS(coordenates(5)*pii/180d0)                                                                                                                                                   
         cal_coord(9) = DSIN(coordenates(5)*pii/180d0)                                                                                                                                                   
                                                                                                                                                                                                         
         cal_coord(10) = DCOS(coordenates(6)*pii/180d0)                                                                                                                                                  
         cal_coord(11) = DSIN(coordenates(6)*pii/180d0)                                                                                                                                                  
                                                                                                                                                                                                         
        ! write(*,*)"cal_coord",cal_coord(2),cal_coord(4),coordenates(4)*pii/180d0                                                                                                                       
                                                                                                                                                                                                         
         cos_b1 =    cal_coord(2)                                                                                                                                                                        
         sin_b1 =    cal_coord(3)                                                                                                                                                                        
         cos_b2 =    cal_coord(4)                                                                                                                                                                        
         sin_b2 =    cal_coord(5)                                                                                                                                                                        
         cos_phi =   cal_coord(6)                                                                                                                                                                        
         sin_phi =   cal_coord(7)                                                                                                                                                                        
         cos_c1 =    cal_coord(8)                                                                                                                                                                        
         sin_c1 =    cal_coord(9)                                                                                                                                                                        
         cos_c2 =    cal_coord(10)                                                                                                                                                                       
         sin_c2 =    cal_coord(11)                                                                                                                                                                       
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         Ar(1) = cos_b1           !Az                                                                                                                                                                    
         Ar(2) = cos_c1*sin_b1    !Ay                                                                                                                                                                    
         Ar(3) = sin_b1*sin_c1    !Ax                                                                                                                                                                    
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         Br(1) = -cos_b2           !Bz                                                                                                                                                                   
         Br(2) = -cos_c2*sin_b2    !By                                                                                                                                                                   
         Br(3) = -sin_b2*sin_c2    !Bx                                                                                                                                                                   
                                                                                                                                                                                                         
         C(1)= cos_b1*cos_b2 + cos_phi*sin_b1*sin_b2 !Czz                                                                                                                                                
         C(2)= cos_b2*sin_b1*sin_c1 - sin_b2 *(cos_c1*sin_phi + cos_phi*cos_b1*sin_c1)  !Cxz                                                                                                             
         C(3)= cos_b2*cos_c1*sin_b1 + sin_b2 *(-cos_phi*cos_b1*cos_c1 + sin_phi*sin_c1) !Cyz                                                                                                             
                                                                                                                                                                                                         
         C(4)= cos_c2*sin_phi*sin_b1 + (-cos_phi*cos_b2*sin_b1 + cos_b1*sin_b2)*sin_c2; !Czx                                                                                                             
         C(5)= -cos_b1*cos_c2*sin_phi*sin_c1 + (cos_b2*cos_c1*sin_phi + sin_b1*sin_b2*sin_c1)*sin_c2 &                                                                                                   
         + cos_phi *(cos_c1*cos_c2 + cos_b1*cos_b2*sin_c1*sin_c2) !Cxx                                                                                                                                   
         C(6)= cos_c1*sin_b1*sin_b2*sin_c2 + cos_b1*cos_c1 *(-cos_c2*sin_phi + cos_phi*cos_b2*sin_c2) - &                                                                                                
         sin_c1 *(cos_phi*cos_c2 + cos_b2*sin_phi*sin_c2)   !Cyx                                                                                                                                         
                                                                                                                                                                                                         
         C(7)= -cos_phi*cos_b2*cos_c2*sin_b1 + cos_b1*cos_c2*sin_b2 - sin_phi*sin_b1*sin_c2 !Czy                                                                                                         
         C(8)= cos_c2*sin_b1*sin_b2*sin_c1 + cos_b2*cos_c2 *(cos_c1*sin_phi + cos_phi*cos_b1*sin_c1) &                                                                                                   
         + (-cos_phi*cos_c1 + cos_b1*sin_phi*sin_c1)*sin_c2 !Cxy                                                                                                                                         
         C(9)= -cos_b2*cos_c2*sin_phi*sin_c1 + cos_c1 *(cos_c2*sin_b1*sin_b2 + cos_b1*sin_phi*sin_c2) &                                                                                                  
         + cos_phi*(cos_b1*cos_b2*cos_c1*cos_c2 + sin_c1*sin_c2) !Cyy                                                                                                                                    
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 End   SUBROUTINE Generate_Coordenates                                                                                                                                                                   
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE TotalEnergy_Calc (cal_coord,Ar,Br,C,coeff_arr, M_Fit ,D_Fit,I_Fit,H_Fit,TotalEnergy,doTesting,testErr)                                                                                       
                                                                                                                                                                                                         
  implicit none                                                                                                                                                                                          
     real*8, parameter ::  C1=627.5095d0,C2=0.529177249d0,Const=349.757d0                                                                                                                                
     ! real*8 , dimension(8) :: Multipole_Energies!M1,M2,...M8                                                                                                                                           
     ! real*8 , dimension(3) :: Dispersion_Energies !D6, D7                                                                                                                                              
     ! real*8 , dimension(5) :: Ind_Energ !I4 I5 I6 I7 I8                                                                                                                                                
     ! real*8 , dimension(2) :: Hyp_Energ !H6, H7                                                                                                                                                        
                                                                                                                                                                                                         
     Integer, dimension (8) , INTENT(IN):: M_Fit                                                                                                                                                         
     Integer, dimension (2) , INTENT(IN):: D_Fit                                                                                                                                                         
     Integer, dimension (5) , INTENT(IN):: I_Fit                                                                                                                                                         
     Integer, dimension (2) , INTENT(IN):: H_Fit                                                                                                                                                         
     real*8 , dimension(1195) , INTENT(IN):: coeff_arr                                                                                                                                                   
     real*8 , dimension(11) , INTENT(IN):: cal_coord                                                                                                                                                     
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
                                                                                                                                                                                                         
     real*8  , INTENT(INOut) ::TotalEnergy                                                                                                                                                               
     integer::doTesting                                                                                                                                                                                  
     real*8::testErr(52)                                                                                                                                                                                 
     real*8   ::Ene,EM,ED,EH,EI,T10,T20,T30,T40,cal_coord_temp(11)                                                                                                                                       
     Integer :: n ;                                                                                                                                                                                      
     real*8::Multipole_Energies(8),Ind_Energ(5),Hyp_Energ(2),Dispersion_Energies(3)                                                                                                                      
                                                                                                                                                                                                         
     real*8 , dimension(64) :: A_Mult,B_Mult !q, mz, Qz, Oz, Phiz, M5z, M6z, M7z                                                                                                                         
     real*8 , dimension(57) :: A_Pol,B_Pol                                                                                                                                                               
     real*8 , dimension(40) :: A_HPol,B_HPol                                                                                                                                                             
     real*8 , dimension(873) :: Disp_AB                                                                                                                                                                  
                                                                                                                                                                                                         
     real*8 :: Elect_energy(9),Dispe_energy(4),Induc_energy(6),Hyper_energy(3),term                                                                                                                      
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     cal_coord_temp = cal_coord                                                                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     A_Mult=coeff_arr(1:64)                                                                                                                                                                              
     B_Mult=coeff_arr(65:128)                                                                                                                                                                            
     A_Pol=coeff_arr(129:185)                                                                                                                                                                            
     B_Pol=coeff_arr(186:242)                                                                                                                                                                            
     A_HPol=coeff_arr(243:282)                                                                                                                                                                           
     B_HPol=coeff_arr(283:322)                                                                                                                                                                           
     Disp_AB=coeff_arr(323:1195)                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
      Ene = 0.d0                                                                                                                                                                                         
      Multipole_Energies  = 0.d0                                                                                                                                                                         
      ED  = 0.d0                                                                                                                                                                                         
      EI  = 0.d0                                                                                                                                                                                         
      EH  = 0.d0                                                                                                                                                                                         
                                                                                                                                                                                                         
      Elect_energy  = 0.d0                                                                                                                                                                               
      Dispe_energy  = 0.d0                                                                                                                                                                               
      Induc_energy  = 0.d0                                                                                                                                                                               
      Hyper_energy  = 0.d0                                                                                                                                                                               
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     do n = 1, 8                                                                                                                                                                                         
         IF (M_Fit(n) > 0) THEN                                                                                                                                                                          
             if (n==1)Then                                                                                                                                                                               
                 Call Approx_1_Sph2(cal_coord_temp,Ar,Br,C , A_Mult,B_Mult ,Multipole_Energies(1))                                                                                                       
             elseif(n==2)Then                                                                                                                                                                            
                 Call Approx_2_Sph2(cal_coord_temp,Ar,Br,C , A_Mult,B_Mult ,Multipole_Energies(2))                                                                                                       
             elseif(n==3)Then                                                                                                                                                                            
                 Call Approx_3_Sph2(cal_coord_temp,Ar,Br,C , A_Mult,B_Mult ,Multipole_Energies(3))                                                                                                       
             elseif(n==4)Then                                                                                                                                                                            
                 Call Approx_4_Sph2(cal_coord_temp,Ar,Br,C , A_Mult,B_Mult ,Multipole_Energies(4))                                                                                                       
             elseif (n==5)Then                                                                                                                                                                           
                 Call Approx_5_Sph2(cal_coord_temp,Ar,Br,C , A_Mult,B_Mult ,Multipole_Energies(5))                                                                                                       
             elseif(n==6)Then                                                                                                                                                                            
                 Call Approx_6_Sph2(cal_coord_temp,Ar,Br,C , A_Mult,B_Mult ,Multipole_Energies(6))                                                                                                       
             elseif(n==7)Then                                                                                                                                                                            
                 Call Approx_7_Sph2(cal_coord_temp,Ar,Br,C , A_Mult,B_Mult ,Multipole_Energies(7))                                                                                                       
             elseif(n==8)Then                                                                                                                                                                            
                 Call Approx_8_Sph2(cal_coord_temp,Ar,Br,C , A_Mult,B_Mult ,Multipole_Energies(8))                                                                                                       
             endif                                                                                                                                                                                       
                                                                                                                                                                                                         
             term = (C1*C2**n)*Multipole_Energies(n)                                                                                                                                                     
             testErr(5 + n) = Const*term                                                                                                                                                                 
             Elect_energy(1+n) = term                                                                                                                                                                    
             Elect_energy(1) = Elect_energy(1)+term                                                                                                                                                      
             Ene = Ene+term                                                                                                                                                                              
                                                                                                                                                                                                         
          END IF                                                                                                                                                                                         
                                                                                                                                                                                                         
      end do                                                                                                                                                                                             
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
      do n = 6,8                                                                                                                                                                                         
         IF (D_Fit(n-5) > 0) THEN                                                                                                                                                                        
             if(n==6)Then                                                                                                                                                                                
                 Call Dispersion_6_Sph2(cal_coord_temp,Ar,Br,C, Disp_AB  ,ED)                                                                                                                            
             elseif(n==7)Then                                                                                                                                                                            
                 Call Dispersion_7_Sph2(cal_coord_temp,Ar,Br,C, Disp_AB  ,ED)                                                                                                                            
             elseif(n==8)Then                                                                                                                                                                            
                 Call Dispersion_8_Sph2(cal_coord_temp,Ar,Br,C, Disp_AB  ,ED)                                                                                                                            
             endif                                                                                                                                                                                       
                                                                                                                                                                                                         
             term = (C1*C2**n)*ED                                                                                                                                                                        
             testErr(20 + n - 5) = Const*term                                                                                                                                                            
             Dispe_energy(n-4) = term                                                                                                                                                                    
             Dispe_energy(1) = Dispe_energy(1)+term                                                                                                                                                      
             Ene = Ene+term                                                                                                                                                                              
             !Ene = Ene+(C1*C2**n)*ED                                                                                                                                                                    
             !write(*,*)"Multipole_Energies: ",n,Multipole_Energies(n),Const*(C1*C2**n)*Multipole_Energies(n)                                                                                            
          END IF                                                                                                                                                                                         
                                                                                                                                                                                                         
      end do                                                                                                                                                                                             
                                                                                                                                                                                                         
                                                                                                                                                                                                         
      do n = 4, 8                                                                                                                                                                                        
         IF (I_Fit(n-3) > 0) THEN                                                                                                                                                                        
             if(n==4)Then                                                                                                                                                                                
                 Call Induction_4_Sph2(cal_coord_temp,Ar,Br,C , A_Mult,B_Mult ,A_Pol,B_Pol ,EI)                                                                                                          
             elseif (n==5)Then                                                                                                                                                                           
                 Call Induction_5_Sph2(cal_coord_temp,Ar,Br,C , A_Mult,B_Mult ,A_Pol,B_Pol  ,EI)                                                                                                         
             elseif(n==6)Then                                                                                                                                                                            
                 Call Induction_6_Sph2(cal_coord_temp,Ar,Br,C , A_Mult,B_Mult ,A_Pol,B_Pol  ,EI)                                                                                                         
             elseif(n==7)Then                                                                                                                                                                            
                 Call Induction_7_Sph2(cal_coord_temp,Ar,Br,C , A_Mult,B_Mult ,A_Pol,B_Pol  ,EI)                                                                                                         
             elseif(n==8)Then                                                                                                                                                                            
                 Call Induction_8_Sph2(cal_coord_temp,Ar,Br,C , A_Mult,B_Mult ,A_Pol,B_Pol  ,EI)                                                                                                         
             endif                                                                                                                                                                                       
                                                                                                                                                                                                         
             term = (C1*C2**n)*EI                                                                                                                                                                        
             testErr(30 + n-3) = Const*term                                                                                                                                                              
             Induc_energy(n-2) = term                                                                                                                                                                    
             Induc_energy(1) = Induc_energy(1)+term                                                                                                                                                      
             Ene = Ene+term                                                                                                                                                                              
             !Ene = Ene + (C1*C2**n)*EI                                                                                                                                                                  
             !write(*,*)n, " " ,En                                                                                                                                                                       
          END IF                                                                                                                                                                                         
                                                                                                                                                                                                         
      end do                                                                                                                                                                                             
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
      do n = 6, 7                                                                                                                                                                                        
         IF (H_Fit(n-5) > 0) THEN                                                                                                                                                                        
             if(n==6)Then                                                                                                                                                                                
                 Call HyperPolarizability_6_Sph2(cal_coord_temp,Ar,Br,C , A_Mult,B_Mult ,A_HPol,B_HPol,EH)                                                                                               
             elseif(n==7)Then                                                                                                                                                                            
                 Call HyperPolarizability_7_Sph2(cal_coord_temp,Ar,Br,C , A_Mult,B_Mult ,A_HPol,B_HPol,EH)                                                                                               
             endif                                                                                                                                                                                       
             term = (C1*C2**n)*EH                                                                                                                                                                        
             testErr(42 + n-5) = Const*term                                                                                                                                                              
             Hyper_energy(n-4) = term                                                                                                                                                                    
             Hyper_energy(1) = Hyper_energy(1)+term                                                                                                                                                      
             Ene = Ene+term                                                                                                                                                                              
             !Ene = Ene + (C1*C2**n)*EH                                                                                                                                                                  
             !write(*,*)n, " " ,En                                                                                                                                                                       
          END IF                                                                                                                                                                                         
                                                                                                                                                                                                         
      end do                                                                                                                                                                                             
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     TotalEnergy  = Const*Ene                                                                                                                                                                            
     if (doTesting>0)Then                                                                                                                                                                                
         testErr(1) = TotalEnergy                                                                                                                                                                        
         testErr(2) = Const*Elect_energy(1)                                                                                                                                                              
         testErr(3) = Const*Dispe_energy(1)                                                                                                                                                              
         testErr(4) = Const*Induc_energy(1)                                                                                                                                                              
         testErr(5) = Const*Hyper_energy(1)                                                                                                                                                              
     end if                                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 end SUBROUTINE TotalEnergy_Calc                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE Prep_Param(Coeff_Address, coeff_arr,M_Fit ,D_Fit,I_Fit,H_Fit,Zero)                                                                                                                           
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     !   NEED TO DECLARE ALL THE SUBROUTINE ARGUMENTS and                                                                                                                                                
     !   ANY OTHER VARIABLES LOCAL TO THE SUBROUTINE                                                                                                                                                     
                                                                                                                                                                                                         
     !Multipoles !                                                                                                                                                                                       
                                                                                                                                                                                                         
     real*8 , dimension(1)   :: qA,qB !q                                                                                                                                                                 
     real*8 , dimension(3)   :: mA,mB !m                                                                                                                                                                 
     real*8 , dimension(5)   :: QdA,QdB !Qd                                                                                                                                                              
     real*8 , dimension(7)   :: OA,OB !O                                                                                                                                                                 
     real*8 , dimension(9)   :: PhiA,PhiB !Phi                                                                                                                                                           
     real*8 , dimension(11)   :: M5A,M5B !M5                                                                                                                                                             
     real*8 , dimension(13)   :: M6A,M6B !M6                                                                                                                                                             
     real*8 , dimension(15)   :: M7A,M7B !M7                                                                                                                                                             
                                                                                                                                                                                                         
     real*8 , dimension(64)   :: A_Mult,B_Mult                                                                                                                                                           
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     !Polarizability!                                                                                                                                                                                    
                                                                                                                                                                                                         
     real*8 , dimension(6)   :: mmA,mmB                                                                                                                                                                  
     real*8 , dimension(15)  :: mQdA,mQdB                                                                                                                                                                
     real*8 , dimension(15)  :: QdQdA,QdQdB                                                                                                                                                              
     real*8 , dimension(21)  :: mOA,mOB                                                                                                                                                                  
                                                                                                                                                                                                         
     real*8 , dimension(57)   :: A_Pol,B_Pol                                                                                                                                                             
                                                                                                                                                                                                         
     !Hyperpolarizability!                                                                                                                                                                               
                                                                                                                                                                                                         
     real*8 , dimension(10)   :: mmmA,mmmB                                                                                                                                                               
     real*8 , dimension(30)  :: mmQdA,mmQdB                                                                                                                                                              
                                                                                                                                                                                                         
     real*8 , dimension(40)   :: A_HPol,B_HPol                                                                                                                                                           
                                                                                                                                                                                                         
     !Dispersion!                                                                                                                                                                                        
                                                                                                                                                                                                         
     real*8 , dimension(36)   :: mm_mm                                                                                                                                                                   
     real*8 , dimension(90)  ::  mm_mQd,mQd_mm,mm_QdQd,QdQd_mm                                                                                                                                           
     real*8 , dimension(126)   :: mO_mm,mm_mO                                                                                                                                                            
     real*8 , dimension(225)   :: mQd_mQd                                                                                                                                                                
                                                                                                                                                                                                         
     real*8 , dimension(873)   :: Disp                                                                                                                                                                   
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     real*8 , dimension(1195), INTENT(INOUT) :: coeff_arr                                                                                                                                                
                                                                                                                                                                                                         
     Character(len = *), INTENT(IN)   ::  Coeff_Address                                                                                                                                                  
                                                                                                                                                                                                         
     Integer, dimension (8),  INTENT(INOUT) :: M_Fit                                                                                                                                                     
     Integer, dimension (3),  INTENT(INOUT) :: D_Fit                                                                                                                                                     
     Integer, dimension (5),  INTENT(INOUT) :: I_Fit                                                                                                                                                     
     Integer, dimension (2),  INTENT(INOUT) :: H_Fit                                                                                                                                                     
                                                                                                                                                                                                         
     Real*8 , INTENT(out) :: Zero                                                                                                                                                                        
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     Character(len = 20) :: row                                                                                                                                                                          
     ! Integer , dimension(7) :: DataColumn ! R , Cos_b1 , Cos_b2 , alpha ,  Cos_c1 , Cos_c2 , Energy                                                                                                    
                                                                                                                                                                                                         
     !write(*,*) 'Reading file'                                                                                                                                                                          
                                                                                                                                                                                                         
     Open( 10, file = Coeff_Address )                                                                                                                                                                    
                                                                                                                                                                                                         
     Read( 10, *) row                                                                                                                                                                                    
     Read( 10, *) row                                                                                                                                                                                    
     Read( 10, *) row                                                                                                                                                                                    
     Read( 10, *) row                                                                                                                                                                                    
     Read( 10, *) row                                                                                                                                                                                    
     Read( 10, *) row                                                                                                                                                                                    
     Read( 10, *) row                                                                                                                                                                                    
                                                                                                                                                                                                         
     read(10, *)  M_Fit                                                                                                                                                                                  
     read(10, *)  D_Fit                                                                                                                                                                                  
     read(10, *)  I_Fit                                                                                                                                                                                  
     read(10, *)  H_Fit                                                                                                                                                                                  
                                                                                                                                                                                                         
     Read( 10, *) row                                                                                                                                                                                    
     read(10, *) Zero                                                                                                                                                                                    
                                                                                                                                                                                                         
     Read( 10, *) row                                                                                                                                                                                    
     read(10, *) qA                                                                                                                                                                                      
     read(10, *) mA                                                                                                                                                                                      
     read(10, *) QdA                                                                                                                                                                                     
     read(10, *) OA                                                                                                                                                                                      
     read(10, *) PhiA                                                                                                                                                                                    
     read(10, *) M5A                                                                                                                                                                                     
     read(10, *) M6A                                                                                                                                                                                     
     read(10, *) M7A                                                                                                                                                                                     
                                                                                                                                                                                                         
     Read( 10, *) row                                                                                                                                                                                    
     read(10, *) qB                                                                                                                                                                                      
     read(10, *) mB                                                                                                                                                                                      
     read(10, *) QdB                                                                                                                                                                                     
     read(10, *) OB                                                                                                                                                                                      
     read(10, *) PhiB                                                                                                                                                                                    
     read(10, *) M5B                                                                                                                                                                                     
     read(10, *) M6B                                                                                                                                                                                     
     read(10, *) M7B                                                                                                                                                                                     
                                                                                                                                                                                                         
     Read( 10, *) row                                                                                                                                                                                    
     read(10, *) mmA                                                                                                                                                                                     
     read(10, *) mQdA                                                                                                                                                                                    
     read(10, *) QdQdA                                                                                                                                                                                   
     read(10, *) mOA                                                                                                                                                                                     
                                                                                                                                                                                                         
     Read( 10, *) row                                                                                                                                                                                    
     read(10, *) mmB                                                                                                                                                                                     
     read(10, *) mQdB                                                                                                                                                                                    
     read(10, *) QdQdB                                                                                                                                                                                   
     read(10, *) mOB                                                                                                                                                                                     
                                                                                                                                                                                                         
     Read( 10, *) row                                                                                                                                                                                    
     read(10, *) mmmA                                                                                                                                                                                    
     read(10, *) mmQdA                                                                                                                                                                                   
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     Read( 10, *) row                                                                                                                                                                                    
     read(10, *) mmmB                                                                                                                                                                                    
     read(10, *) mmQdB                                                                                                                                                                                   
                                                                                                                                                                                                         
     Read( 10, *) row                                                                                                                                                                                    
     read(10, *) mm_mm                                                                                                                                                                                   
     read(10, *) mQd_mm                                                                                                                                                                                  
     read(10, *) mm_mQd                                                                                                                                                                                  
     read(10, *) mO_mm                                                                                                                                                                                   
     read(10, *) mm_mO                                                                                                                                                                                   
     read(10, *) QdQd_mm                                                                                                                                                                                 
     read(10, *) mm_QdQd                                                                                                                                                                                 
     read(10, *) mQd_mQd                                                                                                                                                                                 
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     close(10)                                                                                                                                                                                           
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     A_Mult(1:1) = qA                                                                                                                                                                                    
     A_Mult(2:4) = mA                                                                                                                                                                                    
     A_Mult(5:9) = QdA                                                                                                                                                                                   
     A_Mult(10:16) = OA                                                                                                                                                                                  
     A_Mult(17:25) = PhiA                                                                                                                                                                                
     A_Mult(26:36) = M5A                                                                                                                                                                                 
     A_Mult(37:49) = M6A                                                                                                                                                                                 
     A_Mult(50:64) = M7A                                                                                                                                                                                 
                                                                                                                                                                                                         
     B_Mult(1:1) = qB                                                                                                                                                                                    
     B_Mult(2:4) = mB                                                                                                                                                                                    
     B_Mult(5:9) = QdB                                                                                                                                                                                   
     B_Mult(10:16) = OB                                                                                                                                                                                  
     B_Mult(17:25) = PhiB                                                                                                                                                                                
     B_Mult(26:36) = M5B                                                                                                                                                                                 
     B_Mult(37:49) = M6B                                                                                                                                                                                 
     B_Mult(50:64) = M7B                                                                                                                                                                                 
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     A_Pol(1:6) = mmA                                                                                                                                                                                    
     A_Pol(7:21) = mQdA                                                                                                                                                                                  
     A_Pol(22:36) = QdQdA                                                                                                                                                                                
     A_Pol(37:57) = mOA                                                                                                                                                                                  
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     B_Pol(1:6) = mmB                                                                                                                                                                                    
     B_Pol(7:21) = mQdB                                                                                                                                                                                  
     B_Pol(22:36) = QdQdB                                                                                                                                                                                
     B_Pol(37:57) = mOB                                                                                                                                                                                  
                                                                                                                                                                                                         
     A_HPol(1:10) = mmmA                                                                                                                                                                                 
     A_HPol(11:40) = mmQdA                                                                                                                                                                               
                                                                                                                                                                                                         
     B_HPol(1:10) = mmmB                                                                                                                                                                                 
     B_HPol(11:40) = mmQdB                                                                                                                                                                               
                                                                                                                                                                                                         
     Disp(1:36) = mm_mm                                                                                                                                                                                  
     Disp(37:126) = mQd_mm                                                                                                                                                                               
     Disp(127:216) = mm_mQd                                                                                                                                                                              
     Disp(217:342) = mO_mm                                                                                                                                                                               
     Disp(343:468) = mm_mO                                                                                                                                                                               
     Disp(469:558) = QdQd_mm                                                                                                                                                                             
     Disp(559:648) = mm_QdQd                                                                                                                                                                             
     Disp(649:873) = mQd_mQd                                                                                                                                                                             
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     coeff_arr(1:64)   = A_Mult                                                                                                                                                                          
     coeff_arr(65:128) = B_Mult                                                                                                                                                                          
                                                                                                                                                                                                         
     coeff_arr(129:185)   = A_Pol                                                                                                                                                                        
     coeff_arr(186:242)   = B_Pol                                                                                                                                                                        
                                                                                                                                                                                                         
     coeff_arr(243:282)   = A_HPol                                                                                                                                                                       
     coeff_arr(283:322)   = B_HPol                                                                                                                                                                       
                                                                                                                                                                                                         
     coeff_arr(323:1195)   = Disp                                                                                                                                                                        
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE Prep_Param                                                                                                                                                                               
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 !********************************************************                                                                                                                                               
 SUBROUTINE Approx_1_Sph2(cal_coord,Ar,Br,C ,A_Multipoles,B_Multipoles , Approx_1_Energy)                                                                                                                
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     !   NEED TO DECLARE ALL THE SUBROUTINE ARGUMENTS and                                                                                                                                                
     !   ANY OTHER VARIABLES LOCAL TO THE SUBROUTINE                                                                                                                                                     
                                                                                                                                                                                                         
     real*8, INTENT(INOUT)  :: Approx_1_Energy                                                                                                                                                           
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 :: qA,qB                                                                                                                                                                                     
     real*8 :: R                                                                                                                                                                                         
     real*8 , dimension(11), INTENT(IN):: cal_coord                                                                                                                                                      
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
                                                                                                                                                                                                         
     R =cal_coord(1);                                                                                                                                                                                    
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     qA=A_Multipoles(1)                                                                                                                                                                                  
     qB=B_Multipoles(1)                                                                                                                                                                                  
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     Approx_1_Energy =   qA*qB / R                                                                                                                                                                       
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE Approx_1_Sph2                                                                                                                                                                            
 !********************************************************                                                                                                                                               
                                                                                                                                                                                                         
 !********************************************************                                                                                                                                               
 SUBROUTINE Approx_2_Sph2(cal_coord,Ar,Br,C ,A_Multipoles,B_Multipoles , Approx_2_Energy)                                                                                                                
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     !   NEED TO DECLARE ALL THE SUBROUTINE ARGUMENTS and                                                                                                                                                
     !   ANY OTHER VARIABLES LOCAL TO THE SUBROUTINE                                                                                                                                                     
                                                                                                                                                                                                         
     real*8, INTENT(INOUT)  :: Approx_2_Energy                                                                                                                                                           
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 :: R                                                                                                                                                                                         
     real*8 , dimension(11), INTENT(IN):: cal_coord                                                                                                                                                      
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     real*8 :: Q10_0,Q10_1                                                                                                                                                                               
                                                                                                                                                                                                         
     R =cal_coord(1);                                                                                                                                                                                    
                                                                                                                                                                                                         
     Call Q10(Ar,Br,C ,A_Multipoles,B_Multipoles,0,Q10_0)                                                                                                                                                
     Call Q10(Ar,Br,C ,A_Multipoles,B_Multipoles,1,Q10_1)                                                                                                                                                
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     Approx_2_Energy =   (Q10_0 + Q10_1)/ R**2                                                                                                                                                           
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE Approx_2_Sph2                                                                                                                                                                            
 !********************************************************                                                                                                                                               
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE Q10(Ar,Br,C ,A_Multipoles,B_Multipoles, ind , result)                                                                                                                                        
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     real*8, INTENT(INOUT) ::result                                                                                                                                                                      
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     Integer, INTENT(IN):: ind                                                                                                                                                                           
     real*8 :: q                                                                                                                                                                                         
     real*8 , dimension(3):: m                                                                                                                                                                           
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     if (ind==0) then                                                                                                                                                                                    
     q =  B_Multipoles(1)                                                                                                                                                                                
     m  = A_Multipoles(2:4)                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     else                                                                                                                                                                                                
         q =  A_Multipoles(1)                                                                                                                                                                            
         m  = B_Multipoles(2:4)                                                                                                                                                                          
     end if                                                                                                                                                                                              
                                                                                                                                                                                                         
     Call T_l0(Ar,Br,C,q,m,ind,1 , result)                                                                                                                                                               
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE Q10                                                                                                                                                                                      
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 !********************************************************                                                                                                                                               
 SUBROUTINE Approx_3_Sph2(cal_coord,Ar,Br,C ,A_Multipoles,B_Multipoles , Approx_3_Energy)                                                                                                                
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     !   NEED TO DECLARE ALL THE SUBROUTINE ARGUMENTS and                                                                                                                                                
     !   ANY OTHER VARIABLES LOCAL TO THE SUBROUTINE                                                                                                                                                     
                                                                                                                                                                                                         
     real*8, INTENT(INOUT)  :: Approx_3_Energy                                                                                                                                                           
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 :: R                                                                                                                                                                                         
     real*8 , dimension(11), INTENT(IN):: cal_coord                                                                                                                                                      
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     real*8 :: Q20_0,Q20_1,Q11_0                                                                                                                                                                         
                                                                                                                                                                                                         
     R =cal_coord(1);                                                                                                                                                                                    
                                                                                                                                                                                                         
     Call Q20(Ar,Br,C ,A_Multipoles,B_Multipoles,0,Q20_0)                                                                                                                                                
     Call Q20(Ar,Br,C ,A_Multipoles,B_Multipoles,1,Q20_1)                                                                                                                                                
                                                                                                                                                                                                         
     Call Q11(Ar,Br,C ,A_Multipoles,B_Multipoles,0,Q11_0)                                                                                                                                                
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     Approx_3_Energy =   (Q20_0 + Q20_1 + Q11_0)/ R**3                                                                                                                                                   
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE Approx_3_Sph2                                                                                                                                                                            
 !********************************************************                                                                                                                                               
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE Q20(Ar,Br,C ,A_Multipoles,B_Multipoles, ind , result)                                                                                                                                        
         IMPLICIT NONE                                                                                                                                                                                   
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         real*8, INTENT(INOUT) ::result                                                                                                                                                                  
         real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                
         real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                          
         real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                          
         real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                           
         Integer, INTENT(IN):: ind                                                                                                                                                                       
         real*8 :: q                                                                                                                                                                                     
         real*8 , dimension(5):: Qd                                                                                                                                                                      
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         if (ind==0) then                                                                                                                                                                                
         q =  B_Multipoles(1)                                                                                                                                                                            
         Qd  = A_Multipoles(5:9)                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         else                                                                                                                                                                                            
             q =  A_Multipoles(1)                                                                                                                                                                        
             Qd  = B_Multipoles(5:9)                                                                                                                                                                     
         end if                                                                                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         Call T_l0(Ar,Br,C,q,Qd,ind,2, result)                                                                                                                                                           
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         RETURN                                                                                                                                                                                          
 END SUBROUTINE Q20                                                                                                                                                                                      
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE Q11(Ar,Br,C ,A_Multipoles,B_Multipoles, ind , result)                                                                                                                                        
             IMPLICIT NONE                                                                                                                                                                               
                                                                                                                                                                                                         
                                                                                                                                                                                                         
             real*8, INTENT(INOUT) ::result                                                                                                                                                              
             real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                            
             real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                      
             real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                      
             real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                       
             Integer, INTENT(IN):: ind                                                                                                                                                                   
             real*8 , dimension(3):: mA,mB                                                                                                                                                               
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
             mA =  A_Multipoles(2:4)                                                                                                                                                                     
             mB  = B_Multipoles(2:4)                                                                                                                                                                     
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
             Call T_ll(Ar,Br,C,mA,mB,1,1 , result)                                                                                                                                                       
                                                                                                                                                                                                         
             RETURN                                                                                                                                                                                      
 END SUBROUTINE Q11                                                                                                                                                                                      
                                                                                                                                                                                                         
 !********************************************************                                                                                                                                               
 SUBROUTINE Approx_4_Sph2(cal_coord,Ar,Br,C ,A_Multipoles,B_Multipoles , Approx_4_Energy)                                                                                                                
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     !   NEED TO DECLARE ALL THE SUBROUTINE ARGUMENTS and                                                                                                                                                
     !   ANY OTHER VARIABLES LOCAL TO THE SUBROUTINE                                                                                                                                                     
                                                                                                                                                                                                         
     real*8, INTENT(INOUT)  :: Approx_4_Energy                                                                                                                                                           
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 :: R                                                                                                                                                                                         
     real*8 , dimension(11), INTENT(IN):: cal_coord                                                                                                                                                      
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     real*8 :: Q21_0,Q21_1,Q30_0,Q30_1                                                                                                                                                                   
                                                                                                                                                                                                         
     R =cal_coord(1);                                                                                                                                                                                    
                                                                                                                                                                                                         
     Call Q21(Ar,Br,C ,A_Multipoles,B_Multipoles,0,Q21_0)                                                                                                                                                
     Call Q21(Ar,Br,C ,A_Multipoles,B_Multipoles,1,Q21_1)                                                                                                                                                
                                                                                                                                                                                                         
     Call Q30(Ar,Br,C ,A_Multipoles,B_Multipoles,0,Q30_0)                                                                                                                                                
     Call Q30(Ar,Br,C ,A_Multipoles,B_Multipoles,1,Q30_1)                                                                                                                                                
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     Approx_4_Energy =   (Q21_0 + Q21_1 +Q30_0+Q30_1)/ R**4                                                                                                                                              
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE Approx_4_Sph2                                                                                                                                                                            
 !********************************************************                                                                                                                                               
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE Q21(Ar,Br,C ,A_Multipoles,B_Multipoles, ind , result)                                                                                                                                        
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     real*8, INTENT(INOUT) ::result                                                                                                                                                                      
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     Integer, INTENT(IN):: ind                                                                                                                                                                           
                                                                                                                                                                                                         
     real*8 , dimension(3):: m                                                                                                                                                                           
     real*8 , dimension(5):: Qd                                                                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     if (ind==0) then                                                                                                                                                                                    
     m =  B_Multipoles(2:4)                                                                                                                                                                              
     Qd  = A_Multipoles(5:9)                                                                                                                                                                             
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     Call T_ll(Ar,Br,C,Qd,m,2,1 , result)                                                                                                                                                                
                                                                                                                                                                                                         
     else                                                                                                                                                                                                
     m =  A_Multipoles(2:4)                                                                                                                                                                              
     Qd  = B_Multipoles(5:9)                                                                                                                                                                             
                                                                                                                                                                                                         
     Call T_ll(Ar,Br,C,m,Qd,1,2 , result)                                                                                                                                                                
     end if                                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE Q21                                                                                                                                                                                      
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE Q30(Ar,Br,C ,A_Multipoles,B_Multipoles, ind , result)                                                                                                                                        
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     real*8, INTENT(INOUT) ::result                                                                                                                                                                      
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     Integer, INTENT(IN):: ind                                                                                                                                                                           
     real*8 :: q                                                                                                                                                                                         
     real*8 , dimension(7):: O                                                                                                                                                                           
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     if (ind==0) then                                                                                                                                                                                    
     q =  B_Multipoles(1)                                                                                                                                                                                
     O  = A_Multipoles(10:16)                                                                                                                                                                            
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     else                                                                                                                                                                                                
         q =  A_Multipoles(1)                                                                                                                                                                            
         O  = B_Multipoles(10:16)                                                                                                                                                                        
     end if                                                                                                                                                                                              
                                                                                                                                                                                                         
     Call T_l0(Ar,Br,C,q,O,ind,3 , result)                                                                                                                                                               
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE Q30                                                                                                                                                                                      
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     !********************************************************                                                                                                                                           
 SUBROUTINE Approx_5_Sph2(cal_coord,Ar,Br,C ,A_Multipoles,B_Multipoles , Approx_5_Energy)                                                                                                                
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     !   NEED TO DECLARE ALL THE SUBROUTINE ARGUMENTS and                                                                                                                                                
     !   ANY OTHER VARIABLES LOCAL TO THE SUBROUTINE                                                                                                                                                     
                                                                                                                                                                                                         
     real*8, INTENT(INOUT)  :: Approx_5_Energy                                                                                                                                                           
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 :: R                                                                                                                                                                                         
     real*8 , dimension(11), INTENT(IN):: cal_coord                                                                                                                                                      
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     real*8 :: Q31_0,Q31_1,Q40_0,Q40_1,Q22_0                                                                                                                                                             
                                                                                                                                                                                                         
     R =cal_coord(1);                                                                                                                                                                                    
                                                                                                                                                                                                         
     Call Q31(Ar,Br,C ,A_Multipoles,B_Multipoles,0,Q31_0)                                                                                                                                                
     Call Q31(Ar,Br,C ,A_Multipoles,B_Multipoles,1,Q31_1)                                                                                                                                                
                                                                                                                                                                                                         
     Call Q22(Ar,Br,C ,A_Multipoles,B_Multipoles,0,Q22_0)                                                                                                                                                
                                                                                                                                                                                                         
     Call Q40(Ar,Br,C ,A_Multipoles,B_Multipoles,0,Q40_0)                                                                                                                                                
     Call Q40(Ar,Br,C ,A_Multipoles,B_Multipoles,1,Q40_1)                                                                                                                                                
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     Approx_5_Energy =   (Q31_0 + Q31_1+ Q22_0 +Q40_0+Q40_1)/ R**5                                                                                                                                       
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE Approx_5_Sph2                                                                                                                                                                            
     !********************************************************                                                                                                                                           
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE Q31(Ar,Br,C ,A_Multipoles,B_Multipoles, ind , result)                                                                                                                                        
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     real*8, INTENT(INOUT) ::result                                                                                                                                                                      
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     Integer, INTENT(IN):: ind                                                                                                                                                                           
     real*8 , dimension(3):: m                                                                                                                                                                           
     real*8 , dimension(7):: O                                                                                                                                                                           
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     if (ind==0) then                                                                                                                                                                                    
                                                                                                                                                                                                         
         m =  B_Multipoles(2:4)                                                                                                                                                                          
         O  = A_Multipoles(10:16)                                                                                                                                                                        
         call  T_ll(Ar,Br,C,O,m,3,1 , result)                                                                                                                                                            
                                                                                                                                                                                                         
     else                                                                                                                                                                                                
         m =  A_Multipoles(2:4)                                                                                                                                                                          
         O  = B_Multipoles(10:16)                                                                                                                                                                        
                                                                                                                                                                                                         
         call  T_ll(Ar,Br,C,m,O,1,3 , result)                                                                                                                                                            
     end if                                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         RETURN                                                                                                                                                                                          
 END SUBROUTINE Q31                                                                                                                                                                                      
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE Q22(Ar,Br,C ,A_Multipoles,B_Multipoles, ind , result)                                                                                                                                        
         IMPLICIT NONE                                                                                                                                                                                   
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         real*8, INTENT(INOUT) ::result                                                                                                                                                                  
         real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                
         real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                          
         real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                          
         real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                           
         Integer, INTENT(IN):: ind                                                                                                                                                                       
                                                                                                                                                                                                         
         real*8 , dimension(5):: QdA,QdB                                                                                                                                                                 
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         QdB =  B_Multipoles(5:9)                                                                                                                                                                        
         QdA  = A_Multipoles(5:9)                                                                                                                                                                        
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         call  T_ll(Ar,Br,C,QdA,QdB,2,2 , result)                                                                                                                                                        
                                                                                                                                                                                                         
         RETURN                                                                                                                                                                                          
 END SUBROUTINE Q22                                                                                                                                                                                      
                                                                                                                                                                                                         
 SUBROUTINE Q40(Ar,Br,C ,A_Multipoles,B_Multipoles, ind , result)                                                                                                                                        
         IMPLICIT NONE                                                                                                                                                                                   
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         real*8, INTENT(INOUT) ::result                                                                                                                                                                  
         real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                
         real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                          
         real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                          
         real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                           
         Integer, INTENT(IN):: ind                                                                                                                                                                       
         real*8 :: q                                                                                                                                                                                     
         real*8 , dimension(9):: Phi                                                                                                                                                                     
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         if (ind==0) then                                                                                                                                                                                
         q =  B_Multipoles(1)                                                                                                                                                                            
         Phi  = A_Multipoles(17:25)                                                                                                                                                                      
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         else                                                                                                                                                                                            
             q =  A_Multipoles(1)                                                                                                                                                                        
             Phi  = B_Multipoles(17:25)                                                                                                                                                                  
         end if                                                                                                                                                                                          
                                                                                                                                                                                                         
         Call T_l0(Ar,Br,C,q,Phi,ind,4 , result)                                                                                                                                                         
                                                                                                                                                                                                         
         RETURN                                                                                                                                                                                          
 END SUBROUTINE Q40                                                                                                                                                                                      
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     !********************************************************                                                                                                                                           
 SUBROUTINE Approx_6_Sph2(cal_coord,Ar,Br,C ,A_Multipoles,B_Multipoles , Approx_6_Energy)                                                                                                                
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     !   NEED TO DECLARE ALL THE SUBROUTINE ARGUMENTS and                                                                                                                                                
     !   ANY OTHER VARIABLES LOCAL TO THE SUBROUTINE                                                                                                                                                     
                                                                                                                                                                                                         
     real*8, INTENT(INOUT)  :: Approx_6_Energy                                                                                                                                                           
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 :: R                                                                                                                                                                                         
     real*8 , dimension(11), INTENT(IN):: cal_coord                                                                                                                                                      
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     real*8 :: Q41_0,Q41_1,Q50_0,Q50_1,Q32_0,Q32_1                                                                                                                                                       
                                                                                                                                                                                                         
     R =cal_coord(1);                                                                                                                                                                                    
                                                                                                                                                                                                         
     Call Q41(Ar,Br,C ,A_Multipoles,B_Multipoles,0,Q41_0)                                                                                                                                                
     Call Q41(Ar,Br,C ,A_Multipoles,B_Multipoles,1,Q41_1)                                                                                                                                                
                                                                                                                                                                                                         
     Call Q32(Ar,Br,C ,A_Multipoles,B_Multipoles,0,Q32_0)                                                                                                                                                
     Call Q32(Ar,Br,C ,A_Multipoles,B_Multipoles,1,Q32_1)                                                                                                                                                
                                                                                                                                                                                                         
     Call Q50(Ar,Br,C ,A_Multipoles,B_Multipoles,0,Q50_0)                                                                                                                                                
     Call Q50(Ar,Br,C ,A_Multipoles,B_Multipoles,1,Q50_1)                                                                                                                                                
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     Approx_6_Energy =   (Q41_0 + Q41_1 + Q50_0 + Q50_1 + Q32_0 + Q32_1)/ R**6                                                                                                                           
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE Approx_6_Sph2                                                                                                                                                                            
     !********************************************************                                                                                                                                           
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE Q41(Ar,Br,C ,A_Multipoles,B_Multipoles, ind , result)                                                                                                                                        
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     real*8, INTENT(INOUT) ::result                                                                                                                                                                      
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     Integer, INTENT(IN):: ind                                                                                                                                                                           
                                                                                                                                                                                                         
     real*8 , dimension(3):: m                                                                                                                                                                           
     real*8 , dimension(9):: Phi                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     if (ind==0) then                                                                                                                                                                                    
         m =  B_Multipoles(2:4)                                                                                                                                                                          
         Phi  = A_Multipoles(17:25)                                                                                                                                                                      
                                                                                                                                                                                                         
         call  T_ll(Ar,Br,C,Phi,m,4,1 , result)                                                                                                                                                          
                                                                                                                                                                                                         
     else                                                                                                                                                                                                
         m =  A_Multipoles(2:4)                                                                                                                                                                          
         Phi  = B_Multipoles(17:25)                                                                                                                                                                      
                                                                                                                                                                                                         
         call  T_ll(Ar,Br,C,m,Phi,1,4 , result)                                                                                                                                                          
     end if                                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE Q41                                                                                                                                                                                      
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE Q32(Ar,Br,C ,A_Multipoles,B_Multipoles, ind , result)                                                                                                                                        
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     real*8, INTENT(INOUT) ::result                                                                                                                                                                      
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     Integer, INTENT(IN):: ind                                                                                                                                                                           
                                                                                                                                                                                                         
     real*8 , dimension(5):: Qd                                                                                                                                                                          
     real*8 , dimension(7):: O                                                                                                                                                                           
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     if (ind==0) then                                                                                                                                                                                    
         Qd =  B_Multipoles(5:9)                                                                                                                                                                         
         O  = A_Multipoles(10:16)                                                                                                                                                                        
                                                                                                                                                                                                         
         call  T_ll(Ar,Br,C,O,Qd,3,2 , result)                                                                                                                                                           
                                                                                                                                                                                                         
         else                                                                                                                                                                                            
             Qd =  A_Multipoles(5:9)                                                                                                                                                                     
             O  = B_Multipoles(10:16)                                                                                                                                                                    
                                                                                                                                                                                                         
             call  T_ll(Ar,Br,C,Qd,O,2,3 , result)                                                                                                                                                       
         end if                                                                                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE Q32                                                                                                                                                                                      
                                                                                                                                                                                                         
 SUBROUTINE Q50(Ar,Br,C ,A_Multipoles,B_Multipoles, ind , result)                                                                                                                                        
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     real*8, INTENT(INOUT) ::result                                                                                                                                                                      
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     Integer, INTENT(IN):: ind                                                                                                                                                                           
     real*8 :: q                                                                                                                                                                                         
     real*8 , dimension(11):: M5                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     if (ind==0) then                                                                                                                                                                                    
     q =  B_Multipoles(1)                                                                                                                                                                                
     M5  = A_Multipoles(26:36)                                                                                                                                                                           
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     else                                                                                                                                                                                                
         q =  A_Multipoles(1)                                                                                                                                                                            
         M5  = B_Multipoles(26:36)                                                                                                                                                                       
     end if                                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     Call T_l0(Ar,Br,C,q,M5,ind,5 , result)                                                                                                                                                              
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE Q50                                                                                                                                                                                      
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     !********************************************************                                                                                                                                           
 SUBROUTINE Approx_7_Sph2(cal_coord,Ar,Br,C ,A_Multipoles,B_Multipoles , Approx_7_Energy)                                                                                                                
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     !   NEED TO DECLARE ALL THE SUBROUTINE ARGUMENTS and                                                                                                                                                
     !   ANY OTHER VARIABLES LOCAL TO THE SUBROUTINE                                                                                                                                                     
                                                                                                                                                                                                         
     real*8, INTENT(INOUT)  :: Approx_7_Energy                                                                                                                                                           
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 :: R                                                                                                                                                                                         
     real*8 , dimension(11), INTENT(IN):: cal_coord                                                                                                                                                      
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     real*8 :: Q51_0,Q51_1,Q60_0,Q60_1,Q42_0,Q42_1,Q33_0                                                                                                                                                 
                                                                                                                                                                                                         
     R =cal_coord(1);                                                                                                                                                                                    
                                                                                                                                                                                                         
     Call Q33(Ar,Br,C ,A_Multipoles,B_Multipoles,0,Q33_0)                                                                                                                                                
                                                                                                                                                                                                         
     Call Q51(Ar,Br,C ,A_Multipoles,B_Multipoles,0,Q51_0)                                                                                                                                                
     Call Q51(Ar,Br,C ,A_Multipoles,B_Multipoles,1,Q51_1)                                                                                                                                                
                                                                                                                                                                                                         
     Call Q42(Ar,Br,C ,A_Multipoles,B_Multipoles,0,Q42_0)                                                                                                                                                
     Call Q42(Ar,Br,C ,A_Multipoles,B_Multipoles,1,Q42_1)                                                                                                                                                
                                                                                                                                                                                                         
     Call Q60(Ar,Br,C ,A_Multipoles,B_Multipoles,0,Q60_0)                                                                                                                                                
     Call Q60(Ar,Br,C ,A_Multipoles,B_Multipoles,1,Q60_1)                                                                                                                                                
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     Approx_7_Energy =   (Q60_0+Q60_1+Q51_0+Q51_1+Q42_0+Q42_1+ Q33_0)/ R**7                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE Approx_7_Sph2                                                                                                                                                                            
     !********************************************************                                                                                                                                           
                                                                                                                                                                                                         
 SUBROUTINE Q33(Ar,Br,C ,A_Multipoles,B_Multipoles, ind , result)                                                                                                                                        
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     real*8, INTENT(INOUT) ::result                                                                                                                                                                      
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     Integer, INTENT(IN):: ind                                                                                                                                                                           
                                                                                                                                                                                                         
     real*8 , dimension(7):: OA                                                                                                                                                                          
     real*8 , dimension(7):: OB                                                                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     OB =  B_Multipoles(10:16)                                                                                                                                                                           
     OA  = A_Multipoles(10:16)                                                                                                                                                                           
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     call  T_ll(Ar,Br,C,OA,OB,3,3 , result)                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE Q33                                                                                                                                                                                      
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE Q51(Ar,Br,C ,A_Multipoles,B_Multipoles, ind , result)                                                                                                                                        
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     real*8, INTENT(INOUT) ::result                                                                                                                                                                      
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     Integer, INTENT(IN):: ind                                                                                                                                                                           
                                                                                                                                                                                                         
     real*8 , dimension(3):: m                                                                                                                                                                           
     real*8 , dimension(11):: M5                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     if (ind==0) then                                                                                                                                                                                    
     m =  B_Multipoles(2:4)                                                                                                                                                                              
     M5  = A_Multipoles(26:36)                                                                                                                                                                           
                                                                                                                                                                                                         
     call  T_ll(Ar,Br,C,M5,m,5,1 , result)                                                                                                                                                               
                                                                                                                                                                                                         
     else                                                                                                                                                                                                
         m =  A_Multipoles(2:4)                                                                                                                                                                          
         M5  = B_Multipoles(26:36)                                                                                                                                                                       
                                                                                                                                                                                                         
         call  T_ll(Ar,Br,C,m,M5,1,5 , result)                                                                                                                                                           
     end if                                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE Q51                                                                                                                                                                                      
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE Q42(Ar,Br,C ,A_Multipoles,B_Multipoles, ind , result)                                                                                                                                        
         IMPLICIT NONE                                                                                                                                                                                   
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         real*8, INTENT(INOUT) ::result                                                                                                                                                                  
         real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                
         real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                          
         real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                          
         real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                           
         Integer, INTENT(IN):: ind                                                                                                                                                                       
                                                                                                                                                                                                         
         real*8 , dimension(5):: Qd                                                                                                                                                                      
         real*8 , dimension(9):: Phi                                                                                                                                                                     
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         if (ind==0) then                                                                                                                                                                                
                 Qd =  B_Multipoles(5:9)                                                                                                                                                                 
                 Phi  = A_Multipoles(17:25)                                                                                                                                                              
                                                                                                                                                                                                         
                 call  T_ll(Ar,Br,C,Phi,Qd,4,2 , result)                                                                                                                                                 
                                                                                                                                                                                                         
             else                                                                                                                                                                                        
                 Qd =  A_Multipoles(5:9)                                                                                                                                                                 
                 Phi  = B_Multipoles(17:25)                                                                                                                                                              
                                                                                                                                                                                                         
                 call  T_ll(Ar,Br,C,Qd,Phi,2,4 , result)                                                                                                                                                 
             end if                                                                                                                                                                                      
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         RETURN                                                                                                                                                                                          
 END SUBROUTINE Q42                                                                                                                                                                                      
                                                                                                                                                                                                         
 SUBROUTINE Q60(Ar,Br,C ,A_Multipoles,B_Multipoles, ind , result)                                                                                                                                        
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     real*8, INTENT(INOUT) ::result                                                                                                                                                                      
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     Integer, INTENT(IN):: ind                                                                                                                                                                           
     real*8 :: q                                                                                                                                                                                         
     real*8 , dimension(13):: M6                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     if (ind==0) then                                                                                                                                                                                    
     q =  B_Multipoles(1)                                                                                                                                                                                
     M6  = A_Multipoles(37:49)                                                                                                                                                                           
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     else                                                                                                                                                                                                
         q =  A_Multipoles(1)                                                                                                                                                                            
         M6  = B_Multipoles(37:49)                                                                                                                                                                       
     end if                                                                                                                                                                                              
                                                                                                                                                                                                         
     Call T_l0(Ar,Br,C,q,M6,ind,6 , result)                                                                                                                                                              
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE Q60                                                                                                                                                                                      
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     !********************************************************                                                                                                                                           
 SUBROUTINE Approx_8_Sph2(cal_coord,Ar,Br,C ,A_Multipoles,B_Multipoles , Approx_8_Energy)                                                                                                                
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     !   NEED TO DECLARE ALL THE SUBROUTINE ARGUMENTS and                                                                                                                                                
     !   ANY OTHER VARIABLES LOCAL TO THE SUBROUTINE                                                                                                                                                     
                                                                                                                                                                                                         
     real*8, INTENT(INOUT)  :: Approx_8_Energy                                                                                                                                                           
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 :: R                                                                                                                                                                                         
     real*8 , dimension(11), INTENT(IN):: cal_coord                                                                                                                                                      
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     real*8 :: Q61_0,Q61_1,Q70_0,Q70_1,Q52_0,Q52_1,Q43_0,Q43_1                                                                                                                                           
                                                                                                                                                                                                         
     R =cal_coord(1);                                                                                                                                                                                    
                                                                                                                                                                                                         
     Call Q43(Ar,Br,C ,A_Multipoles,B_Multipoles,0,Q43_0)                                                                                                                                                
     Call Q43(Ar,Br,C ,A_Multipoles,B_Multipoles,1,Q43_1)                                                                                                                                                
                                                                                                                                                                                                         
     Call Q52(Ar,Br,C ,A_Multipoles,B_Multipoles,0,Q61_0)                                                                                                                                                
     Call Q52(Ar,Br,C ,A_Multipoles,B_Multipoles,1,Q61_1)                                                                                                                                                
                                                                                                                                                                                                         
     Call Q70(Ar,Br,C ,A_Multipoles,B_Multipoles,0,Q52_0)                                                                                                                                                
     Call Q70(Ar,Br,C ,A_Multipoles,B_Multipoles,1,Q52_1)                                                                                                                                                
                                                                                                                                                                                                         
     Call Q61(Ar,Br,C ,A_Multipoles,B_Multipoles,0,Q70_0)                                                                                                                                                
     Call Q61(Ar,Br,C ,A_Multipoles,B_Multipoles,1,Q70_1)                                                                                                                                                
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     Approx_8_Energy =   (Q70_0+Q70_1+Q61_0+Q61_1+Q52_0+Q52_1+ Q43_0+Q43_1)/ R**8                                                                                                                        
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE Approx_8_Sph2                                                                                                                                                                            
     !********************************************************                                                                                                                                           
                                                                                                                                                                                                         
 SUBROUTINE Q43(Ar,Br,C ,A_Multipoles,B_Multipoles, ind , result)                                                                                                                                        
         IMPLICIT NONE                                                                                                                                                                                   
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         real*8, INTENT(INOUT) ::result                                                                                                                                                                  
         real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                
         real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                          
         real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                          
         real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                           
         Integer, INTENT(IN):: ind                                                                                                                                                                       
                                                                                                                                                                                                         
         real*8 , dimension(7):: O                                                                                                                                                                       
         real*8 , dimension(9):: Phi                                                                                                                                                                     
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         if (ind==0) then                                                                                                                                                                                
                 O    =  B_Multipoles(10:16)                                                                                                                                                             
                 Phi  =  A_Multipoles(17:25)                                                                                                                                                             
                                                                                                                                                                                                         
                 call  T_ll(Ar,Br,C,Phi,O,4,3 , result)                                                                                                                                                  
                                                                                                                                                                                                         
             else                                                                                                                                                                                        
                 O    =  A_Multipoles(10:16)                                                                                                                                                             
                 Phi  =  B_Multipoles(17:25)                                                                                                                                                             
                                                                                                                                                                                                         
                 call  T_ll(Ar,Br,C,O,Phi,3,4 , result)                                                                                                                                                  
                                                                                                                                                                                                         
             end if                                                                                                                                                                                      
                                                                                                                                                                                                         
         RETURN                                                                                                                                                                                          
 END SUBROUTINE Q43                                                                                                                                                                                      
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE Q61(Ar,Br,C ,A_Multipoles,B_Multipoles, ind , result)                                                                                                                                        
         IMPLICIT NONE                                                                                                                                                                                   
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         real*8, INTENT(INOUT) ::result                                                                                                                                                                  
         real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                
         real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                          
         real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                          
         real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                           
         Integer, INTENT(IN):: ind                                                                                                                                                                       
                                                                                                                                                                                                         
         real*8 , dimension(3):: m                                                                                                                                                                       
         real*8 , dimension(13):: M6                                                                                                                                                                     
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         if (ind==0) then                                                                                                                                                                                
             m =  B_Multipoles(2:4)                                                                                                                                                                      
             M6  = A_Multipoles(37:49)                                                                                                                                                                   
                                                                                                                                                                                                         
             call  T_ll(Ar,Br,C,M6,m,6,1 , result)                                                                                                                                                       
         else                                                                                                                                                                                            
             m =  A_Multipoles(2:4)                                                                                                                                                                      
             M6  = B_Multipoles(37:49)                                                                                                                                                                   
                                                                                                                                                                                                         
             call  T_ll(Ar,Br,C,m,M6,1,6 , result)                                                                                                                                                       
         end if                                                                                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         RETURN                                                                                                                                                                                          
 END SUBROUTINE Q61                                                                                                                                                                                      
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE Q52(Ar,Br,C ,A_Multipoles,B_Multipoles, ind , result)                                                                                                                                        
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     real*8, INTENT(INOUT) ::result                                                                                                                                                                      
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     Integer, INTENT(IN):: ind                                                                                                                                                                           
                                                                                                                                                                                                         
     real*8 , dimension(5):: Qd                                                                                                                                                                          
     real*8 , dimension(11):: M5                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     if (ind==0) then                                                                                                                                                                                    
         Qd =  B_Multipoles(5:9)                                                                                                                                                                         
         M5  = A_Multipoles(26:36)                                                                                                                                                                       
                                                                                                                                                                                                         
         call  T_ll(Ar,Br,C,M5,Qd,5,2 , result)                                                                                                                                                          
     else                                                                                                                                                                                                
         Qd =  A_Multipoles(5:9)                                                                                                                                                                         
         M5  = B_Multipoles(26:36)                                                                                                                                                                       
                                                                                                                                                                                                         
         call  T_ll(Ar,Br,C,Qd,M5,2,5 , result)                                                                                                                                                          
     end if                                                                                                                                                                                              
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE Q52                                                                                                                                                                                      
                                                                                                                                                                                                         
 SUBROUTINE Q70(Ar,Br,C ,A_Multipoles,B_Multipoles, ind , result)                                                                                                                                        
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     real*8, INTENT(INOUT) ::result                                                                                                                                                                      
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     Integer, INTENT(IN):: ind                                                                                                                                                                           
     real*8 :: q                                                                                                                                                                                         
     real*8 , dimension(15):: M7                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     if (ind==0) then                                                                                                                                                                                    
         q =  B_Multipoles(1)                                                                                                                                                                            
         M7  = A_Multipoles(50:64)                                                                                                                                                                       
                                                                                                                                                                                                         
     else                                                                                                                                                                                                
         q =  A_Multipoles(1)                                                                                                                                                                            
         M7  = B_Multipoles(50:64)                                                                                                                                                                       
     end if                                                                                                                                                                                              
                                                                                                                                                                                                         
     Call T_l0(Ar,Br,C,q,M7,ind,7, result)                                                                                                                                                               
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE Q70                                                                                                                                                                                      
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     !********************************************************                                                                                                                                           
 SUBROUTINE Induction_4_Sph2(cal_coord,Ar,Br,C ,A_Multipoles,B_Multipoles ,A_Pol,B_Pol, Ind_4_Energy)                                                                                                    
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     !   NEED TO DECLARE ALL THE SUBROUTINE ARGUMENTS and                                                                                                                                                
     !   ANY OTHER VARIABLES LOCAL TO THE SUBROUTINE                                                                                                                                                     
                                                                                                                                                                                                         
     real*8, INTENT(INOUT)  :: Ind_4_Energy                                                                                                                                                              
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 , dimension(57) , INTENT(IN) :: A_Pol,B_Pol                                                                                                                                                  
     real*8 :: R                                                                                                                                                                                         
     real*8 , dimension(11), INTENT(IN):: cal_coord                                                                                                                                                      
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     real*8 :: qq_mm_0,qq_mm_1                                                                                                                                                                           
                                                                                                                                                                                                         
     R =cal_coord(1)                                                                                                                                                                                     
                                                                                                                                                                                                         
     Call qq_mm(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,0,qq_mm_0)                                                                                                                                
     Call qq_mm(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,1,qq_mm_1)                                                                                                                                
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     Ind_4_Energy =   (-0.5d0)*(qq_mm_0 + qq_mm_1)/ R**4                                                                                                                                                 
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE Induction_4_Sph2                                                                                                                                                                         
     !********************************************************                                                                                                                                           
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE qq_mm(Ar,Br,C ,A_Multipoles,B_Multipoles ,A_Pol,B_Pol, ind , result)                                                                                                                         
         IMPLICIT NONE                                                                                                                                                                                   
                                                                                                                                                                                                         
         INTEGER ::  i,j,k                                                                                                                                                                               
         real*8, INTENT(INOUT) ::result                                                                                                                                                                  
         real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                
         real*8 , dimension(57) , INTENT(IN) :: A_Pol,B_Pol                                                                                                                                              
         real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                          
         real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                          
         real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                           
         Integer, INTENT(IN):: ind                                                                                                                                                                       
         real*8 :: q,r1,r2                                                                                                                                                                               
         real*8 , dimension(6):: alpha                                                                                                                                                                   
         real*8:: eps=EPSILON(result)                                                                                                                                                                    
         Character :: cp1,cp2                                                                                                                                                                            
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         result = 0d0                                                                                                                                                                                    
                                                                                                                                                                                                         
         !Induction_4_Sph2.o Induction_5_Sph2.o Induction_6_Sph2.o Induction_7_Sph2.o Induction_8_Sph2.o Dispersion_6_Sph2.o Dispersion_7_Sph2.o HyperPolarizability_6_Sph2.o HyperPolarizability_7_Sph2.
                                                                                                                                                                                                         
         if (ind==0) then                                                                                                                                                                                
             q =  B_Multipoles(1)                                                                                                                                                                        
             alpha  = A_Pol(1:6)                                                                                                                                                                         
                                                                                                                                                                                                         
             do i = 1,3                                                                                                                                                                                  
                 do j = 1,3                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                     if (DABS(q)>eps)then                                                                                                                                                                
                                                                                                                                                                                                         
                         Call GetIndex_mm(i,j,k)                                                                                                                                                         
                         if(DABS(alpha(k))>eps) Then                                                                                                                                                     
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             call Get_Comp(i,cp1)                                                                                                                                                        
                             call Get_Comp(j,cp2)                                                                                                                                                        
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,1,Floor((i*1d0)/2d0),cp1,0,0,"0",r1)                                                                                                                      
                             Call T_lk(Ar,Br,C,1,Floor((j*1d0)/2d0),cp2,0,0,"0",r2)                                                                                                                      
                                                                                                                                                                                                         
                             result = result + (q**2)*alpha(k)*r1*r2                                                                                                                                     
                                                                                                                                                                                                         
                     end if                                                                                                                                                                              
                     end if                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
                                                                                                                                                                                                         
         else                                                                                                                                                                                            
             q      =  A_Multipoles(1)                                                                                                                                                                   
             alpha  =  B_Pol(1:6)                                                                                                                                                                        
                                                                                                                                                                                                         
             do i = 1,3                                                                                                                                                                                  
                 do j = 1,3                                                                                                                                                                              
                                                                                                                                                                                                         
                     Call GetIndex_mm(i,j,k)                                                                                                                                                             
                                                                                                                                                                                                         
                     if (DABS(q)>eps .and.  DABS(alpha(k))>eps) Then                                                                                                                                     
                                                                                                                                                                                                         
                             ! Call Tmq(Ar,Br,C ,i,ind,t_i)                                                                                                                                              
                             ! Call Tmq(Ar,Br,C ,j,ind,t_j)                                                                                                                                              
                             call Get_Comp(i,cp1)                                                                                                                                                        
                             call Get_Comp(j,cp2)                                                                                                                                                        
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,0,0,"0",1,Floor((i*1d0)/2d0),cp1,r1)                                                                                                                      
                             Call T_lk(Ar,Br,C,0,0,"0",1,Floor((j*1d0)/2d0),cp2,r2)                                                                                                                      
                                                                                                                                                                                                         
                             result = result + (q**2)*alpha(k)*r1*r2                                                                                                                                     
                                                                                                                                                                                                         
                     end if                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end if                                                                                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         RETURN                                                                                                                                                                                          
 END SUBROUTINE qq_mm                                                                                                                                                                                    
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     !********************************************************                                                                                                                                           
 SUBROUTINE Induction_5_Sph2(cal_coord,Ar,Br,C ,A_Multipoles,B_Multipoles ,A_Pol,B_Pol, Ind_5_Energy)                                                                                                    
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     !   NEED TO DECLARE ALL THE SUBROUTINE ARGUMENTS and                                                                                                                                                
     !   ANY OTHER VARIABLES LOCAL TO THE SUBROUTINE                                                                                                                                                     
                                                                                                                                                                                                         
     real*8, INTENT(INOUT)  :: Ind_5_Energy                                                                                                                                                              
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 , dimension(57) , INTENT(IN) :: A_Pol,B_Pol                                                                                                                                                  
     real*8 :: R                                                                                                                                                                                         
     real*8 , dimension(11), INTENT(IN):: cal_coord                                                                                                                                                      
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     real*8 :: qm_mm_0,qm_mm_1,  qq_mQd_0,qq_mQd_1                                                                                                                                                       
                                                                                                                                                                                                         
     R =cal_coord(1)                                                                                                                                                                                     
                                                                                                                                                                                                         
     Call qm_mm(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,0,qm_mm_0)                                                                                                                                
     Call qm_mm(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,1,qm_mm_1)                                                                                                                                
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     Call qq_mQd(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,0,qq_mQd_0)                                                                                                                              
     Call qq_mQd(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,1,qq_mQd_1)                                                                                                                              
                                                                                                                                                                                                         
 !write(*,*)qm_mm_0,qm_mm_1,qq_mQd_0,qq_mQd_1                                                                                                                                                            
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     Ind_5_Energy =   (-0.5d0)*(2.0d0*qm_mm_0 + 2.0d0*qm_mm_1 +2.0d0*qq_mQd_0+ 2.0d0*qq_mQd_1)/ R**5                                                                                                     
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE Induction_5_Sph2                                                                                                                                                                         
     !********************************************************                                                                                                                                           
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE qm_mm(Ar,Br,C ,A_Multipoles,B_Multipoles ,A_Pol,B_Pol, ind , result)                                                                                                                         
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     INTEGER ::  i,j,k,h                                                                                                                                                                                 
     real*8, INTENT(INOUT) ::result                                                                                                                                                                      
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 , dimension(57) , INTENT(IN) :: A_Pol,B_Pol                                                                                                                                                  
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     Integer, INTENT(IN):: ind                                                                                                                                                                           
     real*8 :: q,r1,r2                                                                                                                                                                                   
     real*8 , dimension(3):: m                                                                                                                                                                           
     real*8 , dimension(6):: alpha                                                                                                                                                                       
     real*8:: eps=EPSILON(result)                                                                                                                                                                        
                                                                                                                                                                                                         
     Character :: cp_h,cp_i,cp_j                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     if (ind==0) then                                                                                                                                                                                    
         q =  B_Multipoles(1)                                                                                                                                                                            
         m =  B_Multipoles(2:4)                                                                                                                                                                          
         alpha  = A_Pol(1:6)                                                                                                                                                                             
                                                                                                                                                                                                         
         result = 0d0                                                                                                                                                                                    
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         do h=1,3                                                                                                                                                                                        
             do i = 1,3                                                                                                                                                                                  
                 do j = 1,3                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                     if (DABS(q)>eps .and.    DABS(m(h))>eps) Then                                                                                                                                       
                         Call GetIndex_mm(i,j,k)                                                                                                                                                         
                         if(DABS(alpha(k))>eps)then                                                                                                                                                      
                                                                                                                                                                                                         
                             call Get_Comp(h,cp_h)                                                                                                                                                       
                             call Get_Comp(i,cp_i)                                                                                                                                                       
                             call Get_Comp(j,cp_j)                                                                                                                                                       
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,1,Floor((j*1d0)/2d0),cp_j,1,Floor((h*1d0)/2d0),cp_h,r1)                                                                                                   
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,1,Floor((i*1d0)/2d0),cp_i,0,0,"0",r2)                                                                                                                     
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             result = result + (q*m(h))*alpha(k)*r1*r2                                                                                                                                   
                                                                                                                                                                                                         
                         end if                                                                                                                                                                          
                     end if                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
                                                                                                                                                                                                         
     else                                                                                                                                                                                                
         q       =  A_Multipoles(1)                                                                                                                                                                      
         m       =  A_Multipoles(2:4)                                                                                                                                                                    
         alpha   =  B_Pol(1:6)                                                                                                                                                                           
                                                                                                                                                                                                         
         result = 0d0                                                                                                                                                                                    
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         do h=1,3                                                                                                                                                                                        
             do i = 1,3                                                                                                                                                                                  
                 do j = 1,3                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                     if (DABS(q)>eps .and. DABS(m(h))>eps) Then                                                                                                                                          
                         Call GetIndex_mm(i,j,k)                                                                                                                                                         
                         if(DABS(alpha(k))>eps)then                                                                                                                                                      
                             !Call Tmm(Ar,Br,C ,j,h,ind,t_jh)                                                                                                                                            
                             !Call Tmq(Ar,Br,C ,i,ind,t_i)                                                                                                                                               
                             !result = result + (q*m(h))*alpha(k)*t_i*t_jh                                                                                                                               
                                                                                                                                                                                                         
                             call Get_Comp(h,cp_h)                                                                                                                                                       
                             call Get_Comp(i,cp_i)                                                                                                                                                       
                             call Get_Comp(j,cp_j)                                                                                                                                                       
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,1,Floor((h*1d0)/2d0),cp_h,1,Floor((j*1d0)/2d0),cp_j,r1)                                                                                                   
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,0,0,"0",1,Floor((i*1d0)/2d0),cp_i,r2)                                                                                                                     
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             result = result + (q*m(h))*alpha(k)*r1*r2                                                                                                                                   
                                                                                                                                                                                                         
                         end if                                                                                                                                                                          
                     end if                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
     end if                                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE qm_mm                                                                                                                                                                                    
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE qq_mQd(Ar,Br,C ,A_Multipoles,B_Multipoles ,A_Pol,B_Pol, ind , result)                                                                                                                        
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     INTEGER ::  i,j,k                                                                                                                                                                                   
     real*8, INTENT(INOUT) ::result                                                                                                                                                                      
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 , dimension(57) , INTENT(IN) :: A_Pol,B_Pol                                                                                                                                                  
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     Integer, INTENT(IN):: ind                                                                                                                                                                           
     real*8 :: q,r1,r2                                                                                                                                                                                   
     real*8 , dimension(15):: alpha_mQ                                                                                                                                                                   
     real*8:: eps=EPSILON(result)                                                                                                                                                                        
     Character :: cp1,cp2                                                                                                                                                                                
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     if (ind==0) then                                                                                                                                                                                    
         q =  B_Multipoles(1)                                                                                                                                                                            
         alpha_mQ  = A_Pol(7:21)                                                                                                                                                                         
                                                                                                                                                                                                         
         result = 0d0                                                                                                                                                                                    
                                                                                                                                                                                                         
                                                                                                                                                                                                         
             do i = 1,3                                                                                                                                                                                  
                 do j = 1,5                                                                                                                                                                              
                                                                                                                                                                                                         
                     if (DABS(q)>eps    ) Then                                                                                                                                                           
                         Call GetIndex_mQd(i,j,k)                                                                                                                                                        
                             !Call TQdq(Ar,Br,C ,j,ind,t_j)                                                                                                                                              
                             !Call Tmq (Ar,Br,C ,i,ind,t_i)                                                                                                                                              
                         if(DABS(alpha_mQ(k))>eps)Then                                                                                                                                                   
                             call Get_Comp(i,cp1)                                                                                                                                                        
                             call Get_Comp(j,cp2)                                                                                                                                                        
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,1,Floor((i*1d0)/2d0),cp1,0,0,"0",r1)                                                                                                                      
                             Call T_lk(Ar,Br,C,2,Floor((j*1d0)/2d0),cp2,0,0,"0",r2)                                                                                                                      
                                                                                                                                                                                                         
                             result = result + (q**2)*alpha_mQ(k)*r1*r2                                                                                                                                  
                             ! result = result + (q**2)*alpha_mQ(k)*t_i*t_j                                                                                                                              
                         end if                                                                                                                                                                          
                     end if                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
                                                                                                                                                                                                         
     else                                                                                                                                                                                                
         q       =  A_Multipoles(1)                                                                                                                                                                      
         alpha_mQ   =  B_Pol(7:21)                                                                                                                                                                       
                                                                                                                                                                                                         
         result = 0d0                                                                                                                                                                                    
                                                                                                                                                                                                         
                                                                                                                                                                                                         
             do i = 1,3                                                                                                                                                                                  
                 do j = 1,5                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                     if (DABS(q)>eps  ) Then                                                                                                                                                             
                         Call GetIndex_mQd(i,j,k)                                                                                                                                                        
                         if(DABS(alpha_mQ(k))>eps)then                                                                                                                                                   
                                                                                                                                                                                                         
                             call Get_Comp(i,cp1)                                                                                                                                                        
                             call Get_Comp(j,cp2)                                                                                                                                                        
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,0,0,"0",1,Floor((i*1d0)/2d0),cp1,r1)                                                                                                                      
                             Call T_lk(Ar,Br,C,0,0,"0",2,Floor((j*1d0)/2d0),cp2,r2)                                                                                                                      
                                                                                                                                                                                                         
                             result = result + (q**2)*alpha_mQ(k)*r1*r2                                                                                                                                  
                             ! result = result + (q**2)*alpha_mQ(k)*t_i*t_j                                                                                                                              
                         end if                                                                                                                                                                          
                     end if                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
                                                                                                                                                                                                         
     end if                                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE qq_mQd                                                                                                                                                                                   
                                                                                                                                                                                                         
     !********************************************************                                                                                                                                           
 SUBROUTINE Induction_6_Sph2(cal_coord,Ar,Br,C ,A_Multipoles,B_Multipoles ,A_Pol,B_Pol, Ind_6_Energy)                                                                                                    
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     !   NEED TO DECLARE ALL THE SUBROUTINE ARGUMENTS and                                                                                                                                                
     !   ANY OTHER VARIABLES LOCAL TO THE SUBROUTINE                                                                                                                                                     
                                                                                                                                                                                                         
     real*8, INTENT(INOUT)  :: Ind_6_Energy                                                                                                                                                              
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 , dimension(57) , INTENT(IN) :: A_Pol,B_Pol                                                                                                                                                  
     real*8 :: R                                                                                                                                                                                         
     real*8 , dimension(11), INTENT(IN):: cal_coord                                                                                                                                                      
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
                                                                                                                                                                                                         
     real*8 :: qQd_mm_0,qQd_mm_1,mm_mm_0,mm_mm_1,qm_mQd_0,qm_mQd_1,qm_Qdm_0,qm_Qdm_1                                                                                                                     
     real*8 :: qq_mO_0,qq_mO_1,qq_QdQd_0,qq_QdQd_1                                                                                                                                                       
                                                                                                                                                                                                         
     R =cal_coord(1)                                                                                                                                                                                     
                                                                                                                                                                                                         
     Call qQd_mm(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,0,qQd_mm_0)                                                                                                                              
     Call qQd_mm(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,1,qQd_mm_1)                                                                                                                              
                                                                                                                                                                                                         
     Call mm_mm(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,0,mm_mm_0)                                                                                                                                
     Call mm_mm(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,1,mm_mm_1)                                                                                                                                
                                                                                                                                                                                                         
     Call qm_mQd(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,0,qm_mQd_0)                                                                                                                              
     Call qm_mQd(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,1,qm_mQd_1)                                                                                                                              
                                                                                                                                                                                                         
     Call qm_Qdm(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,0,qm_Qdm_0)                                                                                                                              
     Call qm_Qdm(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,1,qm_Qdm_1)                                                                                                                              
                                                                                                                                                                                                         
     Call qq_mO(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,0,qq_mO_0)                                                                                                                                
     Call qq_mO(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,1,qq_mO_1)                                                                                                                                
                                                                                                                                                                                                         
     Call qq_QdQd(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,0,qq_QdQd_0)                                                                                                                            
     Call qq_QdQd(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,1,qq_QdQd_1)                                                                                                                            
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     Ind_6_Energy =   (-0.5d0)*(  2.0d0*qQd_mm_0 + 2.0d0*qQd_mm_1 &                                                                                                                                      
                                  +mm_mm_0 + mm_mm_1 &                                                                                                                                                   
                                  +2.0d0*qm_mQd_0 + 2.0d0*qm_mQd_1 +2.0d0*qm_Qdm_0 + 2.0d0*qm_Qdm_1 &                                                                                                    
                                 +2.0d0*qq_mO_0  + 2.0d0*qq_mO_1 + qq_QdQd_0 + qq_QdQd_1 &                                                                                                               
                                 )/ R**6                                                                                                                                                                 
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE Induction_6_Sph2                                                                                                                                                                         
     !********************************************************                                                                                                                                           
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE qQd_mm(Ar,Br,C ,A_Multipoles,B_Multipoles ,A_Pol,B_Pol, ind , result)                                                                                                                        
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     INTEGER ::  i,j,k,h                                                                                                                                                                                 
     real*8, INTENT(INOUT) ::result                                                                                                                                                                      
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 , dimension(57) , INTENT(IN) :: A_Pol,B_Pol                                                                                                                                                  
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     Integer, INTENT(IN):: ind                                                                                                                                                                           
     real*8 :: q,r1,r2                                                                                                                                                                                   
     real*8 , dimension(5):: Qd                                                                                                                                                                          
     real*8 , dimension(6):: alpha                                                                                                                                                                       
     real*8:: eps=EPSILON(result)                                                                                                                                                                        
                                                                                                                                                                                                         
     Character :: cp_h,cp_i,cp_j                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     if (ind==0) then                                                                                                                                                                                    
         q =  B_Multipoles(1)                                                                                                                                                                            
         Qd =  B_Multipoles(5:9)                                                                                                                                                                         
         alpha  = A_Pol(1:6)                                                                                                                                                                             
                                                                                                                                                                                                         
         result = 0d0                                                                                                                                                                                    
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         do h=1,5                                                                                                                                                                                        
             do i = 1,3                                                                                                                                                                                  
                 do j = 1,3                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                     if (DABS(q)>eps .and.   DABS(Qd(h))>eps) Then                                                                                                                                       
                             !Call TQdm(Ar,Br,C ,h,j,mod(ind+1,2),t_jh)                                                                                                                                  
                             !Call Tmq(Ar,Br,C ,i,ind,t_i)                                                                                                                                               
                         Call GetIndex_mm(i,j,k)                                                                                                                                                         
                                                                                                                                                                                                         
                         if(DABS(alpha(k))>eps )Then                                                                                                                                                     
                             call Get_Comp(h,cp_h)                                                                                                                                                       
                             call Get_Comp(i,cp_i)                                                                                                                                                       
                             call Get_Comp(j,cp_j)                                                                                                                                                       
                                                                                                                                                                                                         
                             !result = result + (q*Qd(h))*alpha(k)*t_i*t_jh                                                                                                                              
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,1,Floor((i*1d0)/2d0),cp_i,0,0,"0",r1)                                                                                                                     
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,1,Floor((j*1d0)/2d0),cp_j,2,Floor((h*1d0)/2d0),cp_h,r2)                                                                                                   
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             result = result + (q*Qd(h))*alpha(k)*r1*r2                                                                                                                                  
                         end if                                                                                                                                                                          
                     end if                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
                                                                                                                                                                                                         
     else                                                                                                                                                                                                
         q       =  A_Multipoles(1)                                                                                                                                                                      
         Qd       =  A_Multipoles(5:9)                                                                                                                                                                   
         alpha   =  B_Pol(1:6)                                                                                                                                                                           
                                                                                                                                                                                                         
         result = 0d0                                                                                                                                                                                    
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         do h=1,5                                                                                                                                                                                        
             do i = 1,3                                                                                                                                                                                  
                 do j = 1,3                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                     if (DABS(q)>eps   .and. DABS(Qd(h))>eps) Then                                                                                                                                       
                             !Call TQdm(Ar,Br,C ,h,j,mod(ind+1,2),t_jh)                                                                                                                                  
                             !Call Tmq(Ar,Br,C ,i,ind,t_i)                                                                                                                                               
                         Call GetIndex_mm(i,j,k)                                                                                                                                                         
                         if(DABS(alpha(k))>eps)Then                                                                                                                                                      
                             call Get_Comp(h,cp_h)                                                                                                                                                       
                             call Get_Comp(i,cp_i)                                                                                                                                                       
                             call Get_Comp(j,cp_j)                                                                                                                                                       
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,0,0,"0",1,Floor((i*1d0)/2d0),cp_i,r1)                                                                                                                     
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,2,Floor((h*1d0)/2d0),cp_h,1,Floor((j*1d0)/2d0),cp_j,r2)                                                                                                   
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             result = result + (q*Qd(h))*alpha(k)*r1*r2                                                                                                                                  
                         end if                                                                                                                                                                          
                     end if                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
     end if                                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE qQd_mm                                                                                                                                                                                   
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE mm_mm(Ar,Br,C ,A_Multipoles,B_Multipoles ,A_Pol,B_Pol, ind , result)                                                                                                                         
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     INTEGER ::  i,j,k,h,g                                                                                                                                                                               
     real*8, INTENT(INOUT) ::result                                                                                                                                                                      
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 , dimension(57) , INTENT(IN) :: A_Pol,B_Pol                                                                                                                                                  
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     Integer, INTENT(IN):: ind                                                                                                                                                                           
     real*8 :: r1,r2                                                                                                                                                                                     
     real*8 , dimension(3):: m                                                                                                                                                                           
     real*8 , dimension(6):: alpha                                                                                                                                                                       
     real*8:: eps=EPSILON(result)                                                                                                                                                                        
                                                                                                                                                                                                         
     Character :: cp_h,cp_i,cp_j,cp_g                                                                                                                                                                    
                                                                                                                                                                                                         
     result = 0d0                                                                                                                                                                                        
                                                                                                                                                                                                         
     if (ind==0) then                                                                                                                                                                                    
                                                                                                                                                                                                         
         m =  B_Multipoles(2:4)                                                                                                                                                                          
         alpha  = A_Pol(1:6)                                                                                                                                                                             
                                                                                                                                                                                                         
         do g=1,3                                                                                                                                                                                        
             do h=1,3                                                                                                                                                                                    
                 do i = 1,3                                                                                                                                                                              
                     do j = 1,3                                                                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         if (DABS(m(g))>eps  .and. DABS(m(h))>eps) Then                                                                                                                                  
                             Call GetIndex_mm(i,j,k)                                                                                                                                                     
                             if ( DABS(alpha(k))>eps ) Then                                                                                                                                              
                                 ! Call Tmm(Ar,Br,C ,j,h,ind,t_jh)                                                                                                                                       
                                 ! Call Tmm(Ar,Br,C ,i,g,ind,t_ig)                                                                                                                                       
                                 ! result = result + (m(g)*m(h))*alpha(k)*t_ig*t_jh                                                                                                                      
                                                                                                                                                                                                         
                             call Get_Comp(g,cp_g)                                                                                                                                                       
                             call Get_Comp(h,cp_h)                                                                                                                                                       
                             call Get_Comp(i,cp_i)                                                                                                                                                       
                             call Get_Comp(j,cp_j)                                                                                                                                                       
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,1,Floor((j*1d0)/2d0),cp_j,1,Floor((h*1d0)/2d0),cp_h,r1)                                                                                                   
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,1,Floor((i*1d0)/2d0),cp_i,1,Floor((g*1d0)/2d0),cp_g,r2)                                                                                                   
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             result = result + (m(g)*m(h))*alpha(k)*r1*r2                                                                                                                                
                         end if                                                                                                                                                                          
                         end if                                                                                                                                                                          
                     end do                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
                                                                                                                                                                                                         
     else                                                                                                                                                                                                
         m      =  A_Multipoles(2:4)                                                                                                                                                                     
         alpha   =  B_Pol(1:6)                                                                                                                                                                           
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         do g=1,3                                                                                                                                                                                        
             do h=1,3                                                                                                                                                                                    
                 do i = 1,3                                                                                                                                                                              
                     do j = 1,3                                                                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         if (DABS(m(g))>eps .and. DABS(m(h))>eps) Then                                                                                                                                   
                             Call GetIndex_mm(i,j,k)                                                                                                                                                     
                             if ( DABS(alpha(k))>eps ) Then                                                                                                                                              
                                 ! Call Tmm(Ar,Br,C ,j,h,ind,t_jh)                                                                                                                                       
                                 ! Call Tmm(Ar,Br,C ,i,g,ind,t_ig)                                                                                                                                       
                                 ! result = result + (m(g)*m(h))*alpha(k)*t_ig*t_jh                                                                                                                      
                                                                                                                                                                                                         
                             call Get_Comp(g,cp_g)                                                                                                                                                       
                             call Get_Comp(h,cp_h)                                                                                                                                                       
                             call Get_Comp(i,cp_i)                                                                                                                                                       
                             call Get_Comp(j,cp_j)                                                                                                                                                       
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,1,Floor((h*1d0)/2d0),cp_h,1,Floor((j*1d0)/2d0),cp_j,r1)                                                                                                   
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,1,Floor((g*1d0)/2d0),cp_g,1,Floor((i*1d0)/2d0),cp_i,r2)                                                                                                   
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             result = result + (m(g)*m(h))*alpha(k)*r1*r2                                                                                                                                
                         end if                                                                                                                                                                          
                         end if                                                                                                                                                                          
                     end do                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     end if                                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE mm_mm                                                                                                                                                                                    
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE qm_mQd(Ar,Br,C ,A_Multipoles,B_Multipoles ,A_Pol,B_Pol, ind , result)                                                                                                                        
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     INTEGER ::  i,j,k,h                                                                                                                                                                                 
     real*8, INTENT(INOUT) ::result                                                                                                                                                                      
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 , dimension(57) , INTENT(IN) :: A_Pol,B_Pol                                                                                                                                                  
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     Integer, INTENT(IN):: ind                                                                                                                                                                           
     real*8 :: q,r1,r2                                                                                                                                                                                   
     real*8 , dimension(3):: m                                                                                                                                                                           
     real*8 , dimension(15):: alpha_mQ                                                                                                                                                                   
     real*8:: eps=EPSILON(result)                                                                                                                                                                        
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     Character :: cp_h,cp_i,cp_j                                                                                                                                                                         
                                                                                                                                                                                                         
     result = 0d0                                                                                                                                                                                        
                                                                                                                                                                                                         
     if (ind==0) then                                                                                                                                                                                    
         q =  B_Multipoles(1)                                                                                                                                                                            
         m =  B_Multipoles(2:4)                                                                                                                                                                          
         alpha_mQ  = A_Pol(7:21)                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         do h = 1,3                                                                                                                                                                                      
             do i = 1,3                                                                                                                                                                                  
                 do j = 1,5                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                     if (DABS(m(h))>eps .and. DABS(q)>eps ) Then                                                                                                                                         
                         Call GetIndex_mQd(i,j,k)                                                                                                                                                        
                         if (  DABS(alpha_mQ(k))>eps ) Then                                                                                                                                              
                             ! Call TQdq(Ar,Br,C ,j,ind,t_j)                                                                                                                                             
                             ! Call Tmm (Ar,Br,C ,i,h,ind,t_ih)                                                                                                                                          
                             ! result = result + (q*m(h))*alpha_mQ(k)*t_ih*t_j                                                                                                                           
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         call Get_Comp(h,cp_h)                                                                                                                                                           
                         call Get_Comp(i,cp_i)                                                                                                                                                           
                         call Get_Comp(j,cp_j)                                                                                                                                                           
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,1,Floor((i*1d0)/2d0),cp_i,1,Floor((h*1d0)/2d0),cp_h,r1)                                                                                                       
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,2,Floor((j*1d0)/2d0),cp_j,0,0,"0",r2)                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         result = result + (q*m(h))*alpha_mQ(k)*r1*r2                                                                                                                                    
                                                                                                                                                                                                         
                     end if                                                                                                                                                                              
                     end if                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     else                                                                                                                                                                                                
         q           =  A_Multipoles(1)                                                                                                                                                                  
         m           =  A_Multipoles(2:4)                                                                                                                                                                
         alpha_mQ    =  B_Pol(7:21)                                                                                                                                                                      
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         do h = 1,3                                                                                                                                                                                      
             do i = 1,3                                                                                                                                                                                  
                 do j = 1,5                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                     if (DABS(m(h))>eps .and. DABS(q)>eps  ) Then                                                                                                                                        
                         Call GetIndex_mQd(i,j,k)                                                                                                                                                        
                         if ( DABS(alpha_mQ(k))>eps ) Then                                                                                                                                               
                             ! Call TQdq(Ar,Br,C ,j,ind,t_j)                                                                                                                                             
                             ! Call Tmm (Ar,Br,C ,i,h,ind,t_ih)                                                                                                                                          
                             ! result = result + (q*m(h))*alpha_mQ(k)*t_ih*t_j                                                                                                                           
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         call Get_Comp(h,cp_h)                                                                                                                                                           
                         call Get_Comp(i,cp_i)                                                                                                                                                           
                         call Get_Comp(j,cp_j)                                                                                                                                                           
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,1,Floor((h*1d0)/2d0),cp_h,1,Floor((i*1d0)/2d0),cp_i,r1)                                                                                                       
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,0,0,"0",2,Floor((j*1d0)/2d0),cp_j,r2)                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         result = result + (q*m(h))*alpha_mQ(k)*r1*r2                                                                                                                                    
                                                                                                                                                                                                         
                     end if                                                                                                                                                                              
                     end if                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     end if                                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE qm_mQd                                                                                                                                                                                   
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE qm_Qdm(Ar,Br,C ,A_Multipoles,B_Multipoles ,A_Pol,B_Pol, ind , result)                                                                                                                        
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     INTEGER ::  i,j,k,h                                                                                                                                                                                 
     real*8, INTENT(INOUT) ::result                                                                                                                                                                      
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 , dimension(57) , INTENT(IN) :: A_Pol,B_Pol                                                                                                                                                  
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     Integer, INTENT(IN):: ind                                                                                                                                                                           
     real*8 :: q,r1,r2                                                                                                                                                                                   
     real*8 , dimension(3):: m                                                                                                                                                                           
     real*8 , dimension(15):: alpha_mQ                                                                                                                                                                   
     real*8:: eps=EPSILON(result)                                                                                                                                                                        
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     Character :: cp_h,cp_i,cp_j                                                                                                                                                                         
                                                                                                                                                                                                         
     result = 0d0                                                                                                                                                                                        
                                                                                                                                                                                                         
     if (ind==0) then                                                                                                                                                                                    
         q =  B_Multipoles(1)                                                                                                                                                                            
         m =  B_Multipoles(2:4)                                                                                                                                                                          
         alpha_mQ  = A_Pol(7:21)                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         do h = 1,3                                                                                                                                                                                      
             do i = 1,3                                                                                                                                                                                  
                 do j = 1,5                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                     if (DABS(m(h))>eps .and. DABS(q)>eps ) Then                                                                                                                                         
                         Call GetIndex_mQd(i,j,k)                                                                                                                                                        
                         if ( DABS(alpha_mQ(k))>eps ) Then                                                                                                                                               
                             ! Call TQdm(Ar,Br,C ,j,h,ind,t_jh)                                                                                                                                          
                             ! Call Tmq (Ar,Br,C ,i,ind,t_i)                                                                                                                                             
                             ! result = result + (q*m(h))*alpha_mQ(k)*t_i*t_jh                                                                                                                           
                                                                                                                                                                                                         
                         call Get_Comp(h,cp_h)                                                                                                                                                           
                         call Get_Comp(i,cp_i)                                                                                                                                                           
                         call Get_Comp(j,cp_j)                                                                                                                                                           
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,2,Floor((j*1d0)/2d0),cp_j,1,Floor((h*1d0)/2d0),cp_h,r1)                                                                                                       
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,1,Floor((i*1d0)/2d0),cp_i,0,0,"0",r2)                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         result = result + (q*m(h))*alpha_mQ(k)*r1*r2                                                                                                                                    
                     end if                                                                                                                                                                              
                     end if                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     else                                                                                                                                                                                                
         q           =  A_Multipoles(1)                                                                                                                                                                  
         m           =  A_Multipoles(2:4)                                                                                                                                                                
         alpha_mQ    =  B_Pol(7:21)                                                                                                                                                                      
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         do h = 1,3                                                                                                                                                                                      
             do i = 1,3                                                                                                                                                                                  
                 do j = 1,5                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                     if (DABS(m(h))>eps .and. DABS(q)>eps  ) Then                                                                                                                                        
                         Call GetIndex_mQd(i,j,k)                                                                                                                                                        
                         if ( DABS(alpha_mQ(k))>eps ) Then                                                                                                                                               
                             ! Call TQdm(Ar,Br,C ,j,h,ind,t_jh)                                                                                                                                          
                             ! Call Tmq (Ar,Br,C ,i,ind,t_i)                                                                                                                                             
                             ! result = result + (q*m(h))*alpha_mQ(k)*t_i*t_jh                                                                                                                           
                                                                                                                                                                                                         
                         call Get_Comp(h,cp_h)                                                                                                                                                           
                         call Get_Comp(i,cp_i)                                                                                                                                                           
                         call Get_Comp(j,cp_j)                                                                                                                                                           
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,1,Floor((h*1d0)/2d0),cp_h,2,Floor((j*1d0)/2d0),cp_j,r1)                                                                                                       
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,0,0,"0",1,Floor((i*1d0)/2d0),cp_i,r2)                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         result = result + (q*m(h))*alpha_mQ(k)*r1*r2                                                                                                                                    
                     end if                                                                                                                                                                              
                     end if                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
     end if                                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE qm_Qdm                                                                                                                                                                                   
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE qq_mO(Ar,Br,C ,A_Multipoles,B_Multipoles ,A_Pol,B_Pol, ind , result)                                                                                                                         
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     INTEGER ::  i,j,k                                                                                                                                                                                   
     real*8, INTENT(INOUT) ::result                                                                                                                                                                      
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 , dimension(57) , INTENT(IN) :: A_Pol,B_Pol                                                                                                                                                  
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     Integer, INTENT(IN):: ind                                                                                                                                                                           
     real*8 :: q,r1,r2                                                                                                                                                                                   
     real*8 , dimension(21):: alpha_mO                                                                                                                                                                   
     real*8:: eps=EPSILON(result)                                                                                                                                                                        
                                                                                                                                                                                                         
     Character :: cp_i,cp_j                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     result = 0d0                                                                                                                                                                                        
                                                                                                                                                                                                         
     if (ind==0) then                                                                                                                                                                                    
         q =  B_Multipoles(1)                                                                                                                                                                            
         alpha_mO  = A_Pol(37:57)                                                                                                                                                                        
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
             do i = 1,3                                                                                                                                                                                  
                 do j = 1,7                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                     if ( DABS(q)>eps  ) Then                                                                                                                                                            
                         Call GetIndex_mO(i,j,k)                                                                                                                                                         
                         if (   DABS(alpha_mO(k))>eps ) Then                                                                                                                                             
                                                                                                                                                                                                         
                             ! Call TOq(Ar,Br,C ,j,ind,t_j)                                                                                                                                              
                             ! Call Tmq (Ar,Br,C ,i,ind,t_i)                                                                                                                                             
                             ! result = result + (q**2)*alpha_mO(k)*t_i*t_j                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         call Get_Comp(i,cp_i)                                                                                                                                                           
                         call Get_Comp(j,cp_j)                                                                                                                                                           
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,3,Floor((j*1d0)/2d0),cp_j,0,0,"0",r1)                                                                                                                         
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,1,Floor((i*1d0)/2d0),cp_i,0,0,"0",r2)                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         result = result + (q**2)*alpha_mO(k)*r1*r2                                                                                                                                      
                         end if                                                                                                                                                                          
                     end if                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     else                                                                                                                                                                                                
         q           =  A_Multipoles(1)                                                                                                                                                                  
         alpha_mO    =  B_Pol(37:57)                                                                                                                                                                     
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
             do i = 1,3                                                                                                                                                                                  
                 do j = 1,7                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                     if ( DABS(q)>eps  ) Then                                                                                                                                                            
                         Call GetIndex_mO(i,j,k)                                                                                                                                                         
                         if (  DABS(alpha_mO(k))>eps ) Then                                                                                                                                              
                             ! Call TOq(Ar,Br,C ,j,ind,t_j)                                                                                                                                              
                             ! Call Tmq (Ar,Br,C ,i,ind,t_i)                                                                                                                                             
                             ! result = result + (q**2)*alpha_mO(k)*t_i*t_j                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         call Get_Comp(i,cp_i)                                                                                                                                                           
                         call Get_Comp(j,cp_j)                                                                                                                                                           
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,0,0,"0",3,Floor((j*1d0)/2d0),cp_j,r1)                                                                                                                         
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,0,0,"0",1,Floor((i*1d0)/2d0),cp_i,r2)                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         result = result + (q**2)*alpha_mO(k)*r1*r2                                                                                                                                      
                         end if                                                                                                                                                                          
                     end if                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     end if                                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE qq_mO                                                                                                                                                                                    
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE qq_QdQd(Ar,Br,C ,A_Multipoles,B_Multipoles ,A_Pol,B_Pol, ind , result)                                                                                                                       
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     INTEGER ::  i,j,k                                                                                                                                                                                   
     real*8, INTENT(INOUT) ::result                                                                                                                                                                      
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 , dimension(57) , INTENT(IN) :: A_Pol,B_Pol                                                                                                                                                  
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     Integer, INTENT(IN):: ind                                                                                                                                                                           
     real*8 :: q,r1,r2                                                                                                                                                                                   
     real*8 , dimension(15):: alpha_QdQd                                                                                                                                                                 
     real*8:: eps=EPSILON(result)                                                                                                                                                                        
                                                                                                                                                                                                         
     Character :: cp_i,cp_j                                                                                                                                                                              
                                                                                                                                                                                                         
     result = 0d0                                                                                                                                                                                        
                                                                                                                                                                                                         
     if (ind==0) then                                                                                                                                                                                    
         q =  B_Multipoles(1)                                                                                                                                                                            
         alpha_QdQd  = A_Pol(22:36)                                                                                                                                                                      
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
             do i = 1,5                                                                                                                                                                                  
                 do j = 1,5                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                     if ( DABS(q)>eps  ) Then                                                                                                                                                            
                         Call GetIndex_QdQd(i,j,k)                                                                                                                                                       
                         if (  DABS(alpha_QdQd(k))>eps ) Then                                                                                                                                            
                             ! Call TQdq(Ar,Br,C ,j,ind,t_j)                                                                                                                                             
                             ! Call TQdq (Ar,Br,C ,i,ind,t_i)                                                                                                                                            
                             ! result = result + (q**2)*alpha_QdQd(k)*t_i*t_j                                                                                                                            
                                                                                                                                                                                                         
                         call Get_Comp(i,cp_i)                                                                                                                                                           
                         call Get_Comp(j,cp_j)                                                                                                                                                           
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,2,Floor((j*1d0)/2d0),cp_j,0,0,"0",r1)                                                                                                                         
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,2,Floor((i*1d0)/2d0),cp_i,0,0,"0",r2)                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         result = result + (q**2)*alpha_QdQd(k)*r1*r2                                                                                                                                    
                     end if                                                                                                                                                                              
                     end if                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
                                                                                                                                                                                                         
     else                                                                                                                                                                                                
         q            =  A_Multipoles(1)                                                                                                                                                                 
         alpha_QdQd   =  B_Pol(22:36)                                                                                                                                                                    
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
             do i = 1,5                                                                                                                                                                                  
                 do j = 1,5                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                     if ( DABS(q)>eps  ) Then                                                                                                                                                            
                         Call GetIndex_QdQd(i,j,k)                                                                                                                                                       
                         if (  DABS(alpha_QdQd(k))>eps ) Then                                                                                                                                            
                             ! Call TQdq(Ar,Br,C ,j,ind,t_j)                                                                                                                                             
                             ! Call TQdq (Ar,Br,C ,i,ind,t_i)                                                                                                                                            
                             ! result = result + (q**2)*alpha_QdQd(k)*t_i*t_j                                                                                                                            
                                                                                                                                                                                                         
                         call Get_Comp(i,cp_i)                                                                                                                                                           
                         call Get_Comp(j,cp_j)                                                                                                                                                           
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,0,0,"0",2,Floor((j*1d0)/2d0),cp_j,r1)                                                                                                                         
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,0,0,"0",2,Floor((i*1d0)/2d0),cp_i,r2)                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         result = result + (q**2)*alpha_QdQd(k)*r1*r2                                                                                                                                    
                                                                                                                                                                                                         
                     end if                                                                                                                                                                              
                 end if                                                                                                                                                                                  
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
                                                                                                                                                                                                         
     end if                                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE qq_QdQd                                                                                                                                                                                  
                                                                                                                                                                                                         
     !********************************************************                                                                                                                                           
 SUBROUTINE Induction_7_Sph2(cal_coord,Ar,Br,C ,A_Multipoles,B_Multipoles ,A_Pol,B_Pol, Ind_7_Energy)                                                                                                    
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     !   NEED TO DECLARE ALL THE SUBROUTINE ARGUMENTS and                                                                                                                                                
     !   ANY OTHER VARIABLES LOCAL TO THE SUBROUTINE                                                                                                                                                     
                                                                                                                                                                                                         
     real*8, INTENT(INOUT)  :: Ind_7_Energy                                                                                                                                                              
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 , dimension(57) , INTENT(IN) :: A_Pol,B_Pol                                                                                                                                                  
     real*8 :: R                                                                                                                                                                                         
     real*8 , dimension(11), INTENT(IN):: cal_coord                                                                                                                                                      
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
                                                                                                                                                                                                         
     real*8 :: qO_mm_0,qO_mm_1,mQd_mm_0,mQd_mm_1,mm_mQd_0,mm_mQd_1,qQd_mQd_0,qQd_mQd_1                                                                                                                   
     real*8 :: qQd_Qdm_0,qQd_Qdm_1,qm_QdQd_0,qm_QdQd_1,qm_mO_0,qm_mO_1,qm_Om_0,qm_Om_1                                                                                                                   
                                                                                                                                                                                                         
     R =cal_coord(1)                                                                                                                                                                                     
                                                                                                                                                                                                         
     Call qO_mm(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,0,qO_mm_0)                                                                                                                                
     Call qO_mm(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,1,qO_mm_1)                                                                                                                                
                                                                                                                                                                                                         
     Call mQd_mm(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,0,mQd_mm_0)                                                                                                                              
     Call mQd_mm(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,1,mQd_mm_1)                                                                                                                              
                                                                                                                                                                                                         
     Call mm_mQd(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,0,mm_mQd_0)                                                                                                                              
     Call mm_mQd(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,1,mm_mQd_1)                                                                                                                              
                                                                                                                                                                                                         
     Call qQd_mQd(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,0,qQd_mQd_0)                                                                                                                            
     Call qQd_mQd(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,1,qQd_mQd_1)                                                                                                                            
                                                                                                                                                                                                         
     Call qQd_Qdm(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,0,qQd_Qdm_0)                                                                                                                            
     Call qQd_Qdm(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,1,qQd_Qdm_1)                                                                                                                            
                                                                                                                                                                                                         
     Call qm_QdQd(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,0,qm_QdQd_0)                                                                                                                            
     Call qm_QdQd(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,1,qm_QdQd_1)                                                                                                                            
                                                                                                                                                                                                         
     Call qm_mO(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,0,qm_mO_0)                                                                                                                                
     Call qm_mO(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,1,qm_mO_1)                                                                                                                                
                                                                                                                                                                                                         
     Call qm_Om(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,0,qm_Om_0)                                                                                                                                
     Call qm_Om(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,1,qm_Om_1)                                                                                                                                
                                                                                                                                                                                                         
     Ind_7_Energy =   (-0.5d0)*(  2.0d0*qO_mm_0 + 2.0d0*qO_mm_1  +2.0d0*mQd_mm_0 +2.0d0*mQd_mm_1 &                                                                                                       
                                 +2.0d0*mm_mQd_0+ 2.0d0*mm_mQd_1 +2.0d0*qQd_mQd_0+2.0d0*qQd_mQd_1 &                                                                                                      
                                 +2.0d0*qQd_Qdm_0+2.0d0*qQd_Qdm_1+2.0d0*qm_QdQd_0+2.0d0*qm_QdQd_1 &                                                                                                      
                                 +2.0d0*qm_mO_0 + 2.0d0*qm_mO_1 +2.0d0*qm_Om_0 + 2.0d0*qm_Om_1&                                                                                                          
                                 )/ R**7                                                                                                                                                                 
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE Induction_7_Sph2                                                                                                                                                                         
     !********************************************************                                                                                                                                           
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE qO_mm(Ar,Br,C ,A_Multipoles,B_Multipoles ,A_Pol,B_Pol, ind , result)                                                                                                                         
         IMPLICIT NONE                                                                                                                                                                                   
                                                                                                                                                                                                         
         INTEGER ::  i,j,k,h                                                                                                                                                                             
         real*8, INTENT(INOUT) ::result                                                                                                                                                                  
         real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                
         real*8 , dimension(57) , INTENT(IN) :: A_Pol,B_Pol                                                                                                                                              
         real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                          
         real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                          
         real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                           
         Integer, INTENT(IN):: ind                                                                                                                                                                       
         real*8 :: q,r1,r2                                                                                                                                                                               
         real*8 , dimension(7):: O                                                                                                                                                                       
         real*8 , dimension(6):: alpha                                                                                                                                                                   
         real*8:: eps=EPSILON(result)                                                                                                                                                                    
                                                                                                                                                                                                         
         Character :: cp_h,cp_i,cp_j                                                                                                                                                                     
                                                                                                                                                                                                         
         result = 0d0                                                                                                                                                                                    
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         if (ind==0) then                                                                                                                                                                                
             q =  B_Multipoles(1)                                                                                                                                                                        
             O =  B_Multipoles(10:16)                                                                                                                                                                    
             alpha  = A_Pol(1:6)                                                                                                                                                                         
                                                                                                                                                                                                         
             do h=1,7                                                                                                                                                                                    
                 do i = 1,3                                                                                                                                                                              
                     do j = 1,3                                                                                                                                                                          
                                                                                                                                                                                                         
                         Call GetIndex_mm(i,j,k)                                                                                                                                                         
                                                                                                                                                                                                         
                         if (DABS(q)>eps .and.  DABS(alpha(k))>eps .and. DABS(O(h))>eps) Then                                                                                                            
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             call Get_Comp(h,cp_h)                                                                                                                                                       
                             call Get_Comp(i,cp_i)                                                                                                                                                       
                             call Get_Comp(j,cp_j)                                                                                                                                                       
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,1,Floor((i*1d0)/2d0),cp_i,3,Floor((h*1d0)/2d0),cp_h,r1)                                                                                                   
                             Call T_lk(Ar,Br,C,1,Floor((j*1d0)/2d0),cp_j,0,0,"0",r2)                                                                                                                     
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             result = result + (q*O(h))*alpha(k)*r1*r2                                                                                                                                   
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         end if                                                                                                                                                                          
                     end do                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
                                                                                                                                                                                                         
         else                                                                                                                                                                                            
             q       =  A_Multipoles(1)                                                                                                                                                                  
             O       =  A_Multipoles(10:16)                                                                                                                                                              
             alpha   =  B_Pol(1:6)                                                                                                                                                                       
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
             do h=1,7                                                                                                                                                                                    
                 do i = 1,3                                                                                                                                                                              
                     do j = 1,3                                                                                                                                                                          
                                                                                                                                                                                                         
                         Call GetIndex_mm(i,j,k)                                                                                                                                                         
                                                                                                                                                                                                         
                         if (DABS(q)>eps .and.  DABS(alpha(k))>eps .and. DABS(O(h))>eps) Then                                                                                                            
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             call Get_Comp(h,cp_h)                                                                                                                                                       
                             call Get_Comp(i,cp_i)                                                                                                                                                       
                             call Get_Comp(j,cp_j)                                                                                                                                                       
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,3,Floor((h*1d0)/2d0),cp_h,1,Floor((i*1d0)/2d0),cp_i,r1)                                                                                                   
                             Call T_lk(Ar,Br,C,0,0,"0",1,Floor((j*1d0)/2d0),cp_j,r2)                                                                                                                     
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             result = result + (q*O(h))*alpha(k)*r1*r2                                                                                                                                   
                                                                                                                                                                                                         
                         end if                                                                                                                                                                          
                     end do                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
                                                                                                                                                                                                         
         end if                                                                                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         RETURN                                                                                                                                                                                          
 END SUBROUTINE qO_mm                                                                                                                                                                                    
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE mQd_mm(Ar,Br,C ,A_Multipoles,B_Multipoles ,A_Pol,B_Pol, ind , result)                                                                                                                        
             IMPLICIT NONE                                                                                                                                                                               
                                                                                                                                                                                                         
             INTEGER ::  i,j,k,h,g                                                                                                                                                                       
             real*8, INTENT(INOUT) ::result                                                                                                                                                              
             real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                            
             real*8 , dimension(57) , INTENT(IN) :: A_Pol,B_Pol                                                                                                                                          
             real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                      
             real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                      
             real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                       
             Integer, INTENT(IN):: ind                                                                                                                                                                   
             real*8 :: r1,r2                                                                                                                                                                             
             real*8 , dimension(3):: m                                                                                                                                                                   
             real*8 , dimension(5):: Qd                                                                                                                                                                  
             real*8 , dimension(6):: alpha                                                                                                                                                               
             real*8:: eps=EPSILON(result)                                                                                                                                                                
                                                                                                                                                                                                         
             Character :: cp_g,cp_h,cp_i,cp_j                                                                                                                                                            
                                                                                                                                                                                                         
             result = 0d0                                                                                                                                                                                
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
             if (ind==0) then                                                                                                                                                                            
                 m        =  B_Multipoles(2:4)                                                                                                                                                           
                 Qd       =  B_Multipoles(5:9)                                                                                                                                                           
                 alpha  = A_Pol(1:6)                                                                                                                                                                     
                                                                                                                                                                                                         
                 do g=1,3                                                                                                                                                                                
                     do h=1,5                                                                                                                                                                            
                         do i = 1,3                                                                                                                                                                      
                             do j = 1,3                                                                                                                                                                  
                                                                                                                                                                                                         
                                 Call GetIndex_mm(i,j,k)                                                                                                                                                 
                                                                                                                                                                                                         
                                 if (DABS(m(g))>eps .and.  DABS(alpha(k))>eps .and. DABS(Qd(h))>eps) Then                                                                                                
                                         ! Call TQdm(Ar,Br,C ,h,j,mod(ind+1,2),t_jh)                                                                                                                     
                                         ! Call Tmm(Ar,Br,C ,i,g,ind,t_ig)                                                                                                                               
                                         ! result = result + (m(g)*Qd(h))*alpha(k)*t_ig*t_jh                                                                                                             
                                                                                                                                                                                                         
                                         call Get_Comp(g,cp_g)                                                                                                                                           
                                         call Get_Comp(h,cp_h)                                                                                                                                           
                                         call Get_Comp(i,cp_i)                                                                                                                                           
                                         call Get_Comp(j,cp_j)                                                                                                                                           
                                                                                                                                                                                                         
                                         Call T_lk(Ar,Br,C,1,Floor((j*1d0)/2d0),cp_j,2,Floor((h*1d0)/2d0),cp_h,r1)                                                                                       
                                                                                                                                                                                                         
                                         Call T_lk(Ar,Br,C,1,Floor((i*1d0)/2d0),cp_i,1,Floor((g*1d0)/2d0),cp_g,r2)                                                                                       
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                         result = result + (m(g)*Qd(h))*alpha(k)*r1*r2                                                                                                                   
                                                                                                                                                                                                         
                                 end if                                                                                                                                                                  
                             end do                                                                                                                                                                      
                         end do                                                                                                                                                                          
                     end do                                                                                                                                                                              
                 end do                                                                                                                                                                                  
                                                                                                                                                                                                         
             else                                                                                                                                                                                        
                 m       =  A_Multipoles(2:4)                                                                                                                                                            
                 Qd       =  A_Multipoles(5:9)                                                                                                                                                           
                 alpha   =  B_Pol(1:6)                                                                                                                                                                   
                                                                                                                                                                                                         
                 do g=1,3                                                                                                                                                                                
                     do h=1,5                                                                                                                                                                            
                         do i = 1,3                                                                                                                                                                      
                             do j = 1,3                                                                                                                                                                  
                                                                                                                                                                                                         
                                 Call GetIndex_mm(i,j,k)                                                                                                                                                 
                                                                                                                                                                                                         
                                 if (DABS(m(g))>eps .and.  DABS(alpha(k))>eps .and. DABS(Qd(h))>eps) Then                                                                                                
                                         ! Call TQdm(Ar,Br,C ,h,j,mod(ind+1,2),t_jh)                                                                                                                     
                                         ! Call Tmm(Ar,Br,C ,i,g,ind,t_ig)                                                                                                                               
                                         ! result = result + (m(g)*Qd(h))*alpha(k)*t_ig*t_jh                                                                                                             
                                                                                                                                                                                                         
                                         call Get_Comp(g,cp_g)                                                                                                                                           
                                         call Get_Comp(h,cp_h)                                                                                                                                           
                                         call Get_Comp(i,cp_i)                                                                                                                                           
                                         call Get_Comp(j,cp_j)                                                                                                                                           
                                                                                                                                                                                                         
                                         Call T_lk(Ar,Br,C,2,Floor((h*1d0)/2d0),cp_h,1,Floor((j*1d0)/2d0),cp_j,r1)                                                                                       
                                                                                                                                                                                                         
                                         Call T_lk(Ar,Br,C,1,Floor((g*1d0)/2d0),cp_g,1,Floor((i*1d0)/2d0),cp_i,r2)                                                                                       
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                         result = result + (m(g)*Qd(h))*alpha(k)*r1*r2                                                                                                                   
                                                                                                                                                                                                         
                                 end if                                                                                                                                                                  
                             end do                                                                                                                                                                      
                         end do                                                                                                                                                                          
                     end do                                                                                                                                                                              
                 end do                                                                                                                                                                                  
                                                                                                                                                                                                         
             end if                                                                                                                                                                                      
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
             RETURN                                                                                                                                                                                      
 END SUBROUTINE mQd_mm                                                                                                                                                                                   
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE mm_mQd(Ar,Br,C ,A_Multipoles,B_Multipoles ,A_Pol,B_Pol, ind , result)                                                                                                                        
                     IMPLICIT NONE                                                                                                                                                                       
                                                                                                                                                                                                         
                     INTEGER ::  i,j,k,h,g                                                                                                                                                               
                     real*8, INTENT(INOUT) ::result                                                                                                                                                      
                     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                    
                     real*8 , dimension(57) , INTENT(IN) :: A_Pol,B_Pol                                                                                                                                  
                     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                              
                     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                              
                     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                               
                     Integer, INTENT(IN):: ind                                                                                                                                                           
                     real*8 :: r1,r2                                                                                                                                                                     
                     real*8 , dimension(3):: m                                                                                                                                                           
                     real*8 , dimension(15):: alpha_mQ                                                                                                                                                   
                     real*8:: eps=EPSILON(result)                                                                                                                                                        
                                                                                                                                                                                                         
                     Character :: cp_h,cp_i,cp_j,cp_g                                                                                                                                                    
                                                                                                                                                                                                         
                     result = 0d0                                                                                                                                                                        
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                     if (ind==0) then                                                                                                                                                                    
                         m =  B_Multipoles(2:4)                                                                                                                                                          
                         alpha_mQ  = A_Pol(7:21)                                                                                                                                                         
                                                                                                                                                                                                         
                         do g = 1,3                                                                                                                                                                      
                             do h = 1,3                                                                                                                                                                  
                                 do i = 1,3                                                                                                                                                              
                                     do j = 1,5                                                                                                                                                          
                                                                                                                                                                                                         
                                         Call GetIndex_mQd(i,j,k)                                                                                                                                        
                                                                                                                                                                                                         
                                         if (DABS(m(h))>eps .and. DABS(m(g))>eps .and.  DABS(alpha_mQ(k))>eps ) Then                                                                                     
                                                 ! Call TQdm(Ar,Br,C ,j,h,ind,t_jh)                                                                                                                      
                                                 ! Call Tmm (Ar,Br,C ,i,g,ind,t_ig)                                                                                                                      
                                                 ! result = result + (m(g)*m(h))*alpha_mQ(k)*t_ig*t_jh                                                                                                   
                                                                                                                                                                                                         
                                                 call Get_Comp(g,cp_g)                                                                                                                                   
                                                 call Get_Comp(h,cp_h)                                                                                                                                   
                                                 call Get_Comp(i,cp_i)                                                                                                                                   
                                                 call Get_Comp(j,cp_j)                                                                                                                                   
                                                                                                                                                                                                         
                                                 Call T_lk(Ar,Br,C,2,Floor((j*1d0)/2d0),cp_j,1,Floor((h*1d0)/2d0),cp_h,r1)                                                                               
                                                                                                                                                                                                         
                                                 Call T_lk(Ar,Br,C,1,Floor((i*1d0)/2d0),cp_i,1,Floor((g*1d0)/2d0),cp_g,r2)                                                                               
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                 result = result + (m(g)*m(h))*alpha_mQ(k)*r1*r2                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                         end if                                                                                                                                                          
                                     end do                                                                                                                                                              
                                 end do                                                                                                                                                                  
                             end do                                                                                                                                                                      
                         end do                                                                                                                                                                          
                                                                                                                                                                                                         
                     else                                                                                                                                                                                
                         m           =  A_Multipoles(2:4)                                                                                                                                                
                         alpha_mQ    =  B_Pol(7:21)                                                                                                                                                      
                                                                                                                                                                                                         
                         do g = 1,3                                                                                                                                                                      
                             do h = 1,3                                                                                                                                                                  
                                 do i = 1,3                                                                                                                                                              
                                     do j = 1,5                                                                                                                                                          
                                                                                                                                                                                                         
                                         Call GetIndex_mQd(i,j,k)                                                                                                                                        
                                                                                                                                                                                                         
                                         if (DABS(m(h))>eps .and. DABS(m(g))>eps .and.  DABS(alpha_mQ(k))>eps ) Then                                                                                     
                                                 ! Call TQdm(Ar,Br,C ,j,h,ind,t_jh)                                                                                                                      
                                                 ! Call Tmm (Ar,Br,C ,i,g,ind,t_ig)                                                                                                                      
                                                 ! result = result + (m(g)*m(h))*alpha_mQ(k)*t_ig*t_jh                                                                                                   
                                                                                                                                                                                                         
                                                 call Get_Comp(g,cp_g)                                                                                                                                   
                                                 call Get_Comp(h,cp_h)                                                                                                                                   
                                                 call Get_Comp(i,cp_i)                                                                                                                                   
                                                 call Get_Comp(j,cp_j)                                                                                                                                   
                                                                                                                                                                                                         
                                                 Call T_lk(Ar,Br,C,1,Floor((h*1d0)/2d0),cp_h,2,Floor((j*1d0)/2d0),cp_j,r1)                                                                               
                                                                                                                                                                                                         
                                                 Call T_lk(Ar,Br,C,1,Floor((g*1d0)/2d0),cp_g,1,Floor((i*1d0)/2d0),cp_i,r2)                                                                               
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                 result = result + (m(g)*m(h))*alpha_mQ(k)*r1*r2                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                         end if                                                                                                                                                          
                                     end do                                                                                                                                                              
                                 end do                                                                                                                                                                  
                             end do                                                                                                                                                                      
                         end do                                                                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                     end if                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                     RETURN                                                                                                                                                                              
 END SUBROUTINE mm_mQd                                                                                                                                                                                   
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE qQd_mQd(Ar,Br,C ,A_Multipoles,B_Multipoles ,A_Pol,B_Pol, ind , result)                                                                                                                       
         IMPLICIT NONE                                                                                                                                                                                   
                                                                                                                                                                                                         
         INTEGER ::  i,j,k,h                                                                                                                                                                             
         real*8, INTENT(INOUT) ::result                                                                                                                                                                  
         real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                
         real*8 , dimension(57) , INTENT(IN) :: A_Pol,B_Pol                                                                                                                                              
         real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                          
         real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                          
         real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                           
         Integer, INTENT(IN):: ind                                                                                                                                                                       
         real*8 :: q,r1,r2                                                                                                                                                                               
         real*8 , dimension(5):: Qd                                                                                                                                                                      
         real*8 , dimension(15):: alpha_mQ                                                                                                                                                               
         real*8:: eps=EPSILON(result)                                                                                                                                                                    
                                                                                                                                                                                                         
         Character :: cp_h,cp_i,cp_j                                                                                                                                                                     
                                                                                                                                                                                                         
         result = 0d0                                                                                                                                                                                    
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         if (ind==0) then                                                                                                                                                                                
             q  =  B_Multipoles(1)                                                                                                                                                                       
             Qd =  B_Multipoles(5:9)                                                                                                                                                                     
             alpha_mQ  = A_Pol(7:21)                                                                                                                                                                     
                                                                                                                                                                                                         
             do h = 1,5                                                                                                                                                                                  
                 do i = 1,3                                                                                                                                                                              
                     do j = 1,5                                                                                                                                                                          
                                                                                                                                                                                                         
                         Call GetIndex_mQd(i,j,k)                                                                                                                                                        
                                                                                                                                                                                                         
                         if (DABS(q)>eps .and. DABS(Qd(h))>eps .and.  DABS(alpha_mQ(k))>eps ) Then                                                                                                       
                                 ! Call TQdQd(Ar,Br,C ,j,h,ind,t_jh)                                                                                                                                     
                                 ! Call Tmq (Ar,Br,C ,i,ind,t_i)                                                                                                                                         
                                 ! result = result + (q*Qd(h))*alpha_mQ(k)*t_i*t_jh                                                                                                                      
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             call Get_Comp(h,cp_h)                                                                                                                                                       
                             call Get_Comp(i,cp_i)                                                                                                                                                       
                             call Get_Comp(j,cp_j)                                                                                                                                                       
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,1,Floor((i*1d0)/2d0),cp_i,2,Floor((h*1d0)/2d0),cp_h,r1)                                                                                                   
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,2,Floor((j*1d0)/2d0),cp_j,0,0,"0",r2)                                                                                                                     
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             result = result + (q*Qd(h))*alpha_mQ(k)*r1*r2                                                                                                                               
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         end if                                                                                                                                                                          
                     end do                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         else                                                                                                                                                                                            
             q           =  A_Multipoles(1)                                                                                                                                                              
             Qd           =  A_Multipoles(5:9)                                                                                                                                                           
             alpha_mQ    =  B_Pol(7:21)                                                                                                                                                                  
                                                                                                                                                                                                         
                                                                                                                                                                                                         
             do h = 1,5                                                                                                                                                                                  
                 do i = 1,3                                                                                                                                                                              
                     do j = 1,5                                                                                                                                                                          
                                                                                                                                                                                                         
                         Call GetIndex_mQd(i,j,k)                                                                                                                                                        
                                                                                                                                                                                                         
                         if (DABS(q)>eps .and. DABS(Qd(h))>eps .and.  DABS(alpha_mQ(k))>eps ) Then                                                                                                       
                                                                                                                                                                                                         
                             call Get_Comp(h,cp_h)                                                                                                                                                       
                             call Get_Comp(i,cp_i)                                                                                                                                                       
                             call Get_Comp(j,cp_j)                                                                                                                                                       
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,2,Floor((h*1d0)/2d0),cp_h,1,Floor((i*1d0)/2d0),cp_i,r1)                                                                                                   
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,0,0,"0",2,Floor((j*1d0)/2d0),cp_j,r2)                                                                                                                     
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             result = result + (q*Qd(h))*alpha_mQ(k)*r1*r2                                                                                                                               
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         end if                                                                                                                                                                          
                     end do                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
                                                                                                                                                                                                         
         end if                                                                                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         RETURN                                                                                                                                                                                          
 END SUBROUTINE qQd_mQd                                                                                                                                                                                  
                                                                                                                                                                                                         
 SUBROUTINE qQd_Qdm(Ar,Br,C ,A_Multipoles,B_Multipoles ,A_Pol,B_Pol, ind , result)                                                                                                                       
         IMPLICIT NONE                                                                                                                                                                                   
                                                                                                                                                                                                         
         INTEGER ::  i,j,k,h                                                                                                                                                                             
         real*8, INTENT(INOUT) ::result                                                                                                                                                                  
         real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                
         real*8 , dimension(57) , INTENT(IN) :: A_Pol,B_Pol                                                                                                                                              
         real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                          
         real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                          
         real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                           
         Integer, INTENT(IN):: ind                                                                                                                                                                       
         real*8 :: q,r1,r2                                                                                                                                                                               
         real*8 , dimension(5):: Qd                                                                                                                                                                      
         real*8 , dimension(15):: alpha_mQ                                                                                                                                                               
         real*8:: eps=EPSILON(result)                                                                                                                                                                    
                                                                                                                                                                                                         
         Character :: cp_h,cp_i,cp_j                                                                                                                                                                     
                                                                                                                                                                                                         
         result = 0d0                                                                                                                                                                                    
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         if (ind==0) then                                                                                                                                                                                
             q =  B_Multipoles(1)                                                                                                                                                                        
             Qd =  B_Multipoles(5:9)                                                                                                                                                                     
             alpha_mQ  = A_Pol(7:21)                                                                                                                                                                     
                                                                                                                                                                                                         
             do h = 1,5                                                                                                                                                                                  
                 do i = 1,3                                                                                                                                                                              
                     do j = 1,5                                                                                                                                                                          
                                                                                                                                                                                                         
                         Call GetIndex_mQd(i,j,k)                                                                                                                                                        
                                                                                                                                                                                                         
                         if (DABS(q)>eps .and. DABS(Qd(h))>eps .and.  DABS(alpha_mQ(k))>eps ) Then                                                                                                       
                                 ! Call TQdq(Ar,Br,C ,j,ind,t_jh)                                                                                                                                        
                                 ! Call TQdm (Ar,Br,C ,h,i,mod(ind+1,2),t_i)                                                                                                                             
                                 ! result = result + (q*Qd(h))*alpha_mQ(k)*t_i*t_jh                                                                                                                      
                                                                                                                                                                                                         
                                 call Get_Comp(h,cp_h)                                                                                                                                                   
                                 call Get_Comp(i,cp_i)                                                                                                                                                   
                                 call Get_Comp(j,cp_j)                                                                                                                                                   
                                                                                                                                                                                                         
                                 Call T_lk(Ar,Br,C,1,Floor((i*1d0)/2d0),cp_i,0,0,"0",r1)                                                                                                                 
                                                                                                                                                                                                         
                                 Call T_lk(Ar,Br,C,2,Floor((j*1d0)/2d0),cp_j,2,Floor((h*1d0)/2d0),cp_h,r2)                                                                                               
                                                                                                                                                                                                         
                                 result = result + (q*Qd(h))*alpha_mQ(k)*r1*r2                                                                                                                           
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         end if                                                                                                                                                                          
                     end do                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
                                                                                                                                                                                                         
         else                                                                                                                                                                                            
             q           =  A_Multipoles(1)                                                                                                                                                              
             Qd          =  A_Multipoles(5:9)                                                                                                                                                            
             alpha_mQ    =  B_Pol(7:21)                                                                                                                                                                  
                                                                                                                                                                                                         
             do h = 1,5                                                                                                                                                                                  
                 do i = 1,3                                                                                                                                                                              
                     do j = 1,5                                                                                                                                                                          
                                                                                                                                                                                                         
                         Call GetIndex_mQd(i,j,k)                                                                                                                                                        
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         if (DABS(q)>eps .and. DABS(Qd(h))>eps .and.  DABS(alpha_mQ(k))>eps ) Then                                                                                                       
                                 ! Call TQdq(Ar,Br,C ,j,ind,t_jh)                                                                                                                                        
                                 ! Call TQdm (Ar,Br,C ,h,i,mod(ind+1,2),t_i)                                                                                                                             
                                 ! result = result + (q*Qd(h))*alpha_mQ(k)*t_i*t_jh                                                                                                                      
                                                                                                                                                                                                         
                                 call Get_Comp(h,cp_h)                                                                                                                                                   
                                 call Get_Comp(i,cp_i)                                                                                                                                                   
                                 call Get_Comp(j,cp_j)                                                                                                                                                   
                                                                                                                                                                                                         
                                 Call T_lk(Ar,Br,C,0,0,"0",1,Floor((i*1d0)/2d0),cp_i,r1)                                                                                                                 
                                                                                                                                                                                                         
                                 Call T_lk(Ar,Br,C,2,Floor((h*1d0)/2d0),cp_h,2,Floor((j*1d0)/2d0),cp_j,r2)                                                                                               
                                                                                                                                                                                                         
                                 result = result + (q*Qd(h))*alpha_mQ(k)*r1*r2                                                                                                                           
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         end if                                                                                                                                                                          
                     end do                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         end if                                                                                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         RETURN                                                                                                                                                                                          
 END SUBROUTINE qQd_Qdm                                                                                                                                                                                  
                                                                                                                                                                                                         
 SUBROUTINE qm_QdQd(Ar,Br,C ,A_Multipoles,B_Multipoles ,A_Pol,B_Pol, ind , result)                                                                                                                       
         IMPLICIT NONE                                                                                                                                                                                   
                                                                                                                                                                                                         
         INTEGER ::  i,j,k,h                                                                                                                                                                             
         real*8, INTENT(INOUT) ::result                                                                                                                                                                  
         real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                
         real*8 , dimension(57) , INTENT(IN) :: A_Pol,B_Pol                                                                                                                                              
         real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                          
         real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                          
         real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                           
         Integer, INTENT(IN):: ind                                                                                                                                                                       
         real*8 :: q,r1,r2                                                                                                                                                                               
         real*8 , dimension(3):: m                                                                                                                                                                       
         real*8 , dimension(15):: alpha_QdQd                                                                                                                                                             
         real*8:: eps=EPSILON(result)                                                                                                                                                                    
                                                                                                                                                                                                         
         Character :: cp_h,cp_i,cp_j                                                                                                                                                                     
                                                                                                                                                                                                         
         result = 0d0                                                                                                                                                                                    
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         if (ind==0) then                                                                                                                                                                                
             q =  B_Multipoles(1)                                                                                                                                                                        
             m =  B_Multipoles(2:4)                                                                                                                                                                      
             alpha_QdQd  = A_Pol(22:36)                                                                                                                                                                  
                                                                                                                                                                                                         
             do h=1,3                                                                                                                                                                                    
                 do i = 1,5                                                                                                                                                                              
                     do j = 1,5                                                                                                                                                                          
                                                                                                                                                                                                         
                         Call GetIndex_QdQd(i,j,k)                                                                                                                                                       
                                                                                                                                                                                                         
                         if ( DABS(q)>eps .and. DABS(m(h))>eps .and.  DABS(alpha_QdQd(k))>eps ) Then                                                                                                     
                                 ! Call TQdq(Ar,Br,C ,j,ind,t_j)                                                                                                                                         
                                 ! Call TQdm (Ar,Br,C ,i,h,ind,t_ih)                                                                                                                                     
                                 ! result = result + (q*m(h))*alpha_QdQd(k)*t_ih*t_j                                                                                                                     
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                 call Get_Comp(h,cp_h)                                                                                                                                                   
                                 call Get_Comp(i,cp_i)                                                                                                                                                   
                                 call Get_Comp(j,cp_j)                                                                                                                                                   
                                                                                                                                                                                                         
                                 Call T_lk(Ar,Br,C,2,Floor((j*1d0)/2d0),cp_j,0,0,"0",r1)                                                                                                                 
                                                                                                                                                                                                         
                                 Call T_lk(Ar,Br,C,2,Floor((i*1d0)/2d0),cp_i,1,Floor((h*1d0)/2d0),cp_h,r2)                                                                                               
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                 result = result + (q*m(h))*alpha_QdQd(k)*r1*r2                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         end if                                                                                                                                                                          
                     end do                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
                                                                                                                                                                                                         
         else                                                                                                                                                                                            
             q            =  A_Multipoles(1)                                                                                                                                                             
             m            =  A_Multipoles(2:4)                                                                                                                                                           
             alpha_QdQd   =  B_Pol(22:36)                                                                                                                                                                
                                                                                                                                                                                                         
             do h=1,3                                                                                                                                                                                    
                 do i = 1,5                                                                                                                                                                              
                     do j = 1,5                                                                                                                                                                          
                                                                                                                                                                                                         
                         Call GetIndex_QdQd(i,j,k)                                                                                                                                                       
                                                                                                                                                                                                         
                         if ( DABS(q)>eps .and. DABS(m(h))>eps .and.  DABS(alpha_QdQd(k))>eps ) Then                                                                                                     
                                 ! Call TQdq(Ar,Br,C ,j,ind,t_j)                                                                                                                                         
                                 ! Call TQdm (Ar,Br,C ,i,h,ind,t_ih)                                                                                                                                     
                                 ! result = result + (q*m(h))*alpha_QdQd(k)*t_ih*t_j                                                                                                                     
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                 call Get_Comp(h,cp_h)                                                                                                                                                   
                                 call Get_Comp(i,cp_i)                                                                                                                                                   
                                 call Get_Comp(j,cp_j)                                                                                                                                                   
                                                                                                                                                                                                         
                                 Call T_lk(Ar,Br,C,0,0,"0",2,Floor((j*1d0)/2d0),cp_j,r1)                                                                                                                 
                                                                                                                                                                                                         
                                 Call T_lk(Ar,Br,C,1,Floor((h*1d0)/2d0),cp_h,2,Floor((i*1d0)/2d0),cp_i,r2)                                                                                               
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                 result = result + (q*m(h))*alpha_QdQd(k)*r1*r2                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         end if                                                                                                                                                                          
                     end do                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         end if                                                                                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         RETURN                                                                                                                                                                                          
 END SUBROUTINE qm_QdQd                                                                                                                                                                                  
                                                                                                                                                                                                         
 SUBROUTINE qm_mO(Ar,Br,C ,A_Multipoles,B_Multipoles ,A_Pol,B_Pol, ind , result)                                                                                                                         
         IMPLICIT NONE                                                                                                                                                                                   
                                                                                                                                                                                                         
         INTEGER ::  i,j,k,h                                                                                                                                                                             
         real*8, INTENT(INOUT) ::result                                                                                                                                                                  
         real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                
         real*8 , dimension(57) , INTENT(IN) :: A_Pol,B_Pol                                                                                                                                              
         real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                          
         real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                          
         real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                           
         Integer, INTENT(IN):: ind                                                                                                                                                                       
         real*8 :: q,r1,r2                                                                                                                                                                               
         real*8 , dimension(3):: m                                                                                                                                                                       
         real*8 , dimension(21):: alpha_mO                                                                                                                                                               
         real*8:: eps=EPSILON(result)                                                                                                                                                                    
                                                                                                                                                                                                         
         Character :: cp_h,cp_i,cp_j                                                                                                                                                                     
                                                                                                                                                                                                         
         result = 0d0                                                                                                                                                                                    
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         if (ind==0) then                                                                                                                                                                                
             q =  B_Multipoles(1)                                                                                                                                                                        
             m =  B_Multipoles(2:4)                                                                                                                                                                      
             alpha_mO  = A_Pol(37:57)                                                                                                                                                                    
                                                                                                                                                                                                         
             do h = 1,3                                                                                                                                                                                  
                 do i = 1,3                                                                                                                                                                              
                     do j = 1,7                                                                                                                                                                          
                                                                                                                                                                                                         
                         Call GetIndex_mO(i,j,k)                                                                                                                                                         
                                                                                                                                                                                                         
                         if ( DABS(m(h))>eps .and.DABS(q)>eps .and.  DABS(alpha_mO(k))>eps ) Then                                                                                                        
                                 ! Call TOm(Ar,Br,C ,j,h,ind,t_jh)                                                                                                                                       
                                 ! Call Tmq (Ar,Br,C ,i,ind,t_i)                                                                                                                                         
                                 ! result = result + (q*m(h))*alpha_mO(k)*t_i*t_jh                                                                                                                       
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                 call Get_Comp(h,cp_h)                                                                                                                                                   
                                 call Get_Comp(i,cp_i)                                                                                                                                                   
                                 call Get_Comp(j,cp_j)                                                                                                                                                   
                                                                                                                                                                                                         
                                 Call T_lk(Ar,Br,C,3,Floor((j*1d0)/2d0),cp_j,1,Floor((h*1d0)/2d0),cp_h,r1)                                                                                               
                                                                                                                                                                                                         
                                 Call T_lk(Ar,Br,C,1,Floor((i*1d0)/2d0),cp_i,0,0,"0",r2)                                                                                                                 
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                 result = result + (q*m(h))*alpha_mO(k)*r1*r2                                                                                                                            
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         end if                                                                                                                                                                          
                     end do                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
                                                                                                                                                                                                         
         else                                                                                                                                                                                            
             q           =  A_Multipoles(1)                                                                                                                                                              
             m           =  A_Multipoles(2:4)                                                                                                                                                            
             alpha_mO    =  B_Pol(37:57)                                                                                                                                                                 
                                                                                                                                                                                                         
                                                                                                                                                                                                         
             do h = 1,3                                                                                                                                                                                  
                 do i = 1,3                                                                                                                                                                              
                     do j = 1,7                                                                                                                                                                          
                                                                                                                                                                                                         
                         Call GetIndex_mO(i,j,k)                                                                                                                                                         
                                                                                                                                                                                                         
                         if ( DABS(m(h))>eps .and.DABS(q)>eps .and.  DABS(alpha_mO(k))>eps ) Then                                                                                                        
                                 ! Call TOm(Ar,Br,C ,j,h,ind,t_jh)                                                                                                                                       
                                 ! Call Tmq (Ar,Br,C ,i,ind,t_i)                                                                                                                                         
                                 ! result = result + (q*m(h))*alpha_mO(k)*t_i*t_jh                                                                                                                       
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                 call Get_Comp(h,cp_h)                                                                                                                                                   
                                 call Get_Comp(i,cp_i)                                                                                                                                                   
                                 call Get_Comp(j,cp_j)                                                                                                                                                   
                                                                                                                                                                                                         
                                 Call T_lk(Ar,Br,C,1,Floor((h*1d0)/2d0),cp_h,3,Floor((j*1d0)/2d0),cp_j,r1)                                                                                               
                                                                                                                                                                                                         
                                 Call T_lk(Ar,Br,C,0,0,"0",1,Floor((i*1d0)/2d0),cp_i,r2)                                                                                                                 
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                 result = result + (q*m(h))*alpha_mO(k)*r1*r2                                                                                                                            
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         end if                                                                                                                                                                          
                     end do                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
                                                                                                                                                                                                         
         end if                                                                                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         RETURN                                                                                                                                                                                          
 END SUBROUTINE qm_mO                                                                                                                                                                                    
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE qm_Om(Ar,Br,C ,A_Multipoles,B_Multipoles ,A_Pol,B_Pol, ind , result)                                                                                                                         
             IMPLICIT NONE                                                                                                                                                                               
                                                                                                                                                                                                         
             INTEGER ::  i,j,k,h                                                                                                                                                                         
             real*8, INTENT(INOUT) ::result                                                                                                                                                              
             real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                            
             real*8 , dimension(57) , INTENT(IN) :: A_Pol,B_Pol                                                                                                                                          
             real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                      
             real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                      
             real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                       
             Integer, INTENT(IN):: ind                                                                                                                                                                   
             real*8 :: q,r1,r2                                                                                                                                                                           
             real*8 , dimension(3):: m                                                                                                                                                                   
             real*8 , dimension(21):: alpha_mO                                                                                                                                                           
             real*8:: eps=EPSILON(result)                                                                                                                                                                
                                                                                                                                                                                                         
             Character :: cp_h,cp_i,cp_j                                                                                                                                                                 
                                                                                                                                                                                                         
             result = 0d0                                                                                                                                                                                
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
             if (ind==0) then                                                                                                                                                                            
                 q =  B_Multipoles(1)                                                                                                                                                                    
                 m =  B_Multipoles(2:4)                                                                                                                                                                  
                 alpha_mO  = A_Pol(37:57)                                                                                                                                                                
                                                                                                                                                                                                         
                 do h = 1,3                                                                                                                                                                              
                     do i = 1,3                                                                                                                                                                          
                         do j = 1,7                                                                                                                                                                      
                                                                                                                                                                                                         
                             Call GetIndex_mO(i,j,k)                                                                                                                                                     
                                                                                                                                                                                                         
                             if ( DABS(m(h))>eps .and.DABS(q)>eps .and.  DABS(alpha_mO(k))>eps ) Then                                                                                                    
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                 call Get_Comp(h,cp_h)                                                                                                                                                   
                                 call Get_Comp(i,cp_i)                                                                                                                                                   
                                 call Get_Comp(j,cp_j)                                                                                                                                                   
                                                                                                                                                                                                         
                                 Call T_lk(Ar,Br,C,3,Floor((j*1d0)/2d0),cp_j,0,0,"0",r1)                                                                                                                 
                                                                                                                                                                                                         
                                 Call T_lk(Ar,Br,C,1,Floor((i*1d0)/2d0),cp_i,1,Floor((h*1d0)/2d0),cp_h,r2)                                                                                               
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                 result = result + (q*m(h))*alpha_mO(k)*r1*r2                                                                                                                            
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             end if                                                                                                                                                                      
                         end do                                                                                                                                                                          
                     end do                                                                                                                                                                              
                 end do                                                                                                                                                                                  
                                                                                                                                                                                                         
             else                                                                                                                                                                                        
                 q           =  A_Multipoles(1)                                                                                                                                                          
                 m           =  A_Multipoles(2:4)                                                                                                                                                        
                 alpha_mO    =  B_Pol(37:57)                                                                                                                                                             
                                                                                                                                                                                                         
                 do h = 1,3                                                                                                                                                                              
                     do i = 1,3                                                                                                                                                                          
                         do j = 1,7                                                                                                                                                                      
                                                                                                                                                                                                         
                             Call GetIndex_mO(i,j,k)                                                                                                                                                     
                                                                                                                                                                                                         
                             if ( DABS(m(h))>eps .and.DABS(q)>eps .and.  DABS(alpha_mO(k))>eps ) Then                                                                                                    
                                     ! Call TOq(Ar,Br,C ,j,ind,t_j)                                                                                                                                      
                                     ! Call Tmm (Ar,Br,C ,i,h,ind,t_ih)                                                                                                                                  
                                     ! result = result + (q*m(h))*alpha_mO(k)*t_ih*t_j                                                                                                                   
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                 call Get_Comp(h,cp_h)                                                                                                                                                   
                                 call Get_Comp(i,cp_i)                                                                                                                                                   
                                 call Get_Comp(j,cp_j)                                                                                                                                                   
                                                                                                                                                                                                         
                                 Call T_lk(Ar,Br,C,0,0,"0",3,Floor((j*1d0)/2d0),cp_j,r1)                                                                                                                 
                                                                                                                                                                                                         
                                 Call T_lk(Ar,Br,C,1,Floor((h*1d0)/2d0),cp_h,1,Floor((i*1d0)/2d0),cp_i,r2)                                                                                               
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                 result = result + (q*m(h))*alpha_mO(k)*r1*r2                                                                                                                            
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             end if                                                                                                                                                                      
                         end do                                                                                                                                                                          
                     end do                                                                                                                                                                              
                 end do                                                                                                                                                                                  
                                                                                                                                                                                                         
             end if                                                                                                                                                                                      
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
             RETURN                                                                                                                                                                                      
 END SUBROUTINE qm_Om                                                                                                                                                                                    
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     !********************************************************                                                                                                                                           
 SUBROUTINE Induction_8_Sph2(cal_coord,Ar,Br,C ,A_Multipoles,B_Multipoles ,A_Pol,B_Pol, Ind_8_Energy)                                                                                                    
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     !   NEED TO DECLARE ALL THE SUBROUTINE ARGUMENTS and                                                                                                                                                
     !   ANY OTHER VARIABLES LOCAL TO THE SUBROUTINE                                                                                                                                                     
                                                                                                                                                                                                         
     real*8, INTENT(INOUT)  :: Ind_8_Energy                                                                                                                                                              
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 , dimension(57) , INTENT(IN) :: A_Pol,B_Pol                                                                                                                                                  
     real*8 :: R                                                                                                                                                                                         
     real*8 , dimension(11), INTENT(IN):: cal_coord                                                                                                                                                      
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
                                                                                                                                                                                                         
     real*8 :: qPhi_mm_0,qPhi_mm_1,mO_mm_0,mO_mm_1,QdQd_mm_0,QdQd_mm_1,qQd_QdQd_0,qQd_QdQd_1                                                                                                             
     real*8 :: mm_QdQd_0, mm_QdQd_1,mQd_mQd_0,mQd_mQd_1,mQd_Qdm_0,mQd_Qdm_1,qO_Qdm_0,qO_Qdm_1                                                                                                            
     real*8 :: qO_mQd_0,qO_mQd_1,qQd_mO_0,qQd_mO_1,qQd_Om_0,qQd_Om_1,mm_Om_0,mm_Om_1                                                                                                                     
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     R =cal_coord(1)                                                                                                                                                                                     
                                                                                                                                                                                                         
     Call qPhi_mm(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,0,qPhi_mm_0)                                                                                                                            
     Call qPhi_mm(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,1,qPhi_mm_1)                                                                                                                            
                                                                                                                                                                                                         
     Call mO_mm(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,0,mO_mm_0)                                                                                                                                
     Call mO_mm(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,1,mO_mm_1)                                                                                                                                
                                                                                                                                                                                                         
     Call QdQd_mm(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,0,QdQd_mm_0)                                                                                                                            
     Call QdQd_mm(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,1,QdQd_mm_1)                                                                                                                            
                                                                                                                                                                                                         
     Call qQd_QdQd(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,0,qQd_QdQd_0)                                                                                                                          
     Call qQd_QdQd(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,1,qQd_QdQd_1)                                                                                                                          
                                                                                                                                                                                                         
     Call mm_QdQd(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,0,mm_QdQd_0)                                                                                                                            
     Call mm_QdQd(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,1,mm_QdQd_1)                                                                                                                            
                                                                                                                                                                                                         
     Call mQd_mQd(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,0,mQd_mQd_0)                                                                                                                            
     Call mQd_mQd(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,1,mQd_mQd_1)                                                                                                                            
                                                                                                                                                                                                         
     Call mQd_Qdm(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,0,mQd_Qdm_0)                                                                                                                            
     Call mQd_Qdm(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,1,mQd_Qdm_1)                                                                                                                            
                                                                                                                                                                                                         
     Call qO_Qdm(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,0,qO_Qdm_0)                                                                                                                              
     Call qO_Qdm(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,1,qO_Qdm_1)                                                                                                                              
                                                                                                                                                                                                         
     Call qO_mQd(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,0,qO_mQd_0)                                                                                                                              
     Call qO_mQd(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,1,qO_mQd_1)                                                                                                                              
                                                                                                                                                                                                         
     Call qQd_Om(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,0,qQd_Om_0)                                                                                                                              
     Call qQd_Om(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,1,qQd_Om_1)                                                                                                                              
                                                                                                                                                                                                         
     Call qQd_mO(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,0,qQd_mO_0)                                                                                                                              
     Call qQd_mO(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,1,qQd_mO_1)                                                                                                                              
                                                                                                                                                                                                         
     Call mm_Om(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,0,mm_Om_0)                                                                                                                                
     Call mm_Om(Ar,Br,C ,A_Multipoles,B_Multipoles,A_Pol,B_Pol,1,mm_Om_1)                                                                                                                                
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     Ind_8_Energy =   (-0.5d0)*( 2.0d0*qPhi_mm_0 + 2.0d0*qPhi_mm_1 +2.0d0*mO_mm_0 + 2.0d0*mO_mm_1  &                                                                                                     
                                 +QdQd_mm_0 + QdQd_mm_1 +2.0d0*qQd_QdQd_0 + 2.0d0*qQd_QdQd_1 &                                                                                                           
                                 +mm_QdQd_0 + mm_QdQd_1 +2.0d0*mQd_mQd_0 +2.0d0*mQd_mQd_1 &                                                                                                              
                                 +2.0d0*mQd_Qdm_0 +2.0d0*mQd_Qdm_1 +2.0d0*qO_Qdm_0 +2.0d0*qO_Qdm_1 &                                                                                                     
                                 +2.0d0*qO_mQd_0 +2.0d0*qO_mQd_1 +2.0d0*qQd_mO_0 +2.0d0*qQd_mO_1 &                                                                                                       
                                 +2.0d0*qQd_Om_0 +2.0d0*qQd_Om_1 +2.0d0*mm_Om_0 +2.0d0*mm_Om_1 &                                                                                                         
                                 )/ R**8                                                                                                                                                                 
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE Induction_8_Sph2                                                                                                                                                                         
     !********************************************************                                                                                                                                           
                                                                                                                                                                                                         
 SUBROUTINE qPhi_mm(Ar,Br,C ,A_Multipoles,B_Multipoles ,A_Pol,B_Pol, ind , result)                                                                                                                       
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     INTEGER ::  i,j,k,h                                                                                                                                                                                 
     real*8, INTENT(INOUT) ::result                                                                                                                                                                      
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 , dimension(57) , INTENT(IN) :: A_Pol,B_Pol                                                                                                                                                  
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     Integer, INTENT(IN):: ind                                                                                                                                                                           
     real*8 :: q,r1,r2                                                                                                                                                                                   
     real*8 , dimension(9):: Phi                                                                                                                                                                         
     real*8 , dimension(6):: alpha                                                                                                                                                                       
     real*8:: eps=EPSILON(result)                                                                                                                                                                        
     Character :: cp_h,cp_i,cp_j                                                                                                                                                                         
                                                                                                                                                                                                         
     result = 0d0                                                                                                                                                                                        
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     if (ind==0) then                                                                                                                                                                                    
         q =  B_Multipoles(1)                                                                                                                                                                            
         Phi =  B_Multipoles(17:25)                                                                                                                                                                      
         alpha  = A_Pol(1:6)                                                                                                                                                                             
                                                                                                                                                                                                         
         do h=1,9                                                                                                                                                                                        
             do i = 1,3                                                                                                                                                                                  
                 do j = 1,3                                                                                                                                                                              
                                                                                                                                                                                                         
                     Call GetIndex_mm(i,j,k)                                                                                                                                                             
                                                                                                                                                                                                         
                     if (DABS(q)>eps .and.  DABS(alpha(k))>eps .and. DABS(Phi(h))>eps) Then                                                                                                              
                             ! Call TPhim(Ar,Br,C ,h,j,mod(ind+1,2),t_jh)                                                                                                                                
                             ! Call Tmq(Ar,Br,C ,i,ind,t_i)                                                                                                                                              
                             ! result = result + (q*Phi(h))*alpha(k)*t_i*t_jh                                                                                                                            
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             call Get_Comp(h,cp_h)                                                                                                                                                       
                             call Get_Comp(i,cp_i)                                                                                                                                                       
                             call Get_Comp(j,cp_j)                                                                                                                                                       
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,1,Floor((j*1d0)/2d0),cp_j,4,Floor((h*1d0)/2d0),cp_h,r1)                                                                                                   
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,1,Floor((i*1d0)/2d0),cp_i,0,0,"0",r2)                                                                                                                     
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             result = result + (q*Phi(h))*alpha(k)*r1*r2                                                                                                                                 
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                     end if                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     else                                                                                                                                                                                                
         q       =  A_Multipoles(1)                                                                                                                                                                      
         Phi     =  A_Multipoles(17:25)                                                                                                                                                                  
         alpha   =  B_Pol(1:6)                                                                                                                                                                           
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         do h=1,9                                                                                                                                                                                        
             do i = 1,3                                                                                                                                                                                  
                 do j = 1,3                                                                                                                                                                              
                                                                                                                                                                                                         
                     Call GetIndex_mm(i,j,k)                                                                                                                                                             
                                                                                                                                                                                                         
                     if (DABS(q)>eps .and.  DABS(alpha(k))>eps .and. DABS(Phi(h))>eps) Then                                                                                                              
                             ! Call TPhim(Ar,Br,C ,h,j,mod(ind+1,2),t_jh)                                                                                                                                
                             ! Call Tmq(Ar,Br,C ,i,ind,t_i)                                                                                                                                              
                             ! result = result + (q*Phi(h))*alpha(k)*t_i*t_jh                                                                                                                            
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             call Get_Comp(h,cp_h)                                                                                                                                                       
                             call Get_Comp(i,cp_i)                                                                                                                                                       
                             call Get_Comp(j,cp_j)                                                                                                                                                       
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,4,Floor((h*1d0)/2d0),cp_h,1,Floor((j*1d0)/2d0),cp_j,r1)                                                                                                   
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,0,0,"0",1,Floor((i*1d0)/2d0),cp_i,r2)                                                                                                                     
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             result = result + (q*Phi(h))*alpha(k)*r1*r2                                                                                                                                 
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                     end if                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     end if                                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE qPhi_mm                                                                                                                                                                                  
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE mO_mm(Ar,Br,C ,A_Multipoles,B_Multipoles ,A_Pol,B_Pol, ind , result)                                                                                                                         
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     INTEGER ::  i,j,k,h,g                                                                                                                                                                               
     real*8, INTENT(INOUT) ::result                                                                                                                                                                      
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 , dimension(57) , INTENT(IN) :: A_Pol,B_Pol                                                                                                                                                  
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     Integer, INTENT(IN):: ind                                                                                                                                                                           
     real*8 :: r1,r2                                                                                                                                                                                     
     real*8 , dimension(3):: m                                                                                                                                                                           
     real*8 , dimension(7):: O                                                                                                                                                                           
     real*8 , dimension(6):: alpha                                                                                                                                                                       
     real*8:: eps=EPSILON(result)                                                                                                                                                                        
                                                                                                                                                                                                         
     Character :: cp_h,cp_i,cp_j,cp_g                                                                                                                                                                    
                                                                                                                                                                                                         
     result = 0d0                                                                                                                                                                                        
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     if (ind==0) then                                                                                                                                                                                    
         m =    B_Multipoles(2:4)                                                                                                                                                                        
         O =    B_Multipoles(10:16)                                                                                                                                                                      
         alpha  = A_Pol(1:6)                                                                                                                                                                             
                                                                                                                                                                                                         
         do g=1,3                                                                                                                                                                                        
             do h=1,7                                                                                                                                                                                    
                 do i = 1,3                                                                                                                                                                              
                     do j = 1,3                                                                                                                                                                          
                                                                                                                                                                                                         
                         Call GetIndex_mm(i,j,k)                                                                                                                                                         
                                                                                                                                                                                                         
                         if (DABS(m(g))>eps .and.  DABS(alpha(k))>eps .and. DABS(O(h))>eps) Then                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                 call Get_Comp(g,cp_g)                                                                                                                                                   
                                 call Get_Comp(h,cp_h)                                                                                                                                                   
                                 call Get_Comp(i,cp_i)                                                                                                                                                   
                                 call Get_Comp(j,cp_j)                                                                                                                                                   
                                                                                                                                                                                                         
                                 Call T_lk(Ar,Br,C,1,Floor((j*1d0)/2d0),cp_j,3,Floor((h*1d0)/2d0),cp_h,r1)                                                                                               
                                                                                                                                                                                                         
                                 Call T_lk(Ar,Br,C,1,Floor((i*1d0)/2d0),cp_i,1,Floor((g*1d0)/2d0),cp_g,r2)                                                                                               
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                 result = result + (m(g)*O(h))*alpha(k)*r1*r2                                                                                                                            
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         end if                                                                                                                                                                          
                     end do                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
                                                                                                                                                                                                         
     else                                                                                                                                                                                                
         m =    A_Multipoles(2:4)                                                                                                                                                                        
         O =    A_Multipoles(10:16)                                                                                                                                                                      
         alpha   =  B_Pol(1:6)                                                                                                                                                                           
                                                                                                                                                                                                         
         do g=1,3                                                                                                                                                                                        
             do h=1,7                                                                                                                                                                                    
                 do i = 1,3                                                                                                                                                                              
                     do j = 1,3                                                                                                                                                                          
                                                                                                                                                                                                         
                         Call GetIndex_mm(i,j,k)                                                                                                                                                         
                                                                                                                                                                                                         
                         if (DABS(m(g))>eps .and.  DABS(alpha(k))>eps .and. DABS(O(h))>eps) Then                                                                                                         
                                                                                                                                                                                                         
                                 call Get_Comp(g,cp_g)                                                                                                                                                   
                                 call Get_Comp(h,cp_h)                                                                                                                                                   
                                 call Get_Comp(i,cp_i)                                                                                                                                                   
                                 call Get_Comp(j,cp_j)                                                                                                                                                   
                                                                                                                                                                                                         
                                 Call T_lk(Ar,Br,C,3,Floor((h*1d0)/2d0),cp_h,1,Floor((j*1d0)/2d0),cp_j,r1)                                                                                               
                                                                                                                                                                                                         
                                 Call T_lk(Ar,Br,C,1,Floor((g*1d0)/2d0),cp_g,1,Floor((i*1d0)/2d0),cp_i,r2)                                                                                               
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                 result = result + (m(g)*O(h))*alpha(k)*r1*r2                                                                                                                            
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         end if                                                                                                                                                                          
                     end do                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
                                                                                                                                                                                                         
     end if                                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE mO_mm                                                                                                                                                                                    
                                                                                                                                                                                                         
 SUBROUTINE QdQd_mm(Ar,Br,C ,A_Multipoles,B_Multipoles ,A_Pol,B_Pol, ind , result)                                                                                                                       
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     INTEGER ::  i,j,k,h,g                                                                                                                                                                               
     real*8, INTENT(INOUT) ::result                                                                                                                                                                      
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 , dimension(57) , INTENT(IN) :: A_Pol,B_Pol                                                                                                                                                  
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     Integer, INTENT(IN):: ind                                                                                                                                                                           
     real*8 :: r1,r2                                                                                                                                                                                     
     real*8 , dimension(5):: Qd                                                                                                                                                                          
     real*8 , dimension(6):: alpha                                                                                                                                                                       
     real*8:: eps=EPSILON(result)                                                                                                                                                                        
                                                                                                                                                                                                         
     Character :: cp_h,cp_i,cp_j,cp_g                                                                                                                                                                    
                                                                                                                                                                                                         
     result = 0d0                                                                                                                                                                                        
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     if (ind==0) then                                                                                                                                                                                    
         Qd =    B_Multipoles(5:9)                                                                                                                                                                       
         alpha  = A_Pol(1:6)                                                                                                                                                                             
                                                                                                                                                                                                         
         do g=1,5                                                                                                                                                                                        
             do h=1,5                                                                                                                                                                                    
                 do i = 1,3                                                                                                                                                                              
                     do j = 1,3                                                                                                                                                                          
                                                                                                                                                                                                         
                         Call GetIndex_mm(i,j,k)                                                                                                                                                         
                                                                                                                                                                                                         
                         if (DABS(Qd(g))>eps .and.  DABS(alpha(k))>eps .and. DABS(Qd(h))>eps) Then                                                                                                       
                                 ! Call TQdm(Ar,Br,C ,h,j,mod(ind+1,2),t_jh)                                                                                                                             
                                 ! Call TQdm(Ar,Br,C ,g,i,mod(ind+1,2),t_ig)                                                                                                                             
                                 ! result = result + (Qd(g)*Qd(h))*alpha(k)*t_ig*t_jh                                                                                                                    
                                 call Get_Comp(g,cp_g)                                                                                                                                                   
                                 call Get_Comp(h,cp_h)                                                                                                                                                   
                                 call Get_Comp(i,cp_i)                                                                                                                                                   
                                 call Get_Comp(j,cp_j)                                                                                                                                                   
                                                                                                                                                                                                         
                                 Call T_lk(Ar,Br,C,1,Floor((j*1d0)/2d0),cp_j,2,Floor((h*1d0)/2d0),cp_h,r1)                                                                                               
                                                                                                                                                                                                         
                                 Call T_lk(Ar,Br,C,1,Floor((i*1d0)/2d0),cp_i,2,Floor((g*1d0)/2d0),cp_g,r2)                                                                                               
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                 result = result + (Qd(g)*Qd(h))*alpha(k)*r1*r2                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         end if                                                                                                                                                                          
                     end do                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
                                                                                                                                                                                                         
     else                                                                                                                                                                                                
         Qd =    A_Multipoles(5:9)                                                                                                                                                                       
         alpha   =  B_Pol(1:6)                                                                                                                                                                           
                                                                                                                                                                                                         
         do g=1,5                                                                                                                                                                                        
             do h=1,5                                                                                                                                                                                    
                 do i = 1,3                                                                                                                                                                              
                     do j = 1,3                                                                                                                                                                          
                                                                                                                                                                                                         
                         Call GetIndex_mm(i,j,k)                                                                                                                                                         
                                                                                                                                                                                                         
                         if (DABS(Qd(g))>eps .and.  DABS(alpha(k))>eps .and. DABS(Qd(h))>eps) Then                                                                                                       
                                 ! Call TQdm(Ar,Br,C ,h,j,mod(ind+1,2),t_jh)                                                                                                                             
                                 ! Call TQdm(Ar,Br,C ,g,i,mod(ind+1,2),t_ig)                                                                                                                             
                                 ! result = result + (Qd(g)*Qd(h))*alpha(k)*t_ig*t_jh                                                                                                                    
                                 call Get_Comp(g,cp_g)                                                                                                                                                   
                                 call Get_Comp(h,cp_h)                                                                                                                                                   
                                 call Get_Comp(i,cp_i)                                                                                                                                                   
                                 call Get_Comp(j,cp_j)                                                                                                                                                   
                                                                                                                                                                                                         
                                 Call T_lk(Ar,Br,C,2,Floor((h*1d0)/2d0),cp_h,1,Floor((j*1d0)/2d0),cp_j,r1)                                                                                               
                                                                                                                                                                                                         
                                 Call T_lk(Ar,Br,C,2,Floor((g*1d0)/2d0),cp_g,1,Floor((i*1d0)/2d0),cp_i,r2)                                                                                               
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                 result = result + (Qd(g)*Qd(h))*alpha(k)*r1*r2                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         end if                                                                                                                                                                          
                     end do                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
                                                                                                                                                                                                         
     end if                                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE QdQd_mm                                                                                                                                                                                  
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE qQd_QdQd(Ar,Br,C ,A_Multipoles,B_Multipoles ,A_Pol,B_Pol, ind , result)                                                                                                                      
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     INTEGER ::  i,j,k,h                                                                                                                                                                                 
     real*8, INTENT(INOUT) ::result                                                                                                                                                                      
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 , dimension(57) , INTENT(IN) :: A_Pol,B_Pol                                                                                                                                                  
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     Integer, INTENT(IN):: ind                                                                                                                                                                           
     real*8 :: q,r1,r2                                                                                                                                                                                   
     real*8 , dimension(5):: Qd                                                                                                                                                                          
     real*8 , dimension(15):: alpha_QdQd                                                                                                                                                                 
     real*8:: eps=EPSILON(result)                                                                                                                                                                        
                                                                                                                                                                                                         
     Character :: cp_h,cp_i,cp_j,cp_g                                                                                                                                                                    
                                                                                                                                                                                                         
     result = 0d0                                                                                                                                                                                        
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     if (ind==0) then                                                                                                                                                                                    
         q =  B_Multipoles(1)                                                                                                                                                                            
         Qd =  B_Multipoles(5:9)                                                                                                                                                                         
         alpha_QdQd  = A_Pol(22:36)                                                                                                                                                                      
                                                                                                                                                                                                         
         do h=1,5                                                                                                                                                                                        
             do i = 1,5                                                                                                                                                                                  
                 do j = 1,5                                                                                                                                                                              
                                                                                                                                                                                                         
                     Call GetIndex_QdQd(i,j,k)                                                                                                                                                           
                                                                                                                                                                                                         
                     if ( DABS(q)>eps .and. DABS(Qd(h))>eps .and.  DABS(alpha_QdQd(k))>eps ) Then                                                                                                        
                             ! Call TQdq(Ar,Br,C ,j,ind,t_j)                                                                                                                                             
                             ! Call TQdQd (Ar,Br,C ,i,h,ind,t_ih)                                                                                                                                        
                             ! result = result + (q*Qd(h))*alpha_QdQd(k)*t_ih*t_j                                                                                                                        
                                                                                                                                                                                                         
                         call Get_Comp(h,cp_h)                                                                                                                                                           
                         call Get_Comp(i,cp_i)                                                                                                                                                           
                         call Get_Comp(j,cp_j)                                                                                                                                                           
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,2,Floor((j*1d0)/2d0),cp_j,0,0,"0",r1)                                                                                                                         
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,2,Floor((i*1d0)/2d0),cp_i,2,Floor((h*1d0)/2d0),cp_h,r2)                                                                                                       
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         result = result + (q*Qd(h))*alpha_QdQd(k)*r1*r2                                                                                                                                 
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                     end if                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
                                                                                                                                                                                                         
     else                                                                                                                                                                                                
         q            =  A_Multipoles(1)                                                                                                                                                                 
         Qd           =  A_Multipoles(5:9)                                                                                                                                                               
         alpha_QdQd   =  B_Pol(22:36)                                                                                                                                                                    
                                                                                                                                                                                                         
         do h=1,5                                                                                                                                                                                        
             do i = 1,5                                                                                                                                                                                  
                 do j = 1,5                                                                                                                                                                              
                                                                                                                                                                                                         
                     Call GetIndex_QdQd(i,j,k)                                                                                                                                                           
                                                                                                                                                                                                         
                     if ( DABS(q)>eps .and. DABS(Qd(h))>eps .and.  DABS(alpha_QdQd(k))>eps ) Then                                                                                                        
                             ! Call TQdq(Ar,Br,C ,j,ind,t_j)                                                                                                                                             
                             ! Call TQdQd (Ar,Br,C ,i,h,ind,t_ih)                                                                                                                                        
                             ! result = result + (q*Qd(h))*alpha_QdQd(k)*t_ih*t_j                                                                                                                        
                                                                                                                                                                                                         
                         call Get_Comp(h,cp_h)                                                                                                                                                           
                         call Get_Comp(i,cp_i)                                                                                                                                                           
                         call Get_Comp(j,cp_j)                                                                                                                                                           
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,0,0,"0",2,Floor((j*1d0)/2d0),cp_j,r1)                                                                                                                         
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,2,Floor((h*1d0)/2d0),cp_h,2,Floor((i*1d0)/2d0),cp_i,r2)                                                                                                       
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         result = result + (q*Qd(h))*alpha_QdQd(k)*r1*r2                                                                                                                                 
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                     end if                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
                                                                                                                                                                                                         
     end if                                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE qQd_QdQd                                                                                                                                                                                 
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE mm_QdQd(Ar,Br,C ,A_Multipoles,B_Multipoles ,A_Pol,B_Pol, ind , result)                                                                                                                       
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     INTEGER ::  i,j,k,h,g                                                                                                                                                                               
     real*8, INTENT(INOUT) ::result                                                                                                                                                                      
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 , dimension(57) , INTENT(IN) :: A_Pol,B_Pol                                                                                                                                                  
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     Integer, INTENT(IN):: ind                                                                                                                                                                           
     real*8 :: r1,r2                                                                                                                                                                                     
     real*8 , dimension(3):: m                                                                                                                                                                           
     real*8 , dimension(15):: alpha_QdQd                                                                                                                                                                 
     real*8:: eps=EPSILON(result)                                                                                                                                                                        
                                                                                                                                                                                                         
     Character :: cp_h,cp_i,cp_j,cp_g                                                                                                                                                                    
                                                                                                                                                                                                         
     result = 0d0                                                                                                                                                                                        
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     if (ind==0) then                                                                                                                                                                                    
         m=  B_Multipoles(2:4)                                                                                                                                                                           
         alpha_QdQd  = A_Pol(22:36)                                                                                                                                                                      
                                                                                                                                                                                                         
         do g=1,3                                                                                                                                                                                        
             do h=1,3                                                                                                                                                                                    
                 do i = 1,5                                                                                                                                                                              
                     do j = 1,5                                                                                                                                                                          
                                                                                                                                                                                                         
                         Call GetIndex_QdQd(i,j,k)                                                                                                                                                       
                                                                                                                                                                                                         
                         if ( DABS(m(g))>eps .and. DABS(m(h))>eps .and.  DABS(alpha_QdQd(k))>eps ) Then                                                                                                  
                                 ! Call TQdm(Ar,Br,C ,j,g,ind,t_jg)                                                                                                                                      
                                 ! Call TQdm (Ar,Br,C ,i,h,ind,t_ih)                                                                                                                                     
                                 ! result = result + (m(g)*m(h))*alpha_QdQd(k)*t_ih*t_jg                                                                                                                 
                                                                                                                                                                                                         
                             call Get_Comp(g,cp_g)                                                                                                                                                       
                             call Get_Comp(h,cp_h)                                                                                                                                                       
                             call Get_Comp(i,cp_i)                                                                                                                                                       
                             call Get_Comp(j,cp_j)                                                                                                                                                       
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,2,Floor((j*1d0)/2d0),cp_j,1,Floor((h*1d0)/2d0),cp_h,r1)                                                                                                   
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,2,Floor((i*1d0)/2d0),cp_i,1,Floor((g*1d0)/2d0),cp_g,r2)                                                                                                   
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             result = result + (m(g)*m(h))*alpha_QdQd(k)*r1*r2                                                                                                                           
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         end if                                                                                                                                                                          
                     end do                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     else                                                                                                                                                                                                
         m           =  A_Multipoles(2:4)                                                                                                                                                                
         alpha_QdQd   =  B_Pol(22:36)                                                                                                                                                                    
                                                                                                                                                                                                         
         do g=1,3                                                                                                                                                                                        
             do h=1,3                                                                                                                                                                                    
                 do i = 1,5                                                                                                                                                                              
                     do j = 1,5                                                                                                                                                                          
                                                                                                                                                                                                         
                         Call GetIndex_QdQd(i,j,k)                                                                                                                                                       
                                                                                                                                                                                                         
                         if ( DABS(m(g))>eps .and. DABS(m(h))>eps .and.  DABS(alpha_QdQd(k))>eps ) Then                                                                                                  
                                 ! Call TQdm(Ar,Br,C ,j,g,ind,t_jg)                                                                                                                                      
                                 ! Call TQdm (Ar,Br,C ,i,h,ind,t_ih)                                                                                                                                     
                                 ! result = result + (m(g)*m(h))*alpha_QdQd(k)*t_ih*t_jg                                                                                                                 
                                                                                                                                                                                                         
                             call Get_Comp(g,cp_g)                                                                                                                                                       
                             call Get_Comp(h,cp_h)                                                                                                                                                       
                             call Get_Comp(i,cp_i)                                                                                                                                                       
                             call Get_Comp(j,cp_j)                                                                                                                                                       
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,1,Floor((h*1d0)/2d0),cp_h,2,Floor((j*1d0)/2d0),cp_j,r1)                                                                                                   
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,1,Floor((g*1d0)/2d0),cp_g,2,Floor((i*1d0)/2d0),cp_i,r2)                                                                                                   
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             result = result + (m(g)*m(h))*alpha_QdQd(k)*r1*r2                                                                                                                           
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         end if                                                                                                                                                                          
                     end do                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
     end if                                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE mm_QdQd                                                                                                                                                                                  
                                                                                                                                                                                                         
 SUBROUTINE mQd_mQd(Ar,Br,C ,A_Multipoles,B_Multipoles ,A_Pol,B_Pol, ind , result)                                                                                                                       
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     INTEGER ::  i,j,k,h,g                                                                                                                                                                               
     real*8, INTENT(INOUT) ::result                                                                                                                                                                      
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 , dimension(57) , INTENT(IN) :: A_Pol,B_Pol                                                                                                                                                  
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     Integer, INTENT(IN):: ind                                                                                                                                                                           
     real*8 :: t_ih,t_jg                                                                                                                                                                                 
     real*8 , dimension(3):: m                                                                                                                                                                           
     real*8 , dimension(5):: Qd                                                                                                                                                                          
     real*8 , dimension(15):: alpha_mQ                                                                                                                                                                   
     real*8:: eps=EPSILON(result)                                                                                                                                                                        
     real*8 :: r1,r2                                                                                                                                                                                     
                                                                                                                                                                                                         
     Character :: cp_h,cp_i,cp_j,cp_g                                                                                                                                                                    
                                                                                                                                                                                                         
     result = 0d0                                                                                                                                                                                        
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     if (ind==0) then                                                                                                                                                                                    
         m =  B_Multipoles(2:4)                                                                                                                                                                          
         Qd =  B_Multipoles(5:9)                                                                                                                                                                         
         alpha_mQ  = A_Pol(7:21)                                                                                                                                                                         
                                                                                                                                                                                                         
         do g = 1,3                                                                                                                                                                                      
             do h = 1,5                                                                                                                                                                                  
                 do i = 1,3                                                                                                                                                                              
                     do j = 1,5                                                                                                                                                                          
                                                                                                                                                                                                         
                         Call GetIndex_mQd(i,j,k)                                                                                                                                                        
                                                                                                                                                                                                         
                         if (DABS(Qd(h))>eps .and. DABS(m(g))>eps .and.  DABS(alpha_mQ(k))>eps ) Then                                                                                                    
                                 ! Call TQdm(Ar,Br,C ,j,g,ind,t_jg)                                                                                                                                      
                                 ! Call TQdm (Ar,Br,C ,i,h,mod(ind+1,2),t_ih)                                                                                                                            
                                 ! result = result + (m(g)*Qd(h))*alpha_mQ(k)*t_ih*t_jg                                                                                                                  
                                                                                                                                                                                                         
                             call Get_Comp(g,cp_g)                                                                                                                                                       
                             call Get_Comp(h,cp_h)                                                                                                                                                       
                             call Get_Comp(i,cp_i)                                                                                                                                                       
                             call Get_Comp(j,cp_j)                                                                                                                                                       
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,2,Floor((j*1d0)/2d0),cp_j,1,Floor((g*1d0)/2d0),cp_g,r1) ! T1                                                                                              
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,1,Floor((i*1d0)/2d0),cp_i,2,Floor((h*1d0)/2d0),cp_h,r2) ! T2                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             result = result + (m(g)*Qd(h))*alpha_mQ(k)*r1*r2                                                                                                                            
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         end if                                                                                                                                                                          
                     end do                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
                                                                                                                                                                                                         
     else                                                                                                                                                                                                
         m           =  A_Multipoles(2:4)                                                                                                                                                                
         Qd          =  A_Multipoles(5:9)                                                                                                                                                                
         alpha_mQ    =  B_Pol(7:21)                                                                                                                                                                      
                                                                                                                                                                                                         
         do g = 1,3                                                                                                                                                                                      
             do h = 1,5                                                                                                                                                                                  
                 do i = 1,3                                                                                                                                                                              
                     do j = 1,5                                                                                                                                                                          
                                                                                                                                                                                                         
                         Call GetIndex_mQd(i,j,k)                                                                                                                                                        
                                                                                                                                                                                                         
                         if (DABS(Qd(h))>eps .and. DABS(m(g))>eps .and.  DABS(alpha_mQ(k))>eps ) Then                                                                                                    
                                 ! Call TQdm(Ar,Br,C ,j,g,ind,t_jg)                                                                                                                                      
                                 ! Call TQdm (Ar,Br,C ,i,h,mod(ind+1,2),t_ih)                                                                                                                            
                                 ! result = result + (m(g)*Qd(h))*alpha_mQ(k)*t_ih*t_jg                                                                                                                  
                                                                                                                                                                                                         
                             call Get_Comp(g,cp_g)                                                                                                                                                       
                             call Get_Comp(h,cp_h)                                                                                                                                                       
                             call Get_Comp(i,cp_i)                                                                                                                                                       
                             call Get_Comp(j,cp_j)                                                                                                                                                       
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,1,Floor((g*1d0)/2d0),cp_g,2,Floor((j*1d0)/2d0),cp_j,r1)                                                                                                   
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,2,Floor((h*1d0)/2d0),cp_h,1,Floor((i*1d0)/2d0),cp_i,r2)                                                                                                   
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             result = result + (m(g)*Qd(h))*alpha_mQ(k)*r1*r2                                                                                                                            
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         end if                                                                                                                                                                          
                     end do                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
                                                                                                                                                                                                         
     end if                                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE mQd_mQd                                                                                                                                                                                  
                                                                                                                                                                                                         
 SUBROUTINE mQd_Qdm(Ar,Br,C ,A_Multipoles,B_Multipoles ,A_Pol,B_Pol, ind , result)                                                                                                                       
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     INTEGER ::  i,j,k,h,g                                                                                                                                                                               
     real*8, INTENT(INOUT) ::result                                                                                                                                                                      
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 , dimension(57) , INTENT(IN) :: A_Pol,B_Pol                                                                                                                                                  
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     Integer, INTENT(IN):: ind                                                                                                                                                                           
     real*8 :: r1,r2                                                                                                                                                                                     
     real*8 , dimension(3):: m                                                                                                                                                                           
     real*8 , dimension(5):: Qd                                                                                                                                                                          
     real*8 , dimension(15):: alpha_mQ                                                                                                                                                                   
     real*8:: eps=EPSILON(result)                                                                                                                                                                        
                                                                                                                                                                                                         
     Character :: cp_h,cp_i,cp_j,cp_g                                                                                                                                                                    
                                                                                                                                                                                                         
     result = 0d0                                                                                                                                                                                        
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     if (ind==0) then                                                                                                                                                                                    
         m =  B_Multipoles(2:4)                                                                                                                                                                          
         Qd =  B_Multipoles(5:9)                                                                                                                                                                         
         alpha_mQ  = A_Pol(7:21)                                                                                                                                                                         
                                                                                                                                                                                                         
         do g = 1,3                                                                                                                                                                                      
             do h = 1,5                                                                                                                                                                                  
                 do i = 1,3                                                                                                                                                                              
                     do j = 1,5                                                                                                                                                                          
                                                                                                                                                                                                         
                         Call GetIndex_mQd(i,j,k)                                                                                                                                                        
                                                                                                                                                                                                         
                         if (DABS(Qd(h))>eps .and. DABS(m(g))>eps .and.  DABS(alpha_mQ(k))>eps ) Then                                                                                                    
                                 ! Call TQdQd(Ar,Br,C ,j,h,ind,t_jh)                                                                                                                                     
                                 ! Call Tmm (Ar,Br,C ,i,g,ind,t_ig)                                                                                                                                      
                                 ! result = result + (m(g)*Qd(h))*alpha_mQ(k)*t_ig*t_jh                                                                                                                  
                                                                                                                                                                                                         
                                 call Get_Comp(g,cp_g)                                                                                                                                                   
                                 call Get_Comp(h,cp_h)                                                                                                                                                   
                                 call Get_Comp(i,cp_i)                                                                                                                                                   
                                 call Get_Comp(j,cp_j)                                                                                                                                                   
                                                                                                                                                                                                         
                                 Call T_lk(Ar,Br,C,2,Floor((j*1d0)/2d0),cp_j,2,Floor((h*1d0)/2d0),cp_h,r1)                                                                                               
                                                                                                                                                                                                         
                                 Call T_lk(Ar,Br,C,1,Floor((i*1d0)/2d0),cp_i,1,Floor((g*1d0)/2d0),cp_g,r2)                                                                                               
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                 result = result + (m(g)*Qd(h))*alpha_mQ(k)*r1*r2                                                                                                                        
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         end if                                                                                                                                                                          
                     end do                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
                                                                                                                                                                                                         
     else                                                                                                                                                                                                
         m           =  A_Multipoles(2:4)                                                                                                                                                                
         Qd          =  A_Multipoles(5:9)                                                                                                                                                                
         alpha_mQ    =  B_Pol(7:21)                                                                                                                                                                      
                                                                                                                                                                                                         
         do g = 1,3                                                                                                                                                                                      
             do h = 1,5                                                                                                                                                                                  
                 do i = 1,3                                                                                                                                                                              
                     do j = 1,5                                                                                                                                                                          
                                                                                                                                                                                                         
                         Call GetIndex_mQd(i,j,k)                                                                                                                                                        
                                                                                                                                                                                                         
                         if (DABS(Qd(h))>eps .and. DABS(m(g))>eps .and.  DABS(alpha_mQ(k))>eps ) Then                                                                                                    
                                                                                                                                                                                                         
                                 call Get_Comp(g,cp_g)                                                                                                                                                   
                                 call Get_Comp(h,cp_h)                                                                                                                                                   
                                 call Get_Comp(i,cp_i)                                                                                                                                                   
                                 call Get_Comp(j,cp_j)                                                                                                                                                   
                                                                                                                                                                                                         
                                 Call T_lk(Ar,Br,C,2,Floor((h*1d0)/2d0),cp_h,2,Floor((j*1d0)/2d0),cp_j,r1)                                                                                               
                                                                                                                                                                                                         
                                 Call T_lk(Ar,Br,C,1,Floor((g*1d0)/2d0),cp_g,1,Floor((i*1d0)/2d0),cp_i,r2)                                                                                               
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                 result = result + (m(g)*Qd(h))*alpha_mQ(k)*r1*r2                                                                                                                        
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         end if                                                                                                                                                                          
                     end do                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
                                                                                                                                                                                                         
     end if                                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE mQd_Qdm                                                                                                                                                                                  
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE qO_Qdm(Ar,Br,C ,A_Multipoles,B_Multipoles ,A_Pol,B_Pol, ind , result)                                                                                                                        
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     INTEGER ::  i,j,k,h,g                                                                                                                                                                               
     real*8, INTENT(INOUT) ::result                                                                                                                                                                      
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 , dimension(57) , INTENT(IN) :: A_Pol,B_Pol                                                                                                                                                  
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     Integer, INTENT(IN):: ind                                                                                                                                                                           
     real*8 ::q,r1,r2                                                                                                                                                                                    
     real*8 , dimension(7):: O                                                                                                                                                                           
     real*8 , dimension(15):: alpha_mQ                                                                                                                                                                   
     real*8:: eps=EPSILON(result)                                                                                                                                                                        
                                                                                                                                                                                                         
     Character :: cp_h,cp_i,cp_j,cp_g                                                                                                                                                                    
                                                                                                                                                                                                         
     result = 0d0                                                                                                                                                                                        
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     if (ind==0) then                                                                                                                                                                                    
         q =  B_Multipoles(1)                                                                                                                                                                            
         O =  B_Multipoles(10:16)                                                                                                                                                                        
         alpha_mQ  = A_Pol(7:21)                                                                                                                                                                         
                                                                                                                                                                                                         
         do h = 1,7                                                                                                                                                                                      
             do i = 1,3                                                                                                                                                                                  
                 do j = 1,5                                                                                                                                                                              
                                                                                                                                                                                                         
                     Call GetIndex_mQd(i,j,k)                                                                                                                                                            
                                                                                                                                                                                                         
                     if (DABS(O(h))>eps .and. DABS(q)>eps .and.  DABS(alpha_mQ(k))>eps ) Then                                                                                                            
                             ! Call TQdq(Ar,Br,C ,j,ind,t_j)                                                                                                                                             
                             ! Call TOm (Ar,Br,C ,i,h,mod(ind+1,2),t_ih)                                                                                                                                 
                             ! result = result + (q*O(h))*alpha_mQ(k)*t_ih*t_j                                                                                                                           
                                                                                                                                                                                                         
                         call Get_Comp(g,cp_g)                                                                                                                                                           
                         call Get_Comp(h,cp_h)                                                                                                                                                           
                         call Get_Comp(i,cp_i)                                                                                                                                                           
                         call Get_Comp(j,cp_j)                                                                                                                                                           
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,2,Floor((j*1d0)/2d0),cp_j,0,0,"0",r1)                                                                                                                         
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,1,Floor((i*1d0)/2d0),cp_i,3,Floor((h*1d0)/2d0),cp_h,r2)                                                                                                       
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         result = result + (q*O(h))*alpha_mQ(k)*r1*r2                                                                                                                                    
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                     end if                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
                                                                                                                                                                                                         
     else                                                                                                                                                                                                
         q =  A_Multipoles(1)                                                                                                                                                                            
         O =  A_Multipoles(10:16)                                                                                                                                                                        
         alpha_mQ    =  B_Pol(7:21)                                                                                                                                                                      
                                                                                                                                                                                                         
         do h = 1,7                                                                                                                                                                                      
             do i = 1,3                                                                                                                                                                                  
                 do j = 1,5                                                                                                                                                                              
                                                                                                                                                                                                         
                     Call GetIndex_mQd(i,j,k)                                                                                                                                                            
                                                                                                                                                                                                         
                     if (DABS(O(h))>eps .and. DABS(q)>eps .and.  DABS(alpha_mQ(k))>eps ) Then                                                                                                            
                             ! Call TQdq(Ar,Br,C ,j,ind,t_j)                                                                                                                                             
                             ! Call TOm (Ar,Br,C ,i,h,mod(ind+1,2),t_ih)                                                                                                                                 
                             ! result = result + (q*O(h))*alpha_mQ(k)*t_ih*t_j                                                                                                                           
                                                                                                                                                                                                         
                         call Get_Comp(g,cp_g)                                                                                                                                                           
                         call Get_Comp(h,cp_h)                                                                                                                                                           
                         call Get_Comp(i,cp_i)                                                                                                                                                           
                         call Get_Comp(j,cp_j)                                                                                                                                                           
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,0,0,"0",2,Floor((j*1d0)/2d0),cp_j,r1)                                                                                                                         
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,3,Floor((h*1d0)/2d0),cp_h,1,Floor((i*1d0)/2d0),cp_i,r2)                                                                                                       
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         result = result + (q*O(h))*alpha_mQ(k)*r1*r2                                                                                                                                    
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                     end if                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
                                                                                                                                                                                                         
     end if                                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE qO_Qdm                                                                                                                                                                                   
                                                                                                                                                                                                         
 SUBROUTINE qO_mQd(Ar,Br,C ,A_Multipoles,B_Multipoles ,A_Pol,B_Pol, ind , result)                                                                                                                        
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     INTEGER ::  i,j,k,h,g                                                                                                                                                                               
     real*8, INTENT(INOUT) ::result                                                                                                                                                                      
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 , dimension(57) , INTENT(IN) :: A_Pol,B_Pol                                                                                                                                                  
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     Integer, INTENT(IN):: ind                                                                                                                                                                           
     real*8 ::q,r1,r2                                                                                                                                                                                    
     real*8 , dimension(7):: O                                                                                                                                                                           
     real*8 , dimension(15):: alpha_mQ                                                                                                                                                                   
     real*8:: eps=EPSILON(result)                                                                                                                                                                        
                                                                                                                                                                                                         
     Character :: cp_h,cp_i,cp_j,cp_g                                                                                                                                                                    
                                                                                                                                                                                                         
     result = 0d0                                                                                                                                                                                        
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     if (ind==0) then                                                                                                                                                                                    
         q =  B_Multipoles(1)                                                                                                                                                                            
         O =  B_Multipoles(10:16)                                                                                                                                                                        
         alpha_mQ  = A_Pol(7:21)                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         do h = 1,7                                                                                                                                                                                      
             do i = 1,3                                                                                                                                                                                  
                 do j = 1,5                                                                                                                                                                              
                                                                                                                                                                                                         
                     Call GetIndex_mQd(i,j,k)                                                                                                                                                            
                                                                                                                                                                                                         
                     if (DABS(O(h))>eps .and. DABS(q)>eps .and.  DABS(alpha_mQ(k))>eps ) Then                                                                                                            
                             ! Call Tmq(Ar,Br,C ,i,ind,t_i)                                                                                                                                              
                             ! Call TOQd (Ar,Br,C ,j,h,mod(ind+1,2),t_jh)                                                                                                                                
                             ! result = result + (q*O(h))*alpha_mQ(k)*t_i*t_jh                                                                                                                           
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         call Get_Comp(h,cp_h)                                                                                                                                                           
                         call Get_Comp(i,cp_i)                                                                                                                                                           
                         call Get_Comp(j,cp_j)                                                                                                                                                           
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,1,Floor((i*1d0)/2d0),cp_i,0,0,"0",r1)                                                                                                                         
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,2,Floor((j*1d0)/2d0),cp_j,3,Floor((h*1d0)/2d0),cp_h,r2)                                                                                                       
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         result = result + (q*O(h))*alpha_mQ(k)*r1*r2                                                                                                                                    
                                                                                                                                                                                                         
                     end if                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     else                                                                                                                                                                                                
         q =  A_Multipoles(1)                                                                                                                                                                            
         O =  A_Multipoles(10:16)                                                                                                                                                                        
         alpha_mQ    =  B_Pol(7:21)                                                                                                                                                                      
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         do h = 1,7                                                                                                                                                                                      
             do i = 1,3                                                                                                                                                                                  
                 do j = 1,5                                                                                                                                                                              
                                                                                                                                                                                                         
                     Call GetIndex_mQd(i,j,k)                                                                                                                                                            
                                                                                                                                                                                                         
                     if (DABS(O(h))>eps .and. DABS(q)>eps .and.  DABS(alpha_mQ(k))>eps ) Then                                                                                                            
                                                                                                                                                                                                         
                         call Get_Comp(h,cp_h)                                                                                                                                                           
                         call Get_Comp(i,cp_i)                                                                                                                                                           
                         call Get_Comp(j,cp_j)                                                                                                                                                           
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,0,0,"0",1,Floor((i*1d0)/2d0),cp_i,r1)                                                                                                                         
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,3,Floor((h*1d0)/2d0),cp_h,2,Floor((j*1d0)/2d0),cp_j,r2)                                                                                                       
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         result = result + (q*O(h))*alpha_mQ(k)*r1*r2                                                                                                                                    
                                                                                                                                                                                                         
                     end if                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     end if                                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE qO_mQd                                                                                                                                                                                   
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE qQd_Om(Ar,Br,C ,A_Multipoles,B_Multipoles ,A_Pol,B_Pol, ind , result)                                                                                                                        
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     INTEGER ::  i,j,k,h                                                                                                                                                                                 
     real*8, INTENT(INOUT) ::result                                                                                                                                                                      
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 , dimension(57) , INTENT(IN) :: A_Pol,B_Pol                                                                                                                                                  
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     Integer, INTENT(IN):: ind                                                                                                                                                                           
     real*8 :: q,r1,r2                                                                                                                                                                                   
     real*8 , dimension(5):: Qd                                                                                                                                                                          
     real*8 , dimension(21):: alpha_mO                                                                                                                                                                   
     real*8:: eps=EPSILON(result)                                                                                                                                                                        
     Character :: cp_h,cp_i,cp_j,cp_g                                                                                                                                                                    
                                                                                                                                                                                                         
     result = 0d0                                                                                                                                                                                        
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     if (ind==0) then                                                                                                                                                                                    
         q  =  B_Multipoles(1)                                                                                                                                                                           
         Qd =  B_Multipoles(5:9)                                                                                                                                                                         
         alpha_mO  = A_Pol(37:57)                                                                                                                                                                        
                                                                                                                                                                                                         
         do h = 1,5                                                                                                                                                                                      
             do i = 1,3                                                                                                                                                                                  
                 do j = 1,7                                                                                                                                                                              
                                                                                                                                                                                                         
                     Call GetIndex_mO(i,j,k)                                                                                                                                                             
                                                                                                                                                                                                         
                     if ( DABS(Qd(h))>eps .and.DABS(q)>eps .and.  DABS(alpha_mO(k))>eps ) Then                                                                                                           
                             ! Call TOq(Ar,Br,C ,j,ind,t_j)                                                                                                                                              
                             ! Call TQdm (Ar,Br,C ,i,h,mod(ind+1,2),t_ih)                                                                                                                                
                             ! result = result + (q*Qd(h))*alpha_mO(k)*t_ih*t_j                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         call Get_Comp(h,cp_h)                                                                                                                                                           
                         call Get_Comp(i,cp_i)                                                                                                                                                           
                         call Get_Comp(j,cp_j)                                                                                                                                                           
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,3,Floor((j*1d0)/2d0),cp_j,0,0,"0",r1)                                                                                                                         
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,1,Floor((i*1d0)/2d0),cp_i,2,Floor((h*1d0)/2d0),cp_h,r2)                                                                                                       
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         result = result + (q*Qd(h))*alpha_mO(k)*r1*r2                                                                                                                                   
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                     end if                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
                                                                                                                                                                                                         
     else                                                                                                                                                                                                
         q            =  A_Multipoles(1)                                                                                                                                                                 
         Qd           =  A_Multipoles(5:9)                                                                                                                                                               
         alpha_mO    =  B_Pol(37:57)                                                                                                                                                                     
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         do h = 1,5                                                                                                                                                                                      
             do i = 1,3                                                                                                                                                                                  
                 do j = 1,7                                                                                                                                                                              
                                                                                                                                                                                                         
                     Call GetIndex_mO(i,j,k)                                                                                                                                                             
                                                                                                                                                                                                         
                     if ( DABS(Qd(h))>eps .and.DABS(q)>eps .and.  DABS(alpha_mO(k))>eps ) Then                                                                                                           
                             ! Call TOq(Ar,Br,C ,j,ind,t_j)                                                                                                                                              
                             ! Call TQdm (Ar,Br,C ,i,h,mod(ind+1,2),t_ih)                                                                                                                                
                             ! result = result + (q*Qd(h))*alpha_mO(k)*t_ih*t_j                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         call Get_Comp(h,cp_h)                                                                                                                                                           
                         call Get_Comp(i,cp_i)                                                                                                                                                           
                         call Get_Comp(j,cp_j)                                                                                                                                                           
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,0,0,"0",3,Floor((j*1d0)/2d0),cp_j,r1)                                                                                                                         
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,2,Floor((h*1d0)/2d0),cp_h,1,Floor((i*1d0)/2d0),cp_i,r2)                                                                                                       
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         result = result + (q*Qd(h))*alpha_mO(k)*r1*r2                                                                                                                                   
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                     end if                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
                                                                                                                                                                                                         
     end if                                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE qQd_Om                                                                                                                                                                                   
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE qQd_mO(Ar,Br,C ,A_Multipoles,B_Multipoles ,A_Pol,B_Pol, ind , result)                                                                                                                        
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     INTEGER ::  i,j,k,h                                                                                                                                                                                 
     real*8, INTENT(INOUT) ::result                                                                                                                                                                      
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 , dimension(57) , INTENT(IN) :: A_Pol,B_Pol                                                                                                                                                  
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     Integer, INTENT(IN):: ind                                                                                                                                                                           
     real*8 :: q,r1,r2                                                                                                                                                                                   
     real*8 , dimension(5):: Qd                                                                                                                                                                          
     real*8 , dimension(21):: alpha_mO                                                                                                                                                                   
     real*8:: eps=EPSILON(result)                                                                                                                                                                        
     Character :: cp_h,cp_i,cp_j                                                                                                                                                                         
                                                                                                                                                                                                         
     result = 0d0                                                                                                                                                                                        
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     if (ind==0) then                                                                                                                                                                                    
         q  =  B_Multipoles(1)                                                                                                                                                                           
         Qd =  B_Multipoles(5:9)                                                                                                                                                                         
         alpha_mO  = A_Pol(37:57)                                                                                                                                                                        
                                                                                                                                                                                                         
         do h = 1,5                                                                                                                                                                                      
             do i = 1,3                                                                                                                                                                                  
                 do j = 1,7                                                                                                                                                                              
                                                                                                                                                                                                         
                     Call GetIndex_mO(i,j,k)                                                                                                                                                             
                                                                                                                                                                                                         
                     if ( DABS(Qd(h))>eps .and.DABS(q)>eps .and.  DABS(alpha_mO(k))>eps ) Then                                                                                                           
                             ! Call TOQd(Ar,Br,C ,j,h,ind,t_jh)                                                                                                                                          
                             ! Call Tmq (Ar,Br,C ,i,ind,t_i)                                                                                                                                             
                             ! result = result + (q*Qd(h))*alpha_mO(k)*t_i*t_jh                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         call Get_Comp(h,cp_h)                                                                                                                                                           
                         call Get_Comp(i,cp_i)                                                                                                                                                           
                         call Get_Comp(j,cp_j)                                                                                                                                                           
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,3,Floor((j*1d0)/2d0),cp_j,2,Floor((h*1d0)/2d0),cp_h,r1)                                                                                                       
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,1,Floor((i*1d0)/2d0),cp_i,0,0,"0",r2)                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         result = result +  (q*Qd(h))*alpha_mO(k)*r1*r2                                                                                                                                  
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                     end if                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
                                                                                                                                                                                                         
     else                                                                                                                                                                                                
         q            =  A_Multipoles(1)                                                                                                                                                                 
         Qd           =  A_Multipoles(5:9)                                                                                                                                                               
         alpha_mO    =  B_Pol(37:57)                                                                                                                                                                     
                                                                                                                                                                                                         
         do h = 1,5                                                                                                                                                                                      
             do i = 1,3                                                                                                                                                                                  
                 do j = 1,7                                                                                                                                                                              
                                                                                                                                                                                                         
                     Call GetIndex_mO(i,j,k)                                                                                                                                                             
                                                                                                                                                                                                         
                     if ( DABS(Qd(h))>eps .and.DABS(q)>eps .and.  DABS(alpha_mO(k))>eps ) Then                                                                                                           
                             ! Call TOQd(Ar,Br,C ,j,h,ind,t_jh)                                                                                                                                          
                             ! Call Tmq (Ar,Br,C ,i,ind,t_i)                                                                                                                                             
                             ! result = result + (q*Qd(h))*alpha_mO(k)*t_i*t_jh                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         call Get_Comp(h,cp_h)                                                                                                                                                           
                         call Get_Comp(i,cp_i)                                                                                                                                                           
                         call Get_Comp(j,cp_j)                                                                                                                                                           
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,2,Floor((h*1d0)/2d0),cp_h,3,Floor((j*1d0)/2d0),cp_j,r1)                                                                                                       
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,0,0,"0",1,Floor((i*1d0)/2d0),cp_i,r2)                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         result = result +  (q*Qd(h))*alpha_mO(k)*r1*r2                                                                                                                                  
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                     end if                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
                                                                                                                                                                                                         
     end if                                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE qQd_mO                                                                                                                                                                                   
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE mm_Om(Ar,Br,C ,A_Multipoles,B_Multipoles ,A_Pol,B_Pol, ind , result)                                                                                                                         
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     INTEGER ::  i,j,k,h,g                                                                                                                                                                               
     real*8, INTENT(INOUT) ::result                                                                                                                                                                      
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 , dimension(57) , INTENT(IN) :: A_Pol,B_Pol                                                                                                                                                  
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     Integer, INTENT(IN):: ind                                                                                                                                                                           
     real*8 :: r1,r2                                                                                                                                                                                     
     real*8 , dimension(3):: m                                                                                                                                                                           
     real*8 , dimension(21):: alpha_mO                                                                                                                                                                   
     real*8:: eps=EPSILON(result)                                                                                                                                                                        
     Character :: cp_h,cp_i,cp_j,cp_g                                                                                                                                                                    
                                                                                                                                                                                                         
     result = 0d0                                                                                                                                                                                        
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     if (ind==0) then                                                                                                                                                                                    
         m =  B_Multipoles(2:4)                                                                                                                                                                          
         alpha_mO  = A_Pol(37:57)                                                                                                                                                                        
                                                                                                                                                                                                         
         do g = 1,3                                                                                                                                                                                      
             do h = 1,3                                                                                                                                                                                  
                 do i = 1,3                                                                                                                                                                              
                     do j = 1,7                                                                                                                                                                          
                                                                                                                                                                                                         
                         Call GetIndex_mO(i,j,k)                                                                                                                                                         
                                                                                                                                                                                                         
                         if ( DABS(m(g))>eps .and. DABS(m(h))>eps  .and.  DABS(alpha_mO(k))>eps ) Then                                                                                                   
                                 ! Call TOm(Ar,Br,C ,j,h,ind,t_jh)                                                                                                                                       
                                 ! Call Tmm (Ar,Br,C ,i,g,ind,t_ig)                                                                                                                                      
                                 ! result = result + (m(g)*m(h))*alpha_mO(k)*t_ig*t_jh                                                                                                                   
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             call Get_Comp(g,cp_g)                                                                                                                                                       
                             call Get_Comp(h,cp_h)                                                                                                                                                       
                             call Get_Comp(i,cp_i)                                                                                                                                                       
                             call Get_Comp(j,cp_j)                                                                                                                                                       
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,3,Floor((j*1d0)/2d0),cp_j,1,Floor((h*1d0)/2d0),cp_h,r1)                                                                                                   
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,1,Floor((i*1d0)/2d0),cp_i,1,Floor((g*1d0)/2d0),cp_g,r2)                                                                                                   
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             result = result + (m(g)*m(h))*alpha_mO(k)*r1*r2                                                                                                                             
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         end if                                                                                                                                                                          
                     end do                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
                                                                                                                                                                                                         
     else                                                                                                                                                                                                
         m          =  A_Multipoles(2:4)                                                                                                                                                                 
         alpha_mO    =  B_Pol(37:57)                                                                                                                                                                     
                                                                                                                                                                                                         
         do g = 1,3                                                                                                                                                                                      
             do h = 1,3                                                                                                                                                                                  
                 do i = 1,3                                                                                                                                                                              
                     do j = 1,7                                                                                                                                                                          
                                                                                                                                                                                                         
                         Call GetIndex_mO(i,j,k)                                                                                                                                                         
                                                                                                                                                                                                         
                         if ( DABS(m(g))>eps .and. DABS(m(h))>eps  .and.  DABS(alpha_mO(k))>eps ) Then                                                                                                   
                                 ! Call TOm(Ar,Br,C ,j,h,ind,t_jh)                                                                                                                                       
                                 ! Call Tmm (Ar,Br,C ,i,g,ind,t_ig)                                                                                                                                      
                                 ! result = result + (m(g)*m(h))*alpha_mO(k)*t_ig*t_jh                                                                                                                   
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             call Get_Comp(g,cp_g)                                                                                                                                                       
                             call Get_Comp(h,cp_h)                                                                                                                                                       
                             call Get_Comp(i,cp_i)                                                                                                                                                       
                             call Get_Comp(j,cp_j)                                                                                                                                                       
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,1,Floor((h*1d0)/2d0),cp_h,3,Floor((j*1d0)/2d0),cp_j,r1)                                                                                                   
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,1,Floor((g*1d0)/2d0),cp_g,1,Floor((i*1d0)/2d0),cp_i,r2)                                                                                                   
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             result = result + (m(g)*m(h))*alpha_mO(k)*r1*r2                                                                                                                             
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         end if                                                                                                                                                                          
                     end do                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
                                                                                                                                                                                                         
     end if                                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE mm_Om                                                                                                                                                                                    
                                                                                                                                                                                                         
 !********************************************************                                                                                                                                               
 SUBROUTINE Dispersion_6_Sph2(cal_coord,Ar,Br,C ,Disp_AB, Disp_6_Energy)                                                                                                                                 
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     !   NEED TO DECLARE ALL THE SUBROUTINE ARGUMENTS and                                                                                                                                                
     !   ANY OTHER VARIABLES LOCAL TO THE SUBROUTINE                                                                                                                                                     
                                                                                                                                                                                                         
     real*8, INTENT(INOUT)  :: Disp_6_Energy                                                                                                                                                             
     real*8 , dimension(216) , INTENT(IN) :: Disp_AB                                                                                                                                                     
                                                                                                                                                                                                         
     real*8 :: R                                                                                                                                                                                         
     real*8 , dimension(11), INTENT(IN):: cal_coord                                                                                                                                                      
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     real*8 :: D_mm_mm                                                                                                                                                                                   
                                                                                                                                                                                                         
     R =cal_coord(1)                                                                                                                                                                                     
                                                                                                                                                                                                         
     Call mm_mm_Dispersion(Ar,Br,C ,Disp_AB,D_mm_mm)                                                                                                                                                     
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     Disp_6_Energy =   (-1.0d0)*(D_mm_mm)/ R**6                                                                                                                                                          
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE Dispersion_6_Sph2                                                                                                                                                                        
 !********************************************************                                                                                                                                               
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE mm_mm_Dispersion(Ar,Br,C ,Disp_AB, result)                                                                                                                                                   
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     INTEGER ::  i,j,k,h,g                                                                                                                                                                               
     real*8, INTENT(INOUT) ::result                                                                                                                                                                      
     real*8 , dimension(216) , INTENT(IN) :: Disp_AB                                                                                                                                                     
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     real*8 :: r1,r2                                                                                                                                                                                     
     real*8 , dimension(36)::  mm_mm_AB                                                                                                                                                                  
     real*8:: eps=EPSILON(result)                                                                                                                                                                        
     Character :: cp_h,cp_i,cp_j,cp_g                                                                                                                                                                    
                                                                                                                                                                                                         
     result = 0d0                                                                                                                                                                                        
                                                                                                                                                                                                         
     mm_mm_AB = Disp_AB(1:36)                                                                                                                                                                            
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         result = 0d0                                                                                                                                                                                    
                                                                                                                                                                                                         
         do g = 1,3                                                                                                                                                                                      
             do h = 1,3                                                                                                                                                                                  
                 do i = 1,3                                                                                                                                                                              
                     do j = 1,3                                                                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         Call GetIndex_mm_mm(g,h,i,j,k)                                                                                                                                                  
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         if (DABS(mm_mm_AB(k))>eps) Then                                                                                                                                                 
                                                                                                                                                                                                         
                                 ! Call Tmm(Ar,Br,C ,h,j,0,t_jh)                                                                                                                                         
                                                                                                                                                                                                         
                                 ! Call Tmm(Ar,Br,C ,g,i,0,t_ig)                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                 ! result = result + mm_mm_AB(k)*t_ig*t_jh                                                                                                                               
                                                                                                                                                                                                         
                             call Get_Comp(g,cp_g)                                                                                                                                                       
                             call Get_Comp(h,cp_h)                                                                                                                                                       
                             call Get_Comp(i,cp_i)                                                                                                                                                       
                             call Get_Comp(j,cp_j)                                                                                                                                                       
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,1,Floor((h*1d0)/2d0),cp_h,1,Floor((j*1d0)/2d0),cp_j,r1)                                                                                                   
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,1,Floor((g*1d0)/2d0),cp_g,1,Floor((i*1d0)/2d0),cp_i,r2)                                                                                                   
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             result = result + mm_mm_AB(k)*r1*r2                                                                                                                                         
                                                                                                                                                                                                         
                         end if                                                                                                                                                                          
                     end do                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE mm_mm_Dispersion                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 !********************************************************                                                                                                                                               
 SUBROUTINE Dispersion_7_Sph2(cal_coord,Ar,Br,C ,Disp_AB, Disp_7_Energy)                                                                                                                                 
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     !   NEED TO DECLARE ALL THE SUBROUTINE ARGUMENTS and                                                                                                                                                
     !   ANY OTHER VARIABLES LOCAL TO THE SUBROUTINE                                                                                                                                                     
                                                                                                                                                                                                         
     real*8, INTENT(INOUT)  :: Disp_7_Energy                                                                                                                                                             
     real*8 , dimension(216) , INTENT(IN) :: Disp_AB                                                                                                                                                     
                                                                                                                                                                                                         
     real*8 :: R                                                                                                                                                                                         
     real*8 , dimension(11), INTENT(IN):: cal_coord                                                                                                                                                      
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     real*8 :: D_mQd_mm,D_mm_mQd                                                                                                                                                                         
                                                                                                                                                                                                         
     R =cal_coord(1)                                                                                                                                                                                     
                                                                                                                                                                                                         
     Call mQd_mm_Dispersion(Ar,Br,C ,Disp_AB,D_mQd_mm)                                                                                                                                                   
     Call mm_mQd_Dispersion(Ar,Br,C ,Disp_AB,D_mm_mQd)                                                                                                                                                   
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     Disp_7_Energy =   (-1.0d0)*(D_mQd_mm+D_mm_mQd)/ R**7                                                                                                                                                
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE Dispersion_7_Sph2                                                                                                                                                                        
 !********************************************************                                                                                                                                               
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE mQd_mm_Dispersion(Ar,Br,C ,Disp_AB, result)                                                                                                                                                  
         IMPLICIT NONE                                                                                                                                                                                   
                                                                                                                                                                                                         
         INTEGER ::  i,j,k,h,g                                                                                                                                                                           
         real*8, INTENT(INOUT) ::result                                                                                                                                                                  
         real*8 , dimension(216) , INTENT(IN) :: Disp_AB                                                                                                                                                 
         real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                          
         real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                          
         real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                           
         real*8 :: r1,r2                                                                                                                                                                                 
         real*8 , dimension(90)::  mQd_mm_AB                                                                                                                                                             
         real*8:: eps=EPSILON(result)                                                                                                                                                                    
         Character :: cp_h,cp_i,cp_j,cp_g                                                                                                                                                                
                                                                                                                                                                                                         
         result = 0d0                                                                                                                                                                                    
                                                                                                                                                                                                         
         mQd_mm_AB = Disp_AB(37:126)                                                                                                                                                                     
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
             do g = 1,3                                                                                                                                                                                  
                 do h = 1,5                                                                                                                                                                              
                     do i = 1,3                                                                                                                                                                          
                         do j = 1,3                                                                                                                                                                      
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             Call GetIndex_mQd_mm(g,h,i,j,k)                                                                                                                                             
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             if (DABS(mQd_mm_AB(k))>eps) Then                                                                                                                                            
                                                                                                                                                                                                         
                                     ! Call TQdm(Ar,Br,C ,h,j,0,t_jh)                                                                                                                                    
                                                                                                                                                                                                         
                                     ! Call Tmm(Ar,Br,C ,g,i,0,t_ig)                                                                                                                                     
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                     ! result = result + mQd_mm_AB(k)*t_ig*t_jh                                                                                                                          
                                                                                                                                                                                                         
                                 call Get_Comp(g,cp_g)                                                                                                                                                   
                                 call Get_Comp(h,cp_h)                                                                                                                                                   
                                 call Get_Comp(i,cp_i)                                                                                                                                                   
                                 call Get_Comp(j,cp_j)                                                                                                                                                   
                                                                                                                                                                                                         
                                 Call T_lk(Ar,Br,C,1,Floor((g*1d0)/2d0),cp_g,1,Floor((i*1d0)/2d0),cp_i,r1)                                                                                               
                                                                                                                                                                                                         
                                 Call T_lk(Ar,Br,C,2,Floor((h*1d0)/2d0),cp_h,1,Floor((j*1d0)/2d0),cp_j,r2)                                                                                               
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                 result = result + mQd_mm_AB(k)*r1*r2                                                                                                                                    
                                                                                                                                                                                                         
                             end if                                                                                                                                                                      
                         end do                                                                                                                                                                          
                     end do                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         RETURN                                                                                                                                                                                          
 END SUBROUTINE mQd_mm_Dispersion                                                                                                                                                                        
                                                                                                                                                                                                         
 SUBROUTINE mm_mQd_Dispersion(Ar,Br,C ,Disp_AB, result)                                                                                                                                                  
         IMPLICIT NONE                                                                                                                                                                                   
                                                                                                                                                                                                         
         INTEGER ::  i,j,k,h,g                                                                                                                                                                           
         real*8, INTENT(INOUT) ::result                                                                                                                                                                  
         real*8 , dimension(216) , INTENT(IN) :: Disp_AB                                                                                                                                                 
         real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                          
         real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                          
         real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                           
         real*8 :: r1,r2                                                                                                                                                                                 
         real*8 , dimension(90)::  mm_mQd_AB                                                                                                                                                             
         real*8:: eps=EPSILON(result)                                                                                                                                                                    
         Character :: cp_h,cp_i,cp_j,cp_g                                                                                                                                                                
                                                                                                                                                                                                         
         result = 0d0                                                                                                                                                                                    
                                                                                                                                                                                                         
         mm_mQd_AB = Disp_AB(127:216)                                                                                                                                                                    
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
             do g = 1,3                                                                                                                                                                                  
                 do h = 1,3                                                                                                                                                                              
                     do i = 1,3                                                                                                                                                                          
                         do j = 1,5                                                                                                                                                                      
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             Call GetIndex_mm_mQd(g,h,i,j,k)                                                                                                                                             
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             if (DABS(mm_mQd_AB(k))>eps) Then                                                                                                                                            
                                                                                                                                                                                                         
                                     ! Call TQdm(Ar,Br,C ,j,h,1,t_jh)                                                                                                                                    
                                                                                                                                                                                                         
                                     ! Call Tmm(Ar,Br,C ,g,i,0,t_ig)                                                                                                                                     
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                     ! result = result + mm_mQd_AB(k)*t_ig*t_jh                                                                                                                          
                                                                                                                                                                                                         
                                 call Get_Comp(g,cp_g)                                                                                                                                                   
                                 call Get_Comp(h,cp_h)                                                                                                                                                   
                                 call Get_Comp(i,cp_i)                                                                                                                                                   
                                 call Get_Comp(j,cp_j)                                                                                                                                                   
                                                                                                                                                                                                         
                                 Call T_lk(Ar,Br,C,1,Floor((g*1d0)/2d0),cp_g,1,Floor((i*1d0)/2d0),cp_i,r1)                                                                                               
                                                                                                                                                                                                         
                                 Call T_lk(Ar,Br,C,1,Floor((h*1d0)/2d0),cp_h,2,Floor((j*1d0)/2d0),cp_j,r2)                                                                                               
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                 result = result + mm_mQd_AB(k)*r1*r2                                                                                                                                    
                                                                                                                                                                                                         
                             end if                                                                                                                                                                      
                         end do                                                                                                                                                                          
                     end do                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         RETURN                                                                                                                                                                                          
 END SUBROUTINE mm_mQd_Dispersion                                                                                                                                                                        
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 !********************************************************                                                                                                                                               
 SUBROUTINE Dispersion_8_Sph2(cal_coord,Ar,Br,C ,Disp_AB, Disp_8_Energy)                                                                                                                                 
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     !   NEED TO DECLARE ALL THE SUBROUTINE ARGUMENTS and                                                                                                                                                
     !   ANY OTHER VARIABLES LOCAL TO THE SUBROUTINE                                                                                                                                                     
                                                                                                                                                                                                         
     real*8, INTENT(INOUT)  :: Disp_8_Energy                                                                                                                                                             
     real*8 , dimension(873) , INTENT(IN) :: Disp_AB                                                                                                                                                     
                                                                                                                                                                                                         
     real*8 :: R                                                                                                                                                                                         
     real*8 , dimension(11), INTENT(IN):: cal_coord                                                                                                                                                      
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     real*8 :: D_mQd_mQd, D_mO_mm, D_mm_mO, D_QQ_mm,D_mm_QQ                                                                                                                                              
                                                                                                                                                                                                         
     R =cal_coord(1)                                                                                                                                                                                     
                                                                                                                                                                                                         
    ! Call mQd_mm_Dispersion(Ar,Br,C ,Disp_AB,D_mQd_mm)                                                                                                                                                  
    ! Call mm_mQd_Dispersion(Ar,Br,C ,Disp_AB,D_mm_mQd)                                                                                                                                                  
                                                                                                                                                                                                         
     Call mQd_mQd_Dispersion(Ar,Br,C ,Disp_AB,D_mQd_mQd)                                                                                                                                                 
     Call mO_mm_Dispersion(Ar,Br,C ,Disp_AB,D_mO_mm)                                                                                                                                                     
     Call mm_mO_Dispersion(Ar,Br,C ,Disp_AB,D_mm_mO)                                                                                                                                                     
     Call QQ_mm_Dispersion(Ar,Br,C ,Disp_AB,D_QQ_mm)                                                                                                                                                     
     Call mm_QQ_Dispersion(Ar,Br,C ,Disp_AB,D_mm_QQ)                                                                                                                                                     
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     Disp_8_Energy =   (-1.0d0)*(D_mQd_mQd+D_mO_mm+D_mm_mO+D_QQ_mm+D_mm_QQ)/ R**8                                                                                                                        
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE Dispersion_8_Sph2                                                                                                                                                                        
 !********************************************************                                                                                                                                               
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE mQd_mQd_Dispersion(Ar,Br,C ,Disp_AB, result)                                                                                                                                                 
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     INTEGER ::  i,j,k,h,g                                                                                                                                                                               
     real*8, INTENT(INOUT) ::result                                                                                                                                                                      
     real*8 , dimension(873) , INTENT(IN) :: Disp_AB                                                                                                                                                     
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     real*8 :: r1,r2                                                                                                                                                                                     
     real*8 , dimension(225)::  mQd_mQd_AB                                                                                                                                                               
     real*8:: eps=EPSILON(result)                                                                                                                                                                        
     Character :: cp_h,cp_i,cp_j,cp_g                                                                                                                                                                    
                                                                                                                                                                                                         
     result = 0d0                                                                                                                                                                                        
                                                                                                                                                                                                         
     mQd_mQd_AB = Disp_AB(649:873)                                                                                                                                                                       
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         do g = 1,3                                                                                                                                                                                      
             do h = 1,5                                                                                                                                                                                  
                 do i = 1,3                                                                                                                                                                              
                     do j = 1,5                                                                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         Call GetIndex_mQd_mQd(g,h,i,j,k)                                                                                                                                                
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         if (DABS(mQd_mQd_AB(k))>eps) Then                                                                                                                                               
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             call Get_Comp(g,cp_g)                                                                                                                                                       
                             call Get_Comp(h,cp_h)                                                                                                                                                       
                             call Get_Comp(i,cp_i)                                                                                                                                                       
                             call Get_Comp(j,cp_j)                                                                                                                                                       
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,1,Floor((g*1d0)/2d0),cp_g,1,Floor((i*1d0)/2d0),cp_i,r1)                                                                                                   
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,2,Floor((h*1d0)/2d0),cp_h,2,Floor((j*1d0)/2d0),cp_j,r2)                                                                                                   
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             result = result + mQd_mQd_AB(k)*r1*r2                                                                                                                                       
                                                                                                                                                                                                         
                         end if                                                                                                                                                                          
                     end do                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
     RETURN                                                                                                                                                                                              
 END SUBROUTINE mQd_mQd_Dispersion                                                                                                                                                                       
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE mO_mm_Dispersion(Ar,Br,C ,Disp_AB, result)                                                                                                                                                   
         IMPLICIT NONE                                                                                                                                                                                   
                                                                                                                                                                                                         
         INTEGER ::  i,j,k,h,g                                                                                                                                                                           
         real*8, INTENT(INOUT) ::result                                                                                                                                                                  
         real*8 , dimension(873) , INTENT(IN) :: Disp_AB                                                                                                                                                 
         real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                          
         real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                          
         real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                           
         real*8 :: r1,r2                                                                                                                                                                                 
         real*8 , dimension(126)::  mO_mm_AB                                                                                                                                                             
         real*8:: eps=EPSILON(result)                                                                                                                                                                    
         Character :: cp_h,cp_i,cp_j,cp_g                                                                                                                                                                
                                                                                                                                                                                                         
         result = 0d0                                                                                                                                                                                    
                                                                                                                                                                                                         
         mO_mm_AB = Disp_AB(217:342)                                                                                                                                                                     
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
             do g = 1,3                                                                                                                                                                                  
                 do h = 1,7                                                                                                                                                                              
                     do i = 1,3                                                                                                                                                                          
                         do j = 1,3                                                                                                                                                                      
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             Call GetIndex_mO_mm(g,h,i,j,k)                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             if (DABS(mO_mm_AB(k))>eps) Then                                                                                                                                             
                                                                                                                                                                                                         
                                     ! Call TQdm(Ar,Br,C ,h,j,0,t_jh)                                                                                                                                    
                                                                                                                                                                                                         
                                     ! Call Tmm(Ar,Br,C ,g,i,0,t_ig)                                                                                                                                     
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                     ! result = result + mQd_mm_AB(k)*t_ig*t_jh                                                                                                                          
                                                                                                                                                                                                         
                                 call Get_Comp(g,cp_g)                                                                                                                                                   
                                 call Get_Comp(h,cp_h)                                                                                                                                                   
                                 call Get_Comp(i,cp_i)                                                                                                                                                   
                                 call Get_Comp(j,cp_j)                                                                                                                                                   
                                                                                                                                                                                                         
                                 Call T_lk(Ar,Br,C,1,Floor((g*1d0)/2d0),cp_g,1,Floor((i*1d0)/2d0),cp_i,r1)                                                                                               
                                                                                                                                                                                                         
                                 Call T_lk(Ar,Br,C,3,Floor((h*1d0)/2d0),cp_h,1,Floor((j*1d0)/2d0),cp_j,r2)                                                                                               
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                 result = result + mO_mm_AB(k)*r1*r2                                                                                                                                     
                                                                                                                                                                                                         
                             end if                                                                                                                                                                      
                         end do                                                                                                                                                                          
                     end do                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         RETURN                                                                                                                                                                                          
 END SUBROUTINE mO_mm_Dispersion                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE mm_mO_Dispersion(Ar,Br,C ,Disp_AB, result)                                                                                                                                                   
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     INTEGER ::  i,j,k,h,g                                                                                                                                                                               
     real*8, INTENT(INOUT) ::result                                                                                                                                                                      
     real*8 , dimension(873) , INTENT(IN) :: Disp_AB                                                                                                                                                     
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     real*8 :: r1,r2                                                                                                                                                                                     
     real*8 , dimension(126)::  mm_mO_AB                                                                                                                                                                 
     real*8:: eps=EPSILON(result)                                                                                                                                                                        
     Character :: cp_h,cp_i,cp_j,cp_g                                                                                                                                                                    
                                                                                                                                                                                                         
     result = 0d0                                                                                                                                                                                        
                                                                                                                                                                                                         
     mm_mO_AB = Disp_AB(343:468)                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         do g = 1,3                                                                                                                                                                                      
             do h = 1,3                                                                                                                                                                                  
                 do i = 1,3                                                                                                                                                                              
                     do j = 1,7                                                                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         Call GetIndex_mm_mO(g,h,i,j,k)                                                                                                                                                  
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         if (DABS(mm_mO_AB(k))>eps) Then                                                                                                                                                 
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             call Get_Comp(g,cp_g)                                                                                                                                                       
                             call Get_Comp(h,cp_h)                                                                                                                                                       
                             call Get_Comp(i,cp_i)                                                                                                                                                       
                             call Get_Comp(j,cp_j)                                                                                                                                                       
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,1,Floor((g*1d0)/2d0),cp_g,1,Floor((i*1d0)/2d0),cp_i,r1)                                                                                                   
                             Call T_lk(Ar,Br,C,1,Floor((h*1d0)/2d0),cp_h,3,Floor((j*1d0)/2d0),cp_j,r2)                                                                                                   
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             result = result + mm_mO_AB(k)*r1*r2                                                                                                                                         
                                                                                                                                                                                                         
                         end if                                                                                                                                                                          
                     end do                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
     RETURN                                                                                                                                                                                              
 END SUBROUTINE mm_mO_Dispersion                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE QQ_mm_Dispersion(Ar,Br,C ,Disp_AB, result)                                                                                                                                                   
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     INTEGER ::  i,j,k,h,g                                                                                                                                                                               
     real*8, INTENT(INOUT) ::result                                                                                                                                                                      
     real*8 , dimension(873) , INTENT(IN) :: Disp_AB                                                                                                                                                     
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     real*8 :: r1,r2                                                                                                                                                                                     
     real*8 , dimension(90)::  QQ_mm_AB                                                                                                                                                                  
     real*8:: eps=EPSILON(result)                                                                                                                                                                        
     Character :: cp_h,cp_i,cp_j,cp_g                                                                                                                                                                    
                                                                                                                                                                                                         
     result = 0d0                                                                                                                                                                                        
                                                                                                                                                                                                         
     QQ_mm_AB = Disp_AB(469:558)                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         do g = 1,5                                                                                                                                                                                      
             do h = 1,5                                                                                                                                                                                  
                 do i = 1,3                                                                                                                                                                              
                     do j = 1,3                                                                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         Call GetIndex_QQ_mm(g,h,i,j,k)                                                                                                                                                  
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         if (DABS(QQ_mm_AB(k))>eps) Then                                                                                                                                                 
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             call Get_Comp(g,cp_g)                                                                                                                                                       
                             call Get_Comp(h,cp_h)                                                                                                                                                       
                             call Get_Comp(i,cp_i)                                                                                                                                                       
                             call Get_Comp(j,cp_j)                                                                                                                                                       
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,2,Floor((g*1d0)/2d0),cp_g,1,Floor((i*1d0)/2d0),cp_i,r1)                                                                                                   
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,2,Floor((h*1d0)/2d0),cp_h,1,Floor((j*1d0)/2d0),cp_j,r2)                                                                                                   
                                                                                                                                                                                                         
                             result = result + QQ_mm_AB(k)*r1*r2                                                                                                                                         
                                                                                                                                                                                                         
                         end if                                                                                                                                                                          
                     end do                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
     RETURN                                                                                                                                                                                              
 END SUBROUTINE QQ_mm_Dispersion                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE mm_QQ_Dispersion(Ar,Br,C ,Disp_AB, result)                                                                                                                                                   
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     INTEGER ::  i,j,k,h,g                                                                                                                                                                               
     real*8, INTENT(INOUT) ::result                                                                                                                                                                      
     real*8 , dimension(873) , INTENT(IN) :: Disp_AB                                                                                                                                                     
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     real*8 :: r1,r2                                                                                                                                                                                     
     real*8 , dimension(90)::  mm_QQ_AB                                                                                                                                                                  
     real*8:: eps=EPSILON(result)                                                                                                                                                                        
     Character :: cp_h,cp_i,cp_j,cp_g                                                                                                                                                                    
                                                                                                                                                                                                         
     result = 0d0                                                                                                                                                                                        
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     mm_QQ_AB = Disp_AB(559:648)                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
         do g = 1,3                                                                                                                                                                                      
             do h = 1,3                                                                                                                                                                                  
                 do i = 1,5                                                                                                                                                                              
                     do j = 1,5                                                                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         Call GetIndex_mm_QQ(g,h,i,j,k)                                                                                                                                                  
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         if (DABS(mm_QQ_AB(k))>eps) Then                                                                                                                                                 
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             call Get_Comp(g,cp_g)                                                                                                                                                       
                             call Get_Comp(h,cp_h)                                                                                                                                                       
                             call Get_Comp(i,cp_i)                                                                                                                                                       
                             call Get_Comp(j,cp_j)                                                                                                                                                       
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,1,Floor((g*1d0)/2d0),cp_g,2,Floor((i*1d0)/2d0),cp_i,r1)                                                                                                   
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,1,Floor((h*1d0)/2d0),cp_h,2,Floor((j*1d0)/2d0),cp_j,r2)                                                                                                   
                                                                                                                                                                                                         
                             result = result + mm_QQ_AB(k)*r1*r2                                                                                                                                         
                                                                                                                                                                                                         
                         end if                                                                                                                                                                          
                     end do                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
     RETURN                                                                                                                                                                                              
 END SUBROUTINE mm_QQ_Dispersion                                                                                                                                                                         
                                                                                                                                                                                                         
     !********************************************************                                                                                                                                           
 SUBROUTINE HyperPolarizability_6_Sph2(cal_coord,Ar,Br,C ,A_Multipoles,B_Multipoles ,A_HPol,B_HPol, H_6_Energy)                                                                                          
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     !   NEED TO DECLARE ALL THE SUBROUTINE ARGUMENTS and                                                                                                                                                
     !   ANY OTHER VARIABLES LOCAL TO THE SUBROUTINE                                                                                                                                                     
                                                                                                                                                                                                         
     real*8, INTENT(INOUT)  :: H_6_Energy                                                                                                                                                                
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 , dimension(40) , INTENT(IN) :: A_HPol,B_HPol                                                                                                                                                
     real*8 :: R                                                                                                                                                                                         
     real*8 , dimension(11), INTENT(IN):: cal_coord                                                                                                                                                      
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     real*8 :: qqq_mmm_0 , qqq_mmm_1                                                                                                                                                                     
                                                                                                                                                                                                         
     R =cal_coord(1)                                                                                                                                                                                     
                                                                                                                                                                                                         
     Call qqq_mmm(Ar,Br,C ,A_Multipoles,B_Multipoles,A_HPol,B_HPol,0,qqq_mmm_0)                                                                                                                          
     Call qqq_mmm(Ar,Br,C ,A_Multipoles,B_Multipoles,A_HPol,B_HPol,1,qqq_mmm_1)                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     H_6_Energy =   (1.0d0/6.0d0)*(qqq_mmm_0 + qqq_mmm_1)/ R**6                                                                                                                                          
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE HyperPolarizability_6_Sph2                                                                                                                                                               
     !********************************************************                                                                                                                                           
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE qqq_mmm(Ar,Br,C ,A_Multipoles,B_Multipoles ,A_HPol,B_HPol, ind , result)                                                                                                                     
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     INTEGER ::  i,j,h,k                                                                                                                                                                                 
     real*8, INTENT(INOUT) ::result                                                                                                                                                                      
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 , dimension(40) , INTENT(IN) :: A_HPol,B_HPol                                                                                                                                                
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     Integer, INTENT(IN):: ind                                                                                                                                                                           
     real*8 :: q,r1,r2,r3                                                                                                                                                                                
     real*8 , dimension(10):: beta                                                                                                                                                                       
     real*8:: eps=EPSILON(result)                                                                                                                                                                        
     Character :: cp_h,cp_i,cp_j,cp_g                                                                                                                                                                    
                                                                                                                                                                                                         
     result = 0d0                                                                                                                                                                                        
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     if (ind==0) then                                                                                                                                                                                    
         q =  B_Multipoles(1)                                                                                                                                                                            
         beta  = A_HPol(1:10)                                                                                                                                                                            
                                                                                                                                                                                                         
         do h = 1,3                                                                                                                                                                                      
             do i = 1,3                                                                                                                                                                                  
                 do j = 1,3                                                                                                                                                                              
                                                                                                                                                                                                         
                     Call GetIndex_mmm(h,i,j,k)                                                                                                                                                          
                                                                                                                                                                                                         
                     if (DABS(q)>eps .and.  DABS(beta(k))>eps) Then                                                                                                                                      
                             ! Call Tmq(Ar,Br,C ,i,ind,t_i)                                                                                                                                              
                             ! Call Tmq(Ar,Br,C ,j,ind,t_j)                                                                                                                                              
                             ! Call Tmq(Ar,Br,C ,h,ind,t_h)                                                                                                                                              
                             ! result = result + (q**3)*beta(k)*t_i*t_j*t_h                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         call Get_Comp(h,cp_h)                                                                                                                                                           
                         call Get_Comp(i,cp_i)                                                                                                                                                           
                         call Get_Comp(j,cp_j)                                                                                                                                                           
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,1,Floor((i*1d0)/2d0),cp_i,0,0,"0",r1)                                                                                                                         
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,1,Floor((j*1d0)/2d0),cp_j,0,0,"0",r2)                                                                                                                         
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,1,Floor((h*1d0)/2d0),cp_h,0,0,"0",r3)                                                                                                                         
                                                                                                                                                                                                         
                         result = result + (q**3)*beta(k)*r1*r2*r3                                                                                                                                       
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                     end if                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     else                                                                                                                                                                                                
         q      =  A_Multipoles(1)                                                                                                                                                                       
         beta  =  B_HPol(1:10)                                                                                                                                                                           
                                                                                                                                                                                                         
         do h = 1,3                                                                                                                                                                                      
             do i = 1,3                                                                                                                                                                                  
                 do j = 1,3                                                                                                                                                                              
                                                                                                                                                                                                         
                     Call GetIndex_mmm(h,i,j,k)                                                                                                                                                          
                                                                                                                                                                                                         
                     if (DABS(q)>eps .and.  DABS(beta(k))>eps) Then                                                                                                                                      
                             ! Call Tmq(Ar,Br,C ,i,ind,t_i)                                                                                                                                              
                             ! Call Tmq(Ar,Br,C ,j,ind,t_j)                                                                                                                                              
                             ! Call Tmq(Ar,Br,C ,h,ind,t_h)                                                                                                                                              
                             ! result = result + (q**3)*beta(k)*t_i*t_j*t_h                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         call Get_Comp(h,cp_h)                                                                                                                                                           
                         call Get_Comp(i,cp_i)                                                                                                                                                           
                         call Get_Comp(j,cp_j)                                                                                                                                                           
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,0,0,"0",1,Floor((i*1d0)/2d0),cp_i,r1)                                                                                                                         
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,0,0,"0",1,Floor((j*1d0)/2d0),cp_j,r2)                                                                                                                         
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,0,0,"0",1,Floor((h*1d0)/2d0),cp_h,r3)                                                                                                                         
                                                                                                                                                                                                         
                         result = result + (q**3)*beta(k)*r1*r2*r3                                                                                                                                       
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                     end if                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
     end if                                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE qqq_mmm                                                                                                                                                                                  
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     !********************************************************                                                                                                                                           
 SUBROUTINE HyperPolarizability_7_Sph2(cal_coord,Ar,Br,C ,A_Multipoles,B_Multipoles ,A_HPol,B_HPol, H_7_Energy)                                                                                          
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     !   NEED TO DECLARE ALL THE SUBROUTINE ARGUMENTS and                                                                                                                                                
     !   ANY OTHER VARIABLES LOCAL TO THE SUBROUTINE                                                                                                                                                     
                                                                                                                                                                                                         
     real*8, INTENT(INOUT)  :: H_7_Energy                                                                                                                                                                
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 , dimension(40) , INTENT(IN) :: A_HPol,B_HPol                                                                                                                                                
     real*8 :: R                                                                                                                                                                                         
     real*8 , dimension(11), INTENT(IN):: cal_coord                                                                                                                                                      
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     real*8 :: qqm_mmm_0 , qqm_mmm_1,qqq_mmQd_0,qqq_mmQd_1                                                                                                                                               
                                                                                                                                                                                                         
     R =cal_coord(1)                                                                                                                                                                                     
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     Call qqm_mmm(Ar,Br,C ,A_Multipoles,B_Multipoles,A_HPol,B_HPol,0,qqm_mmm_0)                                                                                                                          
     Call qqm_mmm(Ar,Br,C ,A_Multipoles,B_Multipoles,A_HPol,B_HPol,1,qqm_mmm_1)                                                                                                                          
                                                                                                                                                                                                         
     Call qqq_mmQd(Ar,Br,C ,A_Multipoles,B_Multipoles,A_HPol,B_HPol,0,qqq_mmQd_0)                                                                                                                        
     Call qqq_mmQd(Ar,Br,C ,A_Multipoles,B_Multipoles,A_HPol,B_HPol,1,qqq_mmQd_1)                                                                                                                        
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     H_7_Energy =   (1.0d0/6.0d0)*(3d0*qqm_mmm_0 + 3d0*qqm_mmm_1 + 3d0*qqq_mmQd_0+3d0*qqq_mmQd_1)/ R**7                                                                                                  
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE HyperPolarizability_7_Sph2                                                                                                                                                               
     !********************************************************                                                                                                                                           
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE qqm_mmm(Ar,Br,C ,A_Multipoles,B_Multipoles ,A_HPol,B_HPol, ind , result)                                                                                                                     
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     INTEGER ::  i,j,h,k,g                                                                                                                                                                               
     real*8, INTENT(INOUT) ::result                                                                                                                                                                      
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 , dimension(40) , INTENT(IN) :: A_HPol,B_HPol                                                                                                                                                
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     Integer, INTENT(IN):: ind                                                                                                                                                                           
     real*8 :: q,r1,r2,r3                                                                                                                                                                                
     real*8 , dimension(3):: m                                                                                                                                                                           
     real*8 , dimension(10):: beta                                                                                                                                                                       
     real*8:: eps=EPSILON(result)                                                                                                                                                                        
                                                                                                                                                                                                         
     Character :: cp_h,cp_i,cp_j,cp_g                                                                                                                                                                    
                                                                                                                                                                                                         
     result = 0d0                                                                                                                                                                                        
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     if (ind==0) then                                                                                                                                                                                    
         q =  B_Multipoles(1)                                                                                                                                                                            
         m =  B_Multipoles(2:4)                                                                                                                                                                          
         beta  = A_HPol(1:10)                                                                                                                                                                            
                                                                                                                                                                                                         
         do g=1,3                                                                                                                                                                                        
             do h = 1,3                                                                                                                                                                                  
                 do i = 1,3                                                                                                                                                                              
                     do j = 1,3                                                                                                                                                                          
                                                                                                                                                                                                         
                         Call GetIndex_mmm(h,i,j,k)                                                                                                                                                      
                                                                                                                                                                                                         
                         if (DABS(m(g))>eps .and.   DABS(q)>eps .and.  DABS(beta(k))>eps) Then                                                                                                           
                                 ! Call Tmq(Ar,Br,C ,i,ind,t_i)                                                                                                                                          
                                 ! Call Tmq(Ar,Br,C ,j,ind,t_j)                                                                                                                                          
                                 ! Call Tmm(Ar,Br,C ,h,g,ind,t_hg)                                                                                                                                       
                                 ! result = result + (q**2 * m(g))*beta(k)*t_i*t_j*t_hg                                                                                                                  
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             call Get_Comp(g,cp_g)                                                                                                                                                       
                             call Get_Comp(h,cp_h)                                                                                                                                                       
                             call Get_Comp(i,cp_i)                                                                                                                                                       
                             call Get_Comp(j,cp_j)                                                                                                                                                       
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,1,Floor((h*1d0)/2d0),cp_h,1,Floor((g*1d0)/2d0),cp_g,r1)                                                                                                   
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,1,Floor((i*1d0)/2d0),cp_i,0,0,"0",r2)                                                                                                                     
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,1,Floor((j*1d0)/2d0),cp_j,0,0,"0",r3)                                                                                                                     
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             result = result +  (q**2 * m(g))*beta(k)*r1*r2*r3                                                                                                                           
                                                                                                                                                                                                         
                         end if                                                                                                                                                                          
                     end do                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
                                                                                                                                                                                                         
     else                                                                                                                                                                                                
         q      =  A_Multipoles(1)                                                                                                                                                                       
         m       =  A_Multipoles(2:4)                                                                                                                                                                    
         beta  =  B_HPol(1:10)                                                                                                                                                                           
                                                                                                                                                                                                         
         do g=1,3                                                                                                                                                                                        
             do h = 1,3                                                                                                                                                                                  
                 do i = 1,3                                                                                                                                                                              
                     do j = 1,3                                                                                                                                                                          
                                                                                                                                                                                                         
                         Call GetIndex_mmm(h,i,j,k)                                                                                                                                                      
                                                                                                                                                                                                         
                         if (DABS(m(g))>eps .and.   DABS(q)>eps .and.  DABS(beta(k))>eps) Then                                                                                                           
                                 ! Call Tmq(Ar,Br,C ,i,ind,t_i)                                                                                                                                          
                                 ! Call Tmq(Ar,Br,C ,j,ind,t_j)                                                                                                                                          
                                 ! Call Tmm(Ar,Br,C ,h,g,ind,t_hg)                                                                                                                                       
                                 ! result = result + (q**2 * m(g))*beta(k)*t_i*t_j*t_hg                                                                                                                  
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             call Get_Comp(g,cp_g)                                                                                                                                                       
                             call Get_Comp(h,cp_h)                                                                                                                                                       
                             call Get_Comp(i,cp_i)                                                                                                                                                       
                             call Get_Comp(j,cp_j)                                                                                                                                                       
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,1,Floor((g*1d0)/2d0),cp_g,1,Floor((h*1d0)/2d0),cp_h,r1)                                                                                                   
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,0,0,"0",1,Floor((i*1d0)/2d0),cp_i,r2)                                                                                                                     
                                                                                                                                                                                                         
                             Call T_lk(Ar,Br,C,0,0,"0",1,Floor((j*1d0)/2d0),cp_j,r3)                                                                                                                     
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                             result = result +  (q**2 * m(g))*beta(k)*r1*r2*r3                                                                                                                           
                                                                                                                                                                                                         
                         end if                                                                                                                                                                          
                     end do                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
                                                                                                                                                                                                         
     end if                                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE qqm_mmm                                                                                                                                                                                  
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE qqq_mmQd(Ar,Br,C ,A_Multipoles,B_Multipoles ,A_HPol,B_HPol, ind , result)                                                                                                                    
     IMPLICIT NONE                                                                                                                                                                                       
                                                                                                                                                                                                         
     INTEGER ::  i,j,h,k                                                                                                                                                                                 
     real*8, INTENT(INOUT) ::result                                                                                                                                                                      
     real*8 , dimension(64) , INTENT(IN) :: A_Multipoles,B_Multipoles                                                                                                                                    
     real*8 , dimension(40) , INTENT(IN) :: A_HPol,B_HPol                                                                                                                                                
     real*8 , dimension(3), INTENT(IN):: Ar                                                                                                                                                              
     real*8 , dimension(3), INTENT(IN):: Br                                                                                                                                                              
     real*8 , dimension(9), INTENT(IN):: C                                                                                                                                                               
     Integer, INTENT(IN):: ind                                                                                                                                                                           
     real*8 :: q,r1,r2,r3                                                                                                                                                                                
     real*8 , dimension(30):: beta                                                                                                                                                                       
     real*8:: eps=EPSILON(result)                                                                                                                                                                        
     Character :: cp_h,cp_i,cp_j,cp_g                                                                                                                                                                    
                                                                                                                                                                                                         
     result = 0d0                                                                                                                                                                                        
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     if (ind==0) then                                                                                                                                                                                    
         q =  B_Multipoles(1)                                                                                                                                                                            
         beta  = A_HPol(11:40)                                                                                                                                                                           
                                                                                                                                                                                                         
         do h = 1,3                                                                                                                                                                                      
             do i = 1,3                                                                                                                                                                                  
                 do j = 1,5                                                                                                                                                                              
                                                                                                                                                                                                         
                     Call GetIndex_mmQd(h,i,j,k)                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                     if ( DABS(q)>eps .and.  DABS(beta(k))>eps) Then                                                                                                                                     
                                                                                                                                                                                                         
                             ! Call Tmq(Ar,Br,C ,i,ind,t_i)                                                                                                                                              
                             ! Call TQdq(Ar,Br,C ,j,ind,t_j)                                                                                                                                             
                             ! Call Tmq(Ar,Br,C ,h,ind,t_h)                                                                                                                                              
                             ! result = result + (q**3)*beta(k)*t_i*t_j*t_h                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         call Get_Comp(h,cp_h)                                                                                                                                                           
                         call Get_Comp(i,cp_i)                                                                                                                                                           
                         call Get_Comp(j,cp_j)                                                                                                                                                           
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,2,Floor((j*1d0)/2d0),cp_j,0,0,"0",r1)                                                                                                                         
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,1,Floor((i*1d0)/2d0),cp_i,0,0,"0",r2)                                                                                                                         
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,1,Floor((h*1d0)/2d0),cp_h,0,0,"0",r3)                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         result = result +  (q**3)*beta(k)*r1*r2*r3                                                                                                                                      
                                                                                                                                                                                                         
                     end if                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
                                                                                                                                                                                                         
     else                                                                                                                                                                                                
         q      =  A_Multipoles(1)                                                                                                                                                                       
         beta  =  B_HPol(11:40)                                                                                                                                                                          
                                                                                                                                                                                                         
         do h = 1,3                                                                                                                                                                                      
             do i = 1,3                                                                                                                                                                                  
                 do j = 1,5                                                                                                                                                                              
                                                                                                                                                                                                         
                     Call GetIndex_mmQd(h,i,j,k)                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                     if ( DABS(q)>eps .and.  DABS(beta(k))>eps) Then                                                                                                                                     
                                                                                                                                                                                                         
                             ! Call Tmq(Ar,Br,C ,i,ind,t_i)                                                                                                                                              
                             ! Call TQdq(Ar,Br,C ,j,ind,t_j)                                                                                                                                             
                             ! Call Tmq(Ar,Br,C ,h,ind,t_h)                                                                                                                                              
                             ! result = result + (q**3)*beta(k)*t_i*t_j*t_h                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
                         call Get_Comp(h,cp_h)                                                                                                                                                           
                         call Get_Comp(i,cp_i)                                                                                                                                                           
                         call Get_Comp(j,cp_j)                                                                                                                                                           
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,0,0,"0",2,Floor((j*1d0)/2d0),cp_j,r1)                                                                                                                         
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,0,0,"0",1,Floor((i*1d0)/2d0),cp_i,r2)                                                                                                                         
                                                                                                                                                                                                         
                         Call T_lk(Ar,Br,C,0,0,"0",1,Floor((h*1d0)/2d0),cp_h,r3)                                                                                                                         
                                                                                                                                                                                                         
                         result = result +  (q**3)*beta(k)*r1*r2*r3                                                                                                                                      
                                                                                                                                                                                                         
                     end if                                                                                                                                                                              
                 end do                                                                                                                                                                                  
             end do                                                                                                                                                                                      
         end do                                                                                                                                                                                          
                                                                                                                                                                                                         
     end if                                                                                                                                                                                              
                                                                                                                                                                                                         
                                                                                                                                                                                                         
     RETURN                                                                                                                                                                                              
 END SUBROUTINE qqq_mmQd                                                                                                                                                                                 
 ! Arg 1 [coordenates] : a coordenate vector [ R , b1, b2, phi] *the angles should be in degrees                                                                                                         
 ! Arg 2 [Coeff_Address] address of the file which contains the longe range expansion coefficients                                                                                                       
 ! Arg 3 [TotalEnergy]   Total Energy calculated                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 ! version 3.1.1                                                                                                                                                                                         
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 MODULE constants                                                                                                                                                                                        
  implicit none                                                                                                                                                                                          
  save                                                                                                                                                                                                   
  public                                                                                                                                                                                                 
   Integer, dimension (8) :: M_Fit                                                                                                                                                                       
   Integer, dimension (3):: D_Fit                                                                                                                                                                        
   Integer, dimension (5):: I_Fit                                                                                                                                                                        
   Integer, dimension (2):: H_Fit                                                                                                                                                                        
   real*8 , dimension(1195):: coeff_arr                                                                                                                                                                  
   Real*8  ::   Zero                                                                                                                                                                                     
 END MODULE constants                                                                                                                                                                                    
                                                                                                                                                                                                         
                                                                                                                                                                                                         
 SUBROUTINE Long_Range_Potential(coordenates,TotalEnergy,filename)                                                                                                                                       
  use Tensors_constant                                                                                                                                                                                   
  use constants                                                                                                                                                                                          
  IMPLICIT NONE                                                                                                                                                                                          
                                                                                                                                                                                                         
  real*8, INTENT(INOUT)  ::  TotalEnergy                                                                                                                                                                 
  real*8 ,dimension(6), INTENT(IN)  :: coordenates ! the angles are in degree                                                                                                                            
  character(len = *), INTENT(IN) :: filename                                                                                                                                                             
  real*8::testErr(52)                                                                                                                                                                                    
                                                                                                                                                                                                         
  real*8 , dimension(3):: Ar                                                                                                                                                                             
  real*8 , dimension(3):: Br                                                                                                                                                                             
  real*8 , dimension(9):: C                                                                                                                                                                              
                                                                                                                                                                                                         
  real*8 , dimension(11):: cal_coord                                                                                                                                                                     
  character(len = 200):: fName                                                                                                                                                                           
                                                                                                                                                                                                         
 !    Integer, dimension (8) :: M_Fit                                                                                                                                                                    
 !    Integer, dimension (3):: D_Fit                                                                                                                                                                     
 !    Integer, dimension (5):: I_Fit                                                                                                                                                                     
 !    Integer, dimension (2):: H_Fit                                                                                                                                                                     
 !    real*8 , dimension(1195):: coeff_arr                                                                                                                                                               
 !    Real*8  ::   Zero                                                                                                                                                                                  
                                                                                                                                                                                                         
  integer :: initflag                                                                                                                                                                                    
  save initflag                                                                                                                                                                                          
  data initflag /1/                                                                                                                                                                                      
 !   save coeff_arr,M_Fit ,D_Fit,I_Fit,H_Fit,Zero                                                                                                                                                        
                                                                                                                                                                                                         
  call init_Tensors() ! Initializing in zero the new vectors                                                                                                                                             
                                                                                                                                                                                                         
  IF(initflag==1)THEN! initialize                                                                                                                                                                        
    CALL Prep_Param(filename,coeff_arr,M_Fit ,D_Fit,I_Fit,H_Fit,Zero)                                                                                                                                    
    initflag=2                                                                                                                                                                                           
  ENDIF                                                                                                                                                                                                  
                                                                                                                                                                                                         
  if (coordenates(1)==0d0 .and. coordenates(2)==0d0 .and. coordenates(3)==0d0 .and. coordenates(4)==0d0 &                                                                                                
      .and. coordenates(5)==0d0 .and. coordenates(6)==0d0) THEN                                                                                                                                          
     TotalEnergy = Zero                                                                                                                                                                                  
  else                                                                                                                                                                                                   
     Call Generate_Coordenates(coordenates,cal_coord,Ar,Br,C)                                                                                                                                            
     call TotalEnergy_Calc(cal_coord,Ar,Br,C,coeff_arr, M_Fit ,D_Fit,I_Fit,H_Fit,TotalEnergy,0,testErr)                                                                                                  
   end if                                                                                                                                                                                                
                                                                                                                                                                                                         
 END SUBROUTINE Long_Range_Potential                                                                                                                                                                     
 SUBROUTINE evaluateLR(coordinates,XDIM,E1,filename)                                                                                                                                                     
 IMPLICIT NONE                                                                                                                                                                                           
                                                                                                                                                                                                         
 real*8, INTENT(OUT) :: E1                                                                                                                                                                               
 INTEGER, INTENT(IN) :: XDIM                                                                                                                                                                             
 real*8 ,dimension(:), INTENT(IN):: coordinates(XDIM)                                                                                                                                                    
 Character(len = 20) :: coord_format = "Euler_ZYZ" !for Xdim =3, use coord_format ="Spherical"                                                                                                           
 real*8 ,dimension(6):: GeneralCoordenates,GeneralCoordenates1                                                                                                                                           
 INTEGER :: i                                                                                                                                                                                            
 real*8 :: x1                                                                                                                                                                                            
 Character(*), INTENT(IN) ::  filename                                                                                                                                                                   
                                                                                                                                                                                                         
 x1=0d0                                                                                                                                                                                                  
 do i=1,XDIM                                                                                                                                                                                             
   x1=x1+dabs(coordinates(i))                                                                                                                                                                            
 enddo                                                                                                                                                                                                   
                                                                                                                                                                                                         
 if (x1 <= 1d-10) then                                                                                                                                                                                   
   GeneralCoordenates=0d0                                                                                                                                                                                
   CALL Long_Range_Potential(GeneralCoordenates,E1,filename)                                                                                                                                             
   return                                                                                                                                                                                                
 endif                                                                                                                                                                                                   
                                                                                                                                                                                                         
 Call General_Coordinates_Format(XDIM, coordinates, GeneralCoordenates)                                                                                                                                  
 Call Coordinate_Transformation(GeneralCoordenates,coord_format,GeneralCoordenates1)                                                                                                                     
 CALL Long_Range_Potential(GeneralCoordenates1,E1,filename)                                                                                                                                              
 return                                                                                                                                                                                                  
                                                                                                                                                                                                         
 END SUBROUTINE evaluateLR                                                                                                                                                                               
